<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="description" content="docs">
<meta name="generator" content="Paradox, paradox-material-theme=0.4.0, mkdocs-material=2.2.2">

<meta name="lang:clipboard.copy" content="Copy to clipboard">
<meta name="lang:clipboard.copied" content="Copied to clipboard">
<meta name="lang:search.result.none" content="No matching documents">
<meta name="lang:search.result.one" content="1 matching document">
<meta name="lang:search.result.other" content="# matching documents">
<meta name="lang:search.language" content="">
<meta name="lang:search.tokenizer" content="[\s\-]+">


<meta name="description" content="docs">
<link rel="shortcut icon" href="assets/tmt_favicon.ico">
<title>Creating a Component Â· TMT Common Software (CSW)</title>
<link rel="stylesheet" href="assets/stylesheets/application.7a4cdee3.css">
<link rel="stylesheet" href="lib/material__tabs/dist/mdc.tabs.min.css">
<link rel="stylesheet" href="lib/prettify/prettify.css">
<script src="lib/modernizr/modernizr.min.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
<style>
body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}
code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}
</style>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="assets/stylesheets/paradox-material-theme.css">
</head>
<body
>
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
<label class="md-overlay" data-md-component="overlay" for="drawer"></label>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a href="index.html" title="TMT Common Software (CSW)" class="md-header-nav__button md-logo">
<i class="md-icon">local_library</i>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
TMT Common Software (CSW)
</span>
<span class="md-header-nav__topic">
Creating a Component
</span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="search"></label>
<div class="md-search__inner">
<form class="md-search__form" name="search">
<input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
<label class="md-icon md-search__icon" for="search"></label>
<button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix>
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
Type to start searching
</div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>

</div>
<div class="md-flex__cell md-flex__cell--shrink">
<div class="md-header-nav__source">
<a href="https://github.com/tmtsoftware/csw-prod"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
tmtsoftware/csw-prod
</div>
</a>

</div>
</div>
</div>
</nav>
</header>

<div class="md-container">
<main class="md-main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0" style="visibility: hidden">
<label class="md-nav__title md-nav__title--site" for="drawer">
<span class="md-nav__button md-logo">
<i class="md-icon">local_library</i>
</span>
<a href="index.html" title="TMT Common Software (CSW)">
TMT Common Software (CSW)
</a>
</label>
<div class="md-nav__source">
<a href="https://github.com/tmtsoftware/csw-prod"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
tmtsoftware/csw-prod
</div>
</a>

</div>
<ul>
  <li><a href="csw-overview.html" class="page">Using CSW</a></li>
  <li><a href="getting-started.html" class="page">Getting Started</a></li>
  <li><a href="create-component.html" class="active page">Creating a Component</a></li>
  <li><a href="multiple-components.html" class="page">Multiple Components</a></li>
  <li><a href="messages.html" class="page">Messages</a>
  <ul>
    <li><a href="messages/keys-parameters.html" class="page">Keys and Parameters</a></li>
    <li><a href="messages/units.html" class="page">Units</a></li>
    <li><a href="messages/subsystem.html" class="page">Subsystem</a></li>
    <li><a href="messages/commands.html" class="page">Commands</a></li>
    <li><a href="messages/events.html" class="page">Events</a></li>
    <li><a href="messages/states.html" class="page">State variables</a></li>
    <li><a href="messages/result.html" class="page">Result</a></li>
  </ul></li>
  <li><a href="framework.html" class="page">Framework for creating components (HCD, Assembly, Container)</a>
  <ul>
    <li><a href="framework/describing-components.html" class="page">ComponentInfo</a></li>
    <li><a href="framework/creating-components.html" class="page">Creating an Assembly or Hcd Component</a></li>
    <li><a href="framework/handling-lifecycle.html" class="page">Lifecycle support</a></li>
    <li><a href="framework/managing-command-state.html" class="page">Managing Command State</a></li>
    <li><a href="framework/tracking-connections.html" class="page">Tracking Connections</a></li>
    <li><a href="framework/publishing-state.html" class="page">Publishing State</a></li>
    <li><a href="framework/handling-exceptions.html" class="page">Handling Exceptions</a></li>
    <li><a href="framework/deploying-components.html" class="page">Deploying Components</a></li>
  </ul></li>
  <li><a href="services.html" class="page">Services</a>
  <ul>
    <li><a href="services/location.html" class="page">Location service</a></li>
    <li><a href="services/config.html" class="page">Configuration service</a></li>
    <li><a href="services/logging.html" class="page">Logging service</a></li>
  </ul></li>
  <li><a href="command.html" class="page">Communication using Commands</a></li>
  <li><a href="testing.html" class="page">Testing</a></li>
  <li><a href="apps.html" class="page">Applications</a>
  <ul>
    <li><a href="apps/cswclusterseed.html" class="page">csw-cluster-seed</a></li>
    <li><a href="apps/cswlocationagent.html" class="page">csw-location-agent</a></li>
    <li><a href="apps/cswonfigserverapp.html" class="page">csw-config-server</a></li>
    <li><a href="apps/cswconfigclientcli.html" class="page">csw-config-client-cli</a></li>
    <li><a href="apps/hostconfig.html" class="page">csw-host-config</a></li>
  </ul></li>
  <li><a href="manuals.html" class="page">Manuals</a></li>
  <li><a href="sbt-tasks.html" class="page">sbt tasks</a></li>
</ul>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="toc">Table of contents</label>
<ul>
  <li><a href="create-component.html#creating-a-component" class="header">Creating a Component</a>
  <ul>
    <li><a href="create-component.html#anatomy-of-component" class="header">Anatomy of Component</a></li>
    <li><a href="create-component.html#constructing-the-component" class="header">Constructing the Component</a></li>
    <li><a href="create-component.html#lifecycle" class="header">Lifecycle</a></li>
    <li><a href="create-component.html#logging" class="header">Logging</a></li>
    <li><a href="create-component.html#receiving-commands" class="header">Receiving Commands</a></li>
    <li><a href="create-component.html#building-and-running-component-in-standalone-mode" class="header">Building and Running component in standalone mode</a></li>
  </ul></li>
</ul>
</nav>

<div class="md-nav__title--site md-version" title="Version">
<i class="md-icon">label_outline</i> 0.1*
</div>
</nav>

</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="toc">Table of contents</label>
<ul>
  <li><a href="create-component.html#creating-a-component" class="header">Creating a Component</a>
  <ul>
    <li><a href="create-component.html#anatomy-of-component" class="header">Anatomy of Component</a></li>
    <li><a href="create-component.html#constructing-the-component" class="header">Constructing the Component</a></li>
    <li><a href="create-component.html#lifecycle" class="header">Lifecycle</a></li>
    <li><a href="create-component.html#logging" class="header">Logging</a></li>
    <li><a href="create-component.html#receiving-commands" class="header">Receiving Commands</a></li>
    <li><a href="create-component.html#building-and-running-component-in-standalone-mode" class="header">Building and Running component in standalone mode</a></li>
  </ul></li>
</ul>
</nav>

</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<div class="md-content__searchable">
<h1><a href="#creating-a-component" name="creating-a-component" class="anchor"><span class="anchor-link"></span></a>Creating a Component</h1>
<p>This tutorial helps in creating a CSW component in Scala/Java. CSW components depend on the <code>csw-framework</code> package, which can be referred <a href="framework.html">here</a>. This tutorial discusses constructing an HCD, but the principles apply to an Assembly as well. We wil be constructing the Assembly on the next tutorial section <a href="multiple-components.html">Working with Mulitple Components</a>. </p>
<h2><a href="#anatomy-of-component" name="anatomy-of-component" class="anchor"><span class="anchor-link"></span></a>Anatomy of Component</h2>
<p>A component consists of a supervisor actor, a Top Level Actor, a component handler and one or more worker actors. From all these, <code>csw-framework</code> provides supervisor actor, a Top Level Actor and abstract class of handlers. Component developers are expected to implement this handler which also acts as a gateway from framework to component code. </p>
<h3><a href="#supervisor" name="supervisor" class="anchor"><span class="anchor-link"></span></a>Supervisor</h3>
<p>A Supervisor actor is the actor first started for any component. The main responsibilities that supervisor performs is as follows:</p>
<ul>
  <li>Implement and manage the component lifecycle for the TLA and for the rest of the system (see <a href="#lifecycle">Lifecycle</a> below).</li>
  <li>Register itself with location service.</li>
  <li>Provide an administrative interface to the component to the rest of the system. For instance, the Container can perform certain administrative communication with the Supervisor such as restart or shutdown.</li>
  <li>Allow components outside of the Supervisor and TLA to monitor the lifecycle state of the TLA. This is particularly useful for testing. The test needs to know that the component is ready before it starts its test actions.</li>
</ul><div class="callout note "><div class="callout-title">Note</div>
<p>Because the Supervisor registers itself with location service, it serves as the gateway for all incoming communications from external components/entities.</p></div>
<p>The source code of supervisor actor can be referred <a href="https://github.com/tmtsoftware/csw-prod/blob/master/csw-framework/src/main/scala/csw/framework/internal/supervisor/SupervisorBehavior.scala">here</a></p>
<h3><a href="#top-level-actor" name="top-level-actor" class="anchor"><span class="anchor-link"></span></a>Top level actor</h3>
<p>While the Supervisor works as the external interface for the component and the manager of Lifecycle, the functional implementation of a component is implemented in a Top Level Actor (TLA), spawned by supervisor actor for any component. However, the developer is not expected to implement TLA code directly. Instead, the functionality of the TLA is added by implementing the <code>ComponentHandlers</code> abstract class, consisting of a list of a methods, or <code>hooks</code>, called by the TLA during specific lifecycle and command events (see <a href="#handlers">Handlers</a>). The <code>ComponentHandlers</code> implementation is specified during constructing using that factory (see <a href="#constructing-the-component">Constructing The Component</a>) </p>
<p>The source code of the Top Level Actor can be referred <a href="https://github.com/tmtsoftware/csw-prod/blob/master/csw-framework/src/main/scala/csw/framework/internal/component/ComponentBehavior.scala">here</a>.</p>
<h3><a href="#handlers" name="handlers" class="anchor"><span class="anchor-link"></span></a>Handlers</h3>
<p>The following hooks should be overridden in your ComponentHandlers implementation class:</p>
<ul>
  <li><code>initialize</code>: called when component is starting up, prior to be put into the Running state.</li>
  <li><code>validateCommand</code>: called when component receives a command. (see <a href="#validation">Validation</a>)</li>
  <li><code>onSubmit</code>: called on Submit command if validateCommand returns <code>Accepted</code>.</li>
  <li><code>onOneway</code>: called on Oneway command if validateCommand returns <code>Accepted</code>.</li>
  <li><code>onGoOffline</code>: called when component receives external message to go offline.</li>
  <li><code>onGoOnline</code>: called when component receives external message to go online.</li>
  <li><code>onLocationTrackingEvent</code>: called when a tracked dependency changes location state. (see <a href="multiple-components.html#tracking-dependencies">Tracking Dependencies</a>)</li>
  <li><code>onShutdown</code>: called when component is shutting down.</li>
</ul>
<p>The source code of <code>ComponentHandlers</code> can be referred <a href="https://github.com/tmtsoftware/csw-prod/blob/master/csw-framework/src/main/scala/csw/framework/scaladsl/ComponentHandlers.scala">here</a>. </p>
<p>More details about handler significance and invocation can be referred <a href="framework.html#handling-lifecycle">here</a></p><div class="callout note "><div class="callout-title">Note</div>
<p>If the component developer wishes to write the handler implementation in java, then he/she needs to implement the java version of <code>ComponentHandlers</code> which is <code>JComponentHandlers</code>. The source code of <code>JComponentHandlers</code> can be referred <a href="https://github.com/tmtsoftware/csw-prod/blob/master/csw-framework/src/main/scala/csw/framework/javadsl/JComponentHandlers.scala">here</a>. Any further reference to <code>ComponentHandlers</code> should implicitly also apply to <code>JComponentHandlers</code>.</p></div>
<h2><a href="#constructing-the-component" name="constructing-the-component" class="anchor"><span class="anchor-link"></span></a>Constructing the Component</h2>
<p>After writing the handlers, component developer needs to wire it up with framework. In order to do this, developer needs to implement a <code>ComponentBehaviorFactory</code>. This factory should to be configured in configuration file for the component (see example below). The <code>csw-framework</code> then picks up the full path of <code>ComponentBehaviorFactory</code> from configuration file and spawns the component handlers using this factory as a process of booting a component. The factory is instantiated using java reflection.</p><div class="callout note "><div class="callout-title">Note</div>
<p>If using the giter8 template, this factory class will be implemented for you.</p></div>
<p>The sample code to implement the <code>ComponentBehaviorFactory</code> can be referred <a href="framework.html#creating-components">here</a> </p>
<h3><a href="#component-configuration-componentinfo-" name="component-configuration-componentinfo-" class="anchor"><span class="anchor-link"></span></a>Component Configuration (ComponentInfo)</h3>
<p>Component configuration contains details needed to spawn a component. This configuration resides in a configuration file for a particular component. The sample for HCD is as follows:</p>
<pre><code>{
    name = &quot;Motion_Controller&quot;
    componentType = hcd
    behaviorFactoryClassName = tcs.hcd.SampleComponentBehaviorFactory
    prefix = tcs.mobie.blue.filter
    locationServiceUsage = RegisterOnly
}
</code></pre><div class="callout note "><div class="callout-title">Note</div>
<p><code>behaviorFactoryClassName</code> refers to class name of the concrete implementation of <code>ComponentBehaviorFactory</code>, which is <code>SampleComponentBehaviorFactory</code> in above sample.</p></div>
<p>The <code>name</code> and <code>componentType</code> is used to create the <code>ComponentId</code> representing a unique component in location service.</p>
<p>The <code>locationServiceUsage</code> is referred by the Supervisor actor to decide whether to only register a component with location service or register and track other components.</p>
<p>The configuration file is parsed to a <code>ComponentInfo</code> object and injected in the Supervisor actor. It is then injected in <code>ComponentHandlers</code> while spawning a component.</p>
<p>The configuration can also contain a list of components and services it wishes to track as dependencies. See <a href="multiple-components.html#tracking-dependencies">Tracking Dependencies</a>.</p>
<p>More details about <code>ComponentInfo</code> can be referred <a href="framework.html#describing-components">here</a>.</p>
<p>A sample configuration file can be referred <a href="https://github.com/tmtsoftware/csw-prod/blob/master/csw-benchmark/src/main/resources/container.conf">here</a>.</p>
<h2><a href="#lifecycle" name="lifecycle" class="anchor"><span class="anchor-link"></span></a>Lifecycle</h2>
<p>A component can be in one of the following states of lifecycle:</p>
<ul>
  <li>Idle</li>
  <li>Running</li>
  <li>RunningOffline</li>
  <li>Restart</li>
  <li>Shutdown</li>
  <li>Lock</li>
</ul>
<h3><a href="#idle" name="idle" class="anchor"><span class="anchor-link"></span></a>Idle</h3>
<p>The component initializes in the idle state. Top level actor calls the <code>initialize</code> hook of <code>ComponentHandlers</code> as first thing on boot-up. Component developers write their initialization logic in this hook. The logic could also do things like accessing the configuration service to fetch the hardware configurations to set the hardware to default positions.</p>
<p>After the initialization, if the component would have configured <code>RegisterAndTrack</code> for <code>locationServiceUsage</code> then the Top Level Actor will start tracking the <code>connections</code> configured for that component. This use case is mostly applicable for Sequencers and Assemblies. HCDs mostly will have <code>RegisterOnly</code> configured for <code>locationServiceUsage</code>.</p>
<p>The Supervisor actor will now register itself with location service. Registering with location service will notify other components tracking this component with a <code>LocationUpdated</code> event containing a <code>Location</code> with a reference to the Supervisor actor.</p>
<p>After successful registration, the component will transition to <code>Running</code> state. </p>
<h3><a href="#running" name="running" class="anchor"><span class="anchor-link"></span></a>Running</h3>
<p>When the supervisor actor receives <code>Initialized</code> message from the Top Level Actor after successful initialization, it registers itself with location service and transitions the component to <code>Running</code> state. Running state signifies that the component is accessible via location service, which allows other entities to communicate with it by sending commands via messages. Any commands received by supervisor actor will be forwarded to the Top Level Actor for processing.</p>
<h3><a href="#runningoffline" name="runningoffline" class="anchor"><span class="anchor-link"></span></a>RunningOffline</h3>
<p>When the Supervisor actor receives <code>GoOffline</code> message, it transitions the component to <code>RunningOffline</code> state and forwards it to the Top Level Actor. The Top Level Actor then calls <code>onGoOffline</code> hook of <code>ComponentHandlers</code>.</p>
<p>If <code>GoOnline</code> message is received by the Supervisor actor then it transits the component back to <code>Running</code> state and forwards it to the Top Level Actor. The Top Level Actor then calls <code>onGoOnline</code> hook of <code>ComponentHandlkers</code>.</p><div class="callout note "><div class="callout-title">Note</div>
<p>In <code>RunningOffline</code> state, if any command is received, it is forwarded to underlying component hook through the Top Level Actor. It is then the responsibility of the component developer to check the <code>isOnline</code> flag provided by <code>csw-framework</code> and process the command accordingly. </p></div>
<h3><a href="#restart" name="restart" class="anchor"><span class="anchor-link"></span></a>Restart</h3>
<p>When the Supervisor actor receives a <code>Restart</code> message, it will transit the component to the <code>Restart</code> state. Then, it will unregister itself from location service so that other components tracking this component will be notified and no commands are received while restart is in progress.</p>
<p>Then, the Top Level Actor is stopped and postStop hook of the Top Level Actor will call the <code>onShutdown</code> hook of <code>ComponentHandlers</code>. Component developers are expected to write any cleanup of resources or logic that should be executed for graceful shutdown of component in this hook. </p>
<p>After successful shutdown of component, the Supervisor actor will create the Top Level Actor again from scratch. This will cause the <code>initialize</code> hook of <code>ComponentHandlers</code> to be called again. After successful initialization of component, the Supervisor actor will register itself with location service.</p>
<h3><a href="#shutdown" name="shutdown" class="anchor"><span class="anchor-link"></span></a>Shutdown</h3>
<p>When the Supervisor actor receives a <code>Shutdown</code> message, it transitions the component to the <code>Shutdown</code> state. Any commands received while shutdown is in progress will be ignored. Then, it will stop the Top Level Actor. The postStop hook of the Top Level Actor will call the <code>onShutdown</code> hook of <code>ComponentHandlers</code>. Component developers are expected to write any cleanup of resources or logic that should be executed for graceful shutdown of component in this hook.</p>
<h3><a href="#lock" name="lock" class="anchor"><span class="anchor-link"></span></a>Lock</h3>
<p>When the Supervisor actor receives a <code>Lock</code> message, it transitions the component to the <code>Lock</code> state. Upon locking, the Supervisor will only accept the commands received from the component that locked the component and ignore all others.</p>
<p>In the <code>Lock</code> state, messages like <code>Shutdown</code> and <code>Restart</code> will also be ignored. A component must first be unlocked to accept these commands.</p>
<p><code>Lock</code> messages are constructed with a duration value specified. When this duration expires, the component will automatically be unlocked. A component can be manually unlocked by sending an <code>Unlock</code> message.</p>
<h2><a href="#logging" name="logging" class="anchor"><span class="anchor-link"></span></a>Logging</h2>
<p><code>csw-framework</code> will provide a <code>LoggerFactory</code> as dependency injection in constructor of <code>ComponentHandlers</code>. The <code>LoggerFactory</code> will have the component&rsquo;s name predefined in it. The component developer is expected to use this factory to log statements.</p>
<p>More details on how to use <code>LoggerFactory</code> can be referred <a href="services/logging.html#enable-component-logging">here</a>. </p>
<h2><a href="#receiving-commands" name="receiving-commands" class="anchor"><span class="anchor-link"></span></a>Receiving Commands</h2>
<p>A command is something that carries some metadata and a set of parameters. A component sends message to other components using <code>commands</code>. Various kinds of commands are as follows:</p>
<ul>
  <li>Setup : Contains goal, command, or demand information to be used to  configure the target OMOA component.</li>
  <li>Observe: Contains goal or demand information to be used by a detector.  system. Properties and their value types will be standardized  by the ESW for the ESW PDR.</li>
  <li>Wait: Sequencer only. Instructs a sequencer to pause until told to continue.</li>
</ul>
<p>More details about creating commands can be referred <a href="messages.html#setup-command">here</a>.</p>
<p>Whenever a command is sent to a component it is wrapped inside a command wrapper. There are two kinds of command wrapper:</p>
<ul>
  <li>Submit: A command is wrapped in submit when the completion result is expected from receiver component</li>
  <li>Oneway: A command is wrapped in oneway when the completion of command is not expected from receiver component but is determined by sender component by subscribing to receiver component&rsquo;s  state</li>
</ul>
<h3><a href="#validation" name="validation" class="anchor"><span class="anchor-link"></span></a>Validation</h3>
<p>When a command is received by a component, the Top Level Actor will call the <code>validateCommand</code> hook of <code>ComponentHandlers</code>. Component developers are expected to perform appropriate validation of command, whether it is valid to execute, and return a <code>CommandResponse</code>. The <code>CommandResponse</code> returned from this hook will be sent back to sender directly by <code>csw-framework</code>.</p>
<p>The logic in <code>validateCommand</code> hook can used to handle commands of various durations. If the command can be executed immediately, then the component developer can return a final response directly in the validation step using a <code>CompletedWithResult</code> command response.<br/>This should be only used for commands that require a very small amount of time to execute. If the command will take longer, then component developer should return an intermediate response <code>Accepted</code> or <code>Invalid</code> specifying whether the command is valid to be executed or not, and process the command in the <code>onSubmit</code> or <code>onOneway</code> handlers (see <a href="#command-response">Command Response</a>).</p>
<p>Different types of command responses and their significance can be referred <a href="command.html#command-based-communication-between-components">here</a>.</p>
<h3><a href="#command-response" name="command-response" class="anchor"><span class="anchor-link"></span></a>Command Response</h3>
<p>The response returned from <code>validateCommand</code> hook of <code>ComponentHandlers</code> will be received by the Top Level Actor, who then sends the response back to sender. If the response returned was <code>Accepted</code>, then it either calls the <code>onSubmit</code> hook or the <code>onOneway</code> hook of <code>ComponentHandlers</code> depending on the wrapper(submit or oneway) in which the command was received. </p>
<p>If the command was received as a <code>Submit</code>, then the Top Level Actor adds the response returned from the <code>validateCommand</code> hook in the <code>CommandResponseManager</code>. If the response was <code>Accepted</code>, the TLA then calls the <code>onSubmit</code> hook of <code>ComponentHandlers</code>. </p>
<p>In case the command received by a component a <code>Oneway</code>, the response is not added to the <code>CommandResponseManager</code>, and the <code>onOneway</code> hook of <code>ComponentHandlers</code> is called.</p>
<p>The <code>CommandResponseManager</code> is responsible for managing and bookkeeping the command status of long running submit commands. The sender of the command (and any component, really) can query the command statuses or subscribe to changes in command statuses using <code>CommandService</code>. </p>
<p>The <code>CommandService</code> class provides helper methods for communicating with other components, and should be a component&rsquo;s primary means of sending commands to other components. This will be described in the next tutorial section, <a href="multiple-components.html#sending-commands">Sending Commands</a>.</p>
<p>When the <code>onSubmit</code> hook is called, it is the responsibility of component developers to update the status of the received command in the <code>CommandResponseManager</code> as it changes. The instance of commandResponseManager is provided in <code>ComponentHandlers</code> which should be injected in any worker actor or other actor/class created for the component. </p>
<p>More details on methods available in <code>CommandResponseManager</code> can be referred <a href="framework.html#managing-command-state">here</a>.</p>
<h2><a href="#building-and-running-component-in-standalone-mode" name="building-and-running-component-in-standalone-mode" class="anchor"><span class="anchor-link"></span></a>Building and Running component in standalone mode</h2>
<p>Once the component is ready, it is started using the <code>ContainerCmd</code> object in standalone mode. The details about starting the <code>ContainerCmd</code> in standalone mode can be referred <a href="https://tmtsoftware.github.io/csw-prod/framework/deploying-components.html">here</a>.</p>
<p>To run the component using the deployment package, perform the following steps:</p>
<ul>
  <li>Run <code>sbt &lt;project&gt;/universal:packageBin</code>. This will create self contained zip in <code>&lt;project&gt;/target/universal</code> directory</li>
  <li>Unzip generated zip file and enter into bin directory</li>
  <li>Run the <code>./&lt;project&gt;-cmd-app --local --standalone &lt;path-to-local-config-file-to-start-the-component&gt;</code></li>
</ul><div class="callout note "><div class="callout-title">Note</div>
<p>CSW Location Service cluster seed must be running, and appropriate environment variables set to run apps. See <a href="https://tmtsoftware.github.io/csw-prod/apps/cswclusterseed.html">https://tmtsoftware.github.io/csw-prod/apps/cswclusterseed.html</a>.</p></div>
</div>
<div>
<a href="https://github.com/tmtsoftware/csw-prod/tree/master/docs/src/main/create-component.md" title="Edit this page" class="md-source-file md-edit">
Edit this page
</a>
</div>
<div class="print-only">
<span class="md-source-file md-version">
0.1*
</span>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a href="getting-started.html" title="Getting Started" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Previous
</span>
Getting Started
</span>
</div>
</a>
<a href="multiple-components.html" title="Multiple Components" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Next
</span>
Multiple Components
</span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
Powered by
<a href="https://github.com/lightbend/paradox">Paradox</a>
and
<a href="https://jonas.github.io/paradox-material-theme/">Paradox Material Theme</a>

</div>
</div>
</div>
</footer>

</div>
<script src="assets/javascripts/application.5165553b.js"></script>
<script src="assets/javascripts/paradox-material-theme.js"></script>
<script>app.initialize({version:"0.17",url:{base:"."}})</script>
<script type="text/javascript" src="lib/prettify/prettify.js"></script>
<script type="text/javascript" src="lib/prettify/lang-scala.js"></script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
window.prettyPrint && prettyPrint();
});
</script>
</body>
</html>
