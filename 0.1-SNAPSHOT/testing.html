<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="description" content="docs">
<meta name="generator" content="Paradox, paradox-material-theme=0.4.0, mkdocs-material=2.2.2">

<meta name="lang:clipboard.copy" content="Copy to clipboard">
<meta name="lang:clipboard.copied" content="Copied to clipboard">
<meta name="lang:search.result.none" content="No matching documents">
<meta name="lang:search.result.one" content="1 matching document">
<meta name="lang:search.result.other" content="# matching documents">
<meta name="lang:search.language" content="">
<meta name="lang:search.tokenizer" content="[\s\-]+">


<meta name="description" content="docs">
<link rel="shortcut icon" href="assets/tmt_favicon.ico">
<title>Testing Â· TMT Common Software (CSW)</title>
<link rel="stylesheet" href="assets/stylesheets/application.7a4cdee3.css">
<link rel="stylesheet" href="lib/material__tabs/dist/mdc.tabs.min.css">
<link rel="stylesheet" href="lib/prettify/prettify.css">
<script src="lib/modernizr/modernizr.min.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
<style>
body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}
code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}
</style>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="assets/stylesheets/paradox-material-theme.css">
</head>
<body
>
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
<label class="md-overlay" data-md-component="overlay" for="drawer"></label>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a href="index.html" title="TMT Common Software (CSW)" class="md-header-nav__button md-logo">
<i class="md-icon">local_library</i>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
TMT Common Software (CSW)
</span>
<span class="md-header-nav__topic">
Testing
</span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="search"></label>
<div class="md-search__inner">
<form class="md-search__form" name="search">
<input type="text" class="md-search__input" name="query" required placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
<label class="md-icon md-search__icon" for="search"></label>
<button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix>
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
Type to start searching
</div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>

</div>
<div class="md-flex__cell md-flex__cell--shrink">
<div class="md-header-nav__source">
<a href="https://github.com/tmtsoftware/csw-prod"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
tmtsoftware/csw-prod
</div>
</a>

</div>
</div>
</div>
</nav>
</header>

<div class="md-container">
<main class="md-main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0" style="visibility: hidden">
<label class="md-nav__title md-nav__title--site" for="drawer">
<span class="md-nav__button md-logo">
<i class="md-icon">local_library</i>
</span>
<a href="index.html" title="TMT Common Software (CSW)">
TMT Common Software (CSW)
</a>
</label>
<div class="md-nav__source">
<a href="https://github.com/tmtsoftware/csw-prod"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
tmtsoftware/csw-prod
</div>
</a>

</div>
<ul>
  <li><a href="csw-overview.html" class="page">Using CSW</a></li>
  <li><a href="getting-started.html" class="page">Getting Started</a></li>
  <li><a href="create-component.html" class="page">Creating a Component</a></li>
  <li><a href="multiple-components.html" class="page">Multiple Components</a></li>
  <li><a href="messages.html" class="page">Messages</a>
  <ul>
    <li><a href="messages/keys-parameters.html" class="page">Keys and Parameters</a></li>
    <li><a href="messages/units.html" class="page">Units</a></li>
    <li><a href="messages/subsystem.html" class="page">Subsystem</a></li>
    <li><a href="messages/commands.html" class="page">Commands</a></li>
    <li><a href="messages/events.html" class="page">Events</a></li>
    <li><a href="messages/states.html" class="page">State variables</a></li>
    <li><a href="messages/result.html" class="page">Result</a></li>
  </ul></li>
  <li><a href="framework.html" class="page">Framework for creating components (HCD, Assembly, Container)</a>
  <ul>
    <li><a href="framework/describing-components.html" class="page">ComponentInfo</a></li>
    <li><a href="framework/creating-components.html" class="page">Creating an Assembly or Hcd Component</a></li>
    <li><a href="framework/handling-lifecycle.html" class="page">Lifecycle support</a></li>
    <li><a href="framework/managing-command-state.html" class="page">Managing Command State</a></li>
    <li><a href="framework/tracking-connections.html" class="page">Tracking Connections</a></li>
    <li><a href="framework/publishing-state.html" class="page">Publishing State</a></li>
    <li><a href="framework/handling-exceptions.html" class="page">Handling Exceptions</a></li>
    <li><a href="framework/deploying-components.html" class="page">Deploying Components</a></li>
  </ul></li>
  <li><a href="services.html" class="page">Services</a>
  <ul>
    <li><a href="services/location.html" class="page">Location service</a></li>
    <li><a href="services/config.html" class="page">Configuration service</a></li>
    <li><a href="services/logging.html" class="page">Logging service</a></li>
  </ul></li>
  <li><a href="command.html" class="page">Communication using Commands</a></li>
  <li><a href="testing.html" class="active page">Testing</a></li>
  <li><a href="apps.html" class="page">Applications</a>
  <ul>
    <li><a href="apps/cswclusterseed.html" class="page">csw-cluster-seed</a></li>
    <li><a href="apps/cswlocationagent.html" class="page">csw-location-agent</a></li>
    <li><a href="apps/cswonfigserverapp.html" class="page">csw-config-server</a></li>
    <li><a href="apps/cswconfigclientcli.html" class="page">csw-config-client-cli</a></li>
    <li><a href="apps/hostconfig.html" class="page">csw-host-config</a></li>
  </ul></li>
  <li><a href="manuals.html" class="page">Manuals</a></li>
  <li><a href="sbt-tasks.html" class="page">sbt tasks</a></li>
</ul>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="toc">Table of contents</label>
<ul>
  <li><a href="testing.html#testing" class="header">Testing</a>
  <ul>
    <li><a href="testing.html#unit-tests" class="header">Unit Tests</a></li>
    <li><a href="testing.html#acceptance-tests" class="header">Acceptance Tests</a></li>
    <li><a href="testing.html#multi-jvm-tests" class="header">Multi-JVM Tests</a></li>
    <li><a href="testing.html#mockito" class="header">Mockito</a></li>
  </ul></li>
</ul>
</nav>

<div class="md-nav__title--site md-version" title="Version">
<i class="md-icon">label_outline</i> 0.1*
</div>
</nav>

</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="toc">Table of contents</label>
<ul>
  <li><a href="testing.html#testing" class="header">Testing</a>
  <ul>
    <li><a href="testing.html#unit-tests" class="header">Unit Tests</a></li>
    <li><a href="testing.html#acceptance-tests" class="header">Acceptance Tests</a></li>
    <li><a href="testing.html#multi-jvm-tests" class="header">Multi-JVM Tests</a></li>
    <li><a href="testing.html#mockito" class="header">Mockito</a></li>
  </ul></li>
</ul>
</nav>

</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<div class="md-content__searchable">
<h1><a href="#testing" name="testing" class="anchor"><span class="anchor-link"></span></a>Testing</h1>
<p>This page will help you getting started with testing your applications. </p>
<h2><a href="#unit-tests" name="unit-tests" class="anchor"><span class="anchor-link"></span></a>Unit Tests</h2>
<p>The goal of unit testing is to segregate smallest testable units of your application and test that it is working correctly. It is always good idea to write more number of unit test cases and relatively less component and integration tests. If you want to get an idea of how many tests you should have in different types of testing phases (Unit/Component/Integration), refer this <a href="https://martinfowler.com/articles/practical-test-pyramid.html">blog</a></p>
<p>Unit testing simple scala/java classes or objects is straight forward. You can mock external dependencies using Mockito. Refer <a href="#mockito">Mockito</a> section for more details. </p>
<p>Follow below guides for testing your application which uses different modules of akka:</p>
<ul>
  <li><a href="https://doc.akka.io/docs/akka/current/testing.html">Akka Untyped Actors</a></li>
  <li><a href="https://doc.akka.io/docs/akka/current/typed/testing.html">Akka Typed Actors</a></li>
  <li><a href="https://doc.akka.io/docs/akka/current/scala/stream/stream-testkit.html">Akka Streams</a></li>
</ul>
<h2><a href="#acceptance-tests" name="acceptance-tests" class="anchor"><span class="anchor-link"></span></a>Acceptance Tests</h2>
<p>This section explains how and where csw-prod maintains and execute acceptance tests. If you are a component writer and want to maintain acceptance tests, you can create a repo similar to <a href="https://github.com/tmtsoftware/csw-acceptance">csw-acceptance</a> and update dependencies, projects as per your need. </p>
<p>As part of acceptance tests, we run all the existing java and scala tests from <a href="https://github.com/tmtsoftware/csw-prod">csw-prod</a> repo on published bintray binaries rather than directly on source code.</p>
<p>More information can be found <a href="https://github.com/tmtsoftware/csw-acceptance/blob/master/README.md">here</a>.</p>
<p>Below are the two separate jenkins pipelines to run <code>csw-prod</code> acceptance tests:</p>
<ol>
  <li>
    <p><a href="http://ec2-35-154-215-191.ap-south-1.compute.amazonaws.com:8080/job/acceptance-dev-nightly-build/">Acceptance Dev Pipeline</a></p>
    <ul>
      <li>Auto triggered every night to get fast feedback and intended for developer&rsquo;s visibility.</li>
    </ul>
  </li>
  <li>
    <p><a href="http://ec2-35-154-215-191.ap-south-1.compute.amazonaws.com:8080/job/acceptance-release/">Acceptance Release Pipeline</a></p>
    <ul>
      <li>Auto triggered on completion of <a href="http://ec2-35-154-215-191.ap-south-1.compute.amazonaws.com:8080/job/csw-prod-release/">csw-prod-release</a> pipeline.</li>
      <li>Admin needs to manually trigger <code>csw-prod-release</code> pipeline.</li>
    </ul>
  </li>
</ol>
<p>Acceptance pipelines are enabled to be triggered remotely. This is required, so that <code>csw-prod-release</code> pipeline can trigger <code>acceptance-release</code> pipeline which would be created in different jenkins server hosted in STILL environment. In case you want to trigger it via http end point, first you need to have security <code>token</code> configured in jenkins pipeline to trigger the job remotely and then run <code>curl</code> cmd as shown below:</p>
<ul>
  <li>For triggering <a href="http://ec2-35-154-215-191.ap-south-1.compute.amazonaws.com:8080/job/acceptance-dev-nightly-build/">acceptance-dev</a> pipeline, run below</li>
</ul>
<pre><code>curl -G &#39;http://ec2-35-154-215-191.ap-south-1.compute.amazonaws.com:8080/job/acceptance-dev/buildWithParameters&#39;  \
    --data-urlencode token=$DEV_TOKEN \
    --data-urlencode DEV_VERSION=0.1-SNAPSHOT \
    --data-urlencode BUILD_ENV=DEV
</code></pre>
<ul>
  <li>For triggering <code>acceptance-release</code> pipeline, run below: (Modify parameters as applicable)</li>
</ul>
<pre><code>curl -G &#39;$REMOTE_JENKINS_URL/job/$JOB_NAME/buildWithParameters&#39; \
    --data-urlencode token=$RELEASE_TOKEN \
    --data-urlencode RELEASE_VERSION=$RELEASE_VERSION \
    --data-urlencode BUILD_ENV=PROD
</code></pre><div class="callout note "><div class="callout-title">Note</div>
<p><a href="http://ec2-35-154-215-191.ap-south-1.compute.amazonaws.com:8080/job/csw-prod-release/">csw-prod-release</a> pipeline is responsible for following tasks:</p>
<ul>
  <li>build and run <code>csw-prod</code> tests</li>
  <li>publish binaries to bintray</li>
  <li>publish paradox documentation</li>
  <li>publish apps and release notes to github releases</li>
  <li>trigger <a href="http://ec2-35-154-215-191.ap-south-1.compute.amazonaws.com:8080/job/acceptance-release/">acceptance-release</a> pipeline</li>
</ul></div>
<h2><a href="#multi-jvm-tests" name="multi-jvm-tests" class="anchor"><span class="anchor-link"></span></a>Multi-JVM Tests</h2>
<p>Testing asynchronous distributed systems requires special tooling/framework support. Sbt has a plugin called <a href="https://github.com/sbt/sbt-multi-jvm">sbt-multi-jvm</a> which helps to test systems across multiple JVMs or machines. This is especially useful for integration testing where multiple systems communicate with each other.</p>
<p>You can find more details on multi jvm tests <a href="https://doc.akka.io/docs/akka/current/multi-jvm-testing.html">here</a>.</p>
<p>You can also refer <a href="https://github.com/tmtsoftware/csw-prod">csw-prod</a> for writing your own multi JVM tests. For example: <a href="https://github.com/tmtsoftware/csw-prod/tree/master/csw-framework/src/multi-jvm/scala/csw/framework/command/CommandServiceTest.scala">CommandServiceTest.scala</a> </p>
<p>In case you want to run your multi jvm tests across machines, refer this multi node testing guide <a href="https://doc.akka.io/docs/akka/current/multi-node-testing.html">here</a>. </p>
<h2><a href="#mockito" name="mockito" class="anchor"><span class="anchor-link"></span></a>Mockito</h2>
<p><a href="https://github.com/tmtsoftware/csw-prod">csw-prod</a> uses <a href="http://site.mockito.org/">Mockito</a> for writing unit tests. ScalaTest comes with <a href="http://www.scalatest.org/user_guide/testing_with_mock_objects#mockito">MockitoSugar</a> trait which provides some basic syntax sugar for Mockito.</p>
<p>For example: <a href="https://github.com/tmtsoftware/csw-prod/tree/master/csw-framework/src/test/scala/csw/framework/internal/container/ContainerBehaviorTest.scala">ContainerBehaviorTest.scala</a></p>
</div>
<div>
<a href="https://github.com/tmtsoftware/csw-prod/tree/master/docs/src/main/testing.md" title="Edit this page" class="md-source-file md-edit">
Edit this page
</a>
</div>
<div class="print-only">
<span class="md-source-file md-version">
0.1*
</span>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a href="command.html" title="Communication using Commands" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Previous
</span>
Communication using Commands
</span>
</div>
</a>
<a href="apps.html" title="Applications" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Next
</span>
Applications
</span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
Powered by
<a href="https://github.com/lightbend/paradox">Paradox</a>
and
<a href="https://jonas.github.io/paradox-material-theme/">Paradox Material Theme</a>

</div>
</div>
</div>
</footer>

</div>
<script src="assets/javascripts/application.5165553b.js"></script>
<script src="assets/javascripts/paradox-material-theme.js"></script>
<script>app.initialize({version:"0.17",url:{base:"."}})</script>
<script type="text/javascript" src="lib/prettify/prettify.js"></script>
<script type="text/javascript" src="lib/prettify/lang-scala.js"></script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
window.prettyPrint && prettyPrint();
});
</script>
</body>
</html>
