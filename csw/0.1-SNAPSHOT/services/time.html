<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="description" content="docs">
<meta name="generator" content="Paradox, paradox-material-theme=0.6.0, mkdocs-material=3.0.3">

<meta name="lang:clipboard.copy" content="Copy to clipboard">
<meta name="lang:clipboard.copied" content="Copied to clipboard">
<meta name="lang:search.language" content="">
<meta name="lang:search.pipeline.stopwords" content="true">
<meta name="lang:search.pipeline.trimmer" content="true">
<meta name="lang:search.result.none" content="No matching documents">
<meta name="lang:search.result.one" content="1 matching document">
<meta name="lang:search.result.other" content="# matching documents">
<meta name="lang:search.tokenizer" content="[\s\-]+">


<meta name="description" content="docs">
<link rel="shortcut icon" href="../assets/tmt_favicon.ico">
<title>Time Service · TMT Common Software (CSW)</title>
<link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
<link rel="stylesheet" href="../lib/material__tabs/dist/mdc.tabs.min.css">
<link rel="stylesheet" href="../lib/prettify/prettify.css">
<script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
<style>
body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}
code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}
</style>
<link rel="stylesheet" href="../assets/fonts/font-awesome.css">
<link rel="stylesheet" href="../assets/fonts/material-icons.css">
<link rel="stylesheet" href="../assets/stylesheets/paradox-material-theme.css">
</head>
<body
>
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a href="../index.html" title="TMT Common Software (CSW)" class="md-header-nav__button md-logo">
<i class="md-icon">local_library</i>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
TMT Common Software (CSW)
</span>
<span class="md-header-nav__topic">
Time Service
</span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
<label class="md-icon md-search__icon" for="__search"></label>
<button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix>
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
Type to start searching
</div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>

</div>
<div class="md-flex__cell md-flex__cell--shrink">
<div class="md-header-nav__source">
<a href="https://github.com/tmtsoftware/csw"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
tmtsoftware/csw
</div>
</a>

</div>
</div>
</div>
</nav>
</header>

<div class="md-container">
<main class="md-main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0" style="visibility: hidden">
<label class="md-nav__title md-nav__title--site" for="drawer">
<a href="../index.html" title="TMT Common Software (CSW)" class="md-nav__button md-logo">
<span class="md-nav__button md-logo">
<i class="md-icon">local_library</i>
</a>
<a href="../index.html" title="TMT Common Software (CSW)">
TMT Common Software (CSW)
</a>
</label>
<div class="md-nav__source">
<a href="https://github.com/tmtsoftware/csw"
title="Go to repository"
class="md-source"
data-md-source="github">
<div class="md-source__icon">
<i class="fa fa-github"></i>
</div>
<div class="md-source__repository">
tmtsoftware/csw
</div>
</a>

</div>
<ul>
  <li><a href="../commons/getting-started.html" class="page">Getting Started</a></li>
  <li><a href="../commons/create-component.html" class="page">Creating a Component</a></li>
  <li><a href="../commons/multiple-components.html" class="page">Multiple Components</a></li>
  <li><a href="../commons/using-alarms.html" class="page">Using Alarms</a></li>
  <li><a href="../commons/unit-tests.html" class="page">Adding Unit Tests</a></li>
  <li><a href="../commons/messages.html" class="page">Messages</a>
  <ul>
    <li><a href="../messages/keys-parameters.html" class="page">Keys and Parameters</a></li>
    <li><a href="../messages/units.html" class="page">Units</a></li>
    <li><a href="../messages/subsystem.html" class="page">Subsystem</a></li>
    <li><a href="../messages/commands.html" class="page">Commands</a></li>
    <li><a href="../messages/events.html" class="page">Events</a></li>
    <li><a href="../messages/states.html" class="page">State Variables</a></li>
    <li><a href="../messages/result.html" class="page">Result</a></li>
  </ul></li>
  <li><a href="../commons/framework.html" class="page">Framework for creating components (HCD, Assembly, Container)</a>
  <ul>
    <li><a href="../framework/describing-components.html" class="page">ComponentInfo</a></li>
    <li><a href="../framework/creating-components.html" class="page">Creating an Assembly or Hcd Component</a></li>
    <li><a href="../framework/handling-lifecycle.html" class="page">Component Handlers</a></li>
    <li><a href="../framework/managing-command-state.html" class="page">Managing Command State</a></li>
    <li><a href="../framework/tracking-connections.html" class="page">Tracking Connections</a></li>
    <li><a href="../framework/publishing-state.html" class="page">Publishing State</a></li>
    <li><a href="../framework/handling-exceptions.html" class="page">Handling Exceptions</a></li>
    <li><a href="../framework/deploying-components.html" class="page">Deploying Components</a></li>
  </ul></li>
  <li><a href="../commons/command.html" class="page">Communication using Commands</a></li>
  <li><a href="../commons/services.html" class="page">Services</a>
  <ul>
    <li><a href="../services/location.html" class="page">Location Service</a></li>
    <li><a href="../services/config.html" class="page">Configuration Service</a></li>
    <li><a href="../services/logging.html" class="page">Logging Service</a></li>
    <li><a href="../services/event.html" class="page">Event Service</a></li>
    <li><a href="../services/alarm.html" class="page">Alarm Service</a></li>
    <li><a href="../services/time.html" class="active page">Time Service</a></li>
    <li><a href="../services/database.html" class="page">Database Service</a></li>
    <li><a href="../services/aas.html" class="page">Authentication and Authorization Service (AAS)</a></li>
  </ul></li>
  <li><a href="../commons/apps.html" class="page">Applications</a>
  <ul>
    <li><a href="../apps/cswlocationserver.html" class="page">csw-location-server</a></li>
    <li><a href="../apps/cswadminserver.html" class="page">csw-admin-server</a></li>
    <li><a href="../apps/cswlocationagent.html" class="page">csw-location-agent</a></li>
    <li><a href="../apps/cswonfigserverapp.html" class="page">csw-config-server</a></li>
    <li><a href="../apps/cswconfigcli.html" class="page">csw-config-cli</a></li>
    <li><a href="../apps/csweventcli.html" class="page">csw-event-cli</a></li>
    <li><a href="../apps/cswalarmcli.html" class="page">csw-alarm-cli</a></li>
    <li><a href="../apps/hostconfig.html" class="page">csw-host-config</a></li>
  </ul></li>
  <li><a href="../commons/testing.html" class="page">Testing</a></li>
  <li><a href="../commons/sbt-tasks.html" class="page">sbt Tasks</a></li>
  <li><a href="../commons/manuals.html" class="page">Manuals</a></li>
</ul>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="../services/time.html#time-service" class="header">Time Service</a>
  <ul>
    <li><a href="../services/time.html#dependencies" class="header">Dependencies</a></li>
    <li><a href="../services/time.html#time-service-api-flavors" class="header">Time Service API Flavors</a></li>
    <li><a href="../services/time.html#source-code-for-tmttime-examples" class="header">Source code for TMTTime examples</a></li>
    <li><a href="../services/time.html#source-code-for-scheduler-examples" class="header">Source code for Scheduler examples</a></li>
  </ul></li>
</ul>
</nav>

</nav>
<ul style="display: none">
<li class="md-nav__item md-version" id="project.version">
<label class="md-nav__link" for="__version">
<i class="md-icon" title="Version">label_outline</i> 0.1*
</label>
</li>
</ul>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="../services/time.html#time-service" class="header">Time Service</a>
  <ul>
    <li><a href="../services/time.html#dependencies" class="header">Dependencies</a></li>
    <li><a href="../services/time.html#time-service-api-flavors" class="header">Time Service API Flavors</a></li>
    <li><a href="../services/time.html#source-code-for-tmttime-examples" class="header">Source code for TMTTime examples</a></li>
    <li><a href="../services/time.html#source-code-for-scheduler-examples" class="header">Source code for Scheduler examples</a></li>
  </ul></li>
</ul>
</nav>

</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<div class="md-content__searchable">
<h1><a href="#time-service" name="time-service" class="anchor"><span class="anchor-link"></span></a>Time Service</h1>
<p>The Time Service provides APIs to access time in Coordinated Universal Time (UTC) and International Atomic Time (TAI) time scales with up to nano second precision when available. It also provides APIs for scheduling periodic and non-periodic tasks in the future, which are optimised for scheduling at up to 1KHz frequency.</p>
<p>TMT has standardised on the use of <a href="https://en.wikipedia.org/wiki/Precision_Time_Protocol">Precision Time Protocol (PTP)</a> as the basis of time to achieve sub-microsecond accuracy and precision between computers. The Time Service provides each participating computer with access to time synchronized by PTP. </p>
<p>At the telescope site, the Global Positioning System (GPS) provides an absolute time base, and a PTP grand master clock (a hardware device) synchronized to the GPS broadcasts the PTP protocol. Each computer system participating in the PTP system is synchronized with GPS and each other using the PTP protocol. For higher accuracy in time measurements hardware time stamping is required, and those computers should be fitted with PTP capable Network Interface Cards (NIC).</p>
<p>In order to read the time with high precision, the Time Service relies on making native calls to the Linux kernel libraries, since Java 8 supports only millisecond precision. <a href="https://github.com/java-native-access/jna">Java Native Access (JNA)</a> is used internally in Time Service to make native calls that return the required precision. The implementation of Time Service Scheduler is based on the <a href="https://doc.akka.io/docs/akka/current/scheduler.html">Akka Scheduler</a>, which is designed for high-throughput tasks rather than long-term, cron-like scheduling of tasks.</p>
<!-- introduction to the service -->
<h2><a href="#dependencies" name="dependencies" class="anchor"><span class="anchor-link"></span></a>Dependencies</h2>
<p>The Time Service comes bundled with the Framework, no additional dependency needs to be added to your <code>build.sbt</code>  file if using it. To use the Time Service without using the framework, add this to your <code>build.sbt</code> file:</p>
<dl>
  <dt>sbt</dt>
  <dd>
  <pre class="prettyprint"><code class="language-scala">libraryDependencies += &quot;com.github.tmtsoftware.csw&quot; %% &quot;csw-time-client&quot; % &quot;0.1-SNAPSHOT&quot;
</code></pre></dd>
</dl>
<h2><a href="#time-service-api-flavors" name="time-service-api-flavors" class="anchor"><span class="anchor-link"></span></a>Time Service API Flavors</h2>
<p>There are total three APIs provided by the Time Service: </p>
<ul>
  <li><strong>TMTTime API</strong>: This API provides a way to get current UTC or TAI time.</li>
  <li><strong>TMTTimeHelper API</strong>: This API provides additional time zone related functionality on top of TMTTime.</li>
  <li><strong>Scheduler API</strong>: This API provides various methods to schedule future or periodic tasks.</li>
</ul>
<h3><a href="#tmttime-api" name="tmttime-api" class="anchor"><span class="anchor-link"></span></a>TMTTime API</h3>
<p>TMTTime represents an instantaneous point in time with nanosecond precision. It&rsquo;s a wrapper around Instant and provides additional information about the timescale of the instant. </p>
<p>TMTTime supports two timescales:</p>
<ul>
  <li>Coordinated Universal Time ( <a href="https://tmtsoftware.github.io/csw/0.1-SNAPSHOT/api/scala/csw/time/api/models/UTCTime.html">UTCTime</a> )</li>
  <li>International Atomic Time ( <a href="https://tmtsoftware.github.io/csw/0.1-SNAPSHOT/api/scala/csw/time/api/models/TAITime.html">TAITime</a> )</li>
</ul>
<h4><a href="#get-current-time" name="get-current-time" class="anchor"><span class="anchor-link"></span></a>Get Current Time</h4>
<p>Gets the current UTC/TAI time with nanosecond precision. </p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/scala/example/time/TMTTimeExamples.scala#L10-L14" target="_blank" title="Go to snippet source"></a><code class="language-scala">// get current UTC time
val utcTime: UTCTime = UTCTime.now()

// get current TAI time
val taiTime: TAITime = TAITime.now()</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/java/example/time/JTMTTimeExamples.java#L12-L16" target="_blank" title="Go to snippet source"></a><code class="language-java">// get current UTC time
private UTCTime utcTime = UTCTime.now();

// get current TAI time
private TAITime taiTime = TAITime.now();</code></pre></dd>
</dl>
<p>Note that time is returned a UTCTime or TAITime object so that it is possible to determine the time scale of the time value by inspection.</p>
<h4><a href="#converting-from-utc-to-tai-time-and-vice-versa" name="converting-from-utc-to-tai-time-and-vice-versa" class="anchor"><span class="anchor-link"></span></a>Converting from UTC to TAI Time and Vice-versa</h4>
<p>Each time object provides a way to convert to the other.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/scala/example/time/TMTTimeExamples.scala#L19-L23" target="_blank" title="Go to snippet source"></a><code class="language-scala">// UTC to TAI
val taiTime: TAITime = utcTime.toTAI

// TAI to UTC
val utcTime0: UTCTime = taiTime.toUTC</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/java/example/time/JTMTTimeExamples.java#L21-L25" target="_blank" title="Go to snippet source"></a><code class="language-java">// UTC to TAI
TAITime taiTime = utcTime.toTAI();

// TAI to UTC
UTCTime utcTime = taiTime.toUTC();</code></pre></dd>
</dl>
<h3><a href="#tmttimehelper-api" name="tmttimehelper-api" class="anchor"><span class="anchor-link"></span></a>TMTTimeHelper API</h3>
<p>This API provides additional time zone related functionality on top of TMTTime. It allows users to get a Java <em>ZonedDateTime</em> representation of a TMTTime.</p>
<h4><a href="#at-local-time-zone" name="at-local-time-zone" class="anchor"><span class="anchor-link"></span></a>At Local Time Zone</h4>
<p>Gets the given TMTTime at Local time zone. The local time zone is fetched from the calling system&rsquo;s default time zone.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/scala/example/time/TMTTimeExamples.scala#L28-L32" target="_blank" title="Go to snippet source"></a><code class="language-scala">// Get UTCTime at local timezone
val utcLocalTime: ZonedDateTime = TMTTimeHelper.atLocal(utcTime)

// Get TAITime at local timezone
val taiLocalTime: ZonedDateTime = TMTTimeHelper.atLocal(taiTime)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/java/example/time/JTMTTimeExamples.java#L30-L34" target="_blank" title="Go to snippet source"></a><code class="language-java">// Get UTCTime at local timezone
ZonedDateTime utcLocalTime = TMTTimeHelper.atLocal(utcTime);

// Get TAITime at local timezone
ZonedDateTime taiLocalTime = TMTTimeHelper.atLocal(taiTime);</code></pre></dd>
</dl>
<h4><a href="#at-hawaii-hst-timezone" name="at-hawaii-hst-timezone" class="anchor"><span class="anchor-link"></span></a>At Hawaii (HST) Timezone</h4>
<p>Gets the given TMTTime at Hawaii time zone.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/scala/example/time/TMTTimeExamples.scala#L36-L40" target="_blank" title="Go to snippet source"></a><code class="language-scala">// Get UTCTime at Hawaii (HST) timezone
val utcHawaiiTime: ZonedDateTime = TMTTimeHelper.atHawaii(utcTime)

// Get TAITime at Hawaii (HST) timezone
val taiHawaiiTime: ZonedDateTime = TMTTimeHelper.atHawaii(taiTime)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/java/example/time/JTMTTimeExamples.java#L38-L42" target="_blank" title="Go to snippet source"></a><code class="language-java">// Get UTCTime at Hawaii (HST) timezone
ZonedDateTime utcHawaiiTime = TMTTimeHelper.atHawaii(utcTime);

// Get TAITime at Hawaii (HST) timezone
ZonedDateTime taiHawaiiTime = TMTTimeHelper.atHawaii(taiTime);</code></pre></dd>
</dl>
<h4><a href="#at-custom-timezone" name="at-custom-timezone" class="anchor"><span class="anchor-link"></span></a>At Custom Timezone</h4>
<p>Gets the given TMTTime at the specified time zone.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/scala/example/time/TMTTimeExamples.scala#L44-L48" target="_blank" title="Go to snippet source"></a><code class="language-scala">// Get UTCTime at specified timezone
val utcKolkataTime: ZonedDateTime = TMTTimeHelper.atZone(utcTime, ZoneId.of(&quot;Asia/Kolkata&quot;))

// Get TAITime at specified timezone
val taiKolkataTime: ZonedDateTime = TMTTimeHelper.atZone(taiTime, ZoneId.of(&quot;Asia/Kolkata&quot;))</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/java/example/time/JTMTTimeExamples.java#L46-L50" target="_blank" title="Go to snippet source"></a><code class="language-java">// Get UTCTime at specified timezone
ZonedDateTime utcKolkataTime = TMTTimeHelper.atZone(utcTime, ZoneId.of(&quot;Asia/Kolkata&quot;));

// Get TAITime at specified timezone
ZonedDateTime taiKolkataTime = TMTTimeHelper.atZone(taiTime, ZoneId.of(&quot;Asia/Kolkata&quot;));</code></pre></dd>
</dl>
<h3><a href="#scheduler-api" name="scheduler-api" class="anchor"><span class="anchor-link"></span></a>Scheduler API</h3>
<p>This API provides various methods to schedule periodic or non-periodic, one-shot tasks in the future. </p>
<p>For component developers, the scheduler API is provided as a <a href="https://tmtsoftware.github.io/csw/0.1-SNAPSHOT/api/scala/csw/time/api/TimeServiceScheduler.html">TimeServiceScheduler</a> object in the <code>CswContext</code> object injected into the ComponentHandlers class provided by the framework. </p>
<p>If you are not using csw-framework, you can create <a href="https://tmtsoftware.github.io/csw/0.1-SNAPSHOT/api/scala/csw/time/api/TimeServiceScheduler.html">TimeServiceScheduler</a> using <a href="https://tmtsoftware.github.io/csw/0.1-SNAPSHOT/api/scala/csw/time/client/TimeServiceSchedulerFactory.html">TimeServiceSchedulerFactory</a> as follows.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/scala/example/time/SchedulerExamples.scala#L17-L18" target="_blank" title="Go to snippet source"></a><code class="language-scala">// create time service scheduler using the factory method
private val scheduler: TimeServiceScheduler = TimeServiceSchedulerFactory.make()(actorSystem)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/java/example/time/JSchedulerExamples.java#L26-L27" target="_blank" title="Go to snippet source"></a><code class="language-java">// create time service scheduler using the factory method
TimeServiceScheduler scheduler = TimeServiceSchedulerFactory.make(actorSystem);</code></pre></dd>
</dl>
<p>For all scheduler calls, an instance of <a href="https://tmtsoftware.github.io/csw/0.1-SNAPSHOT/api/scala/csw/time/client/api/Cancellable.html">Cancellable</a> is returned which can be used to cancel the execution of the future tasks.</p>
<h4><a href="#schedule-once" name="schedule-once" class="anchor"><span class="anchor-link"></span></a>Schedule Once</h4>
<p>Schedules a task to execute once at the given start time. The <code>startTime</code> is a TMTTime and can be either a UTCTime or TAITime.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/scala/example/time/SchedulerExamples.scala#L24-L26" target="_blank" title="Go to snippet source"></a><code class="language-scala">scheduler.scheduleOnce(utcTime) {
  // do something
}</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/java/example/time/JSchedulerExamples.java#L38-L39" target="_blank" title="Go to snippet source"></a><code class="language-java">Runnable task = () -&gt; {/* do something*/};
scheduler.scheduleOnce(utcTime, task);</code></pre></dd>
</dl><div class="callout note "><div class="callout-title">Warning</div>
<p>Note that callbacks are asynchronous and can be potentially executed in an unknown thread. Therefore, if there is a need to mutate state when the time expires, it is recommended to send a message to an Actor, and keep any mutable state within the actor where it can be managed safely. This is true for any CSW API with a callback. The schedule once with ActorRef can often be used in this scenario.</p></div>
<h4><a href="#schedule-once-with-actorref" name="schedule-once-with-actorref" class="anchor"><span class="anchor-link"></span></a>Schedule Once With ActorRef</h4>
<p>Schedules sending of the message to the provided <code>actorRef</code> at the given start time. The <code>startTime</code> can be either UTCTime or TAITime.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/scala/example/time/SchedulerExamples.scala#L30-L41" target="_blank" title="Go to snippet source"></a><code class="language-scala">class SchedulingHandler(ctx: ActorContext[UTCTime]) extends AbstractBehavior[UTCTime] {
  override def onMessage(msg: UTCTime): Behavior[UTCTime] = {
    // handle the message to execute the task on scheduled time
    Behaviors.same
  }
}

private val behavior: Behavior[UTCTime] = Behaviors.setup(ctx ⇒ new SchedulingHandler(ctx))
private val actorRef: ActorRef          = ctx.spawnAnonymous(behavior).toUntyped

scheduler.scheduleOnce(utcTime, actorRef, UTCTime.now())
</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/java/example/time/JSchedulerExamples.java#L44-L57" target="_blank" title="Go to snippet source"></a><code class="language-java">class SchedulingHandler extends AbstractBehavior&lt;UTCTime&gt; {
    @Override
    public Receive&lt;UTCTime&gt; createReceive() {
        // handle the message to execute the task on scheduled time
        return null;
    }
}

Cancellable schedule() {
    Behavior&lt;UTCTime&gt; behavior = Behaviors.setup(ctx -&gt; new SchedulingHandler());
    ActorRef actorRef = Adapter.toUntyped(ctx.asJava().spawnAnonymous(behavior));

    return scheduler.scheduleOnce(utcTime, actorRef, UTCTime.now());
}</code></pre></dd>
</dl>
<h4><a href="#schedule-periodically" name="schedule-periodically" class="anchor"><span class="anchor-link"></span></a>Schedule Periodically</h4>
<p>Schedules a task to execute periodically at the given interval. The first task is executed once immediately without any initial delay followed by periodic executions. In case you do not want to start scheduling immediately, you can use the overloaded method for <code>schedulePeriodically()</code> with <code>startTime</code> as shown in the next example.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/scala/example/time/SchedulerExamples.scala#L45" target="_blank" title="Go to snippet source"></a><code class="language-scala">scheduler.schedulePeriodically(Duration.ofMillis(50)) { /* do something*/ }</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/java/example/time/JSchedulerExamples.java#L63-L65" target="_blank" title="Go to snippet source"></a><code class="language-java">Runnable task = () -&gt; {/* do something*/};
scheduler.schedulePeriodically(Duration.ofMillis(50), task);</code></pre></dd>
</dl>
<h4><a href="#schedule-periodically-with-start-time" name="schedule-periodically-with-start-time" class="anchor"><span class="anchor-link"></span></a>Schedule Periodically with Start Time</h4>
<p>Schedules a task to execute periodically at the given interval. The task is executed once at the given start time followed by execution of task at each interval. The <code>startTime</code> can be either UTCTime or TAITime.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/scala/example/time/SchedulerExamples.scala#L49" target="_blank" title="Go to snippet source"></a><code class="language-scala">scheduler.schedulePeriodically(utcTime, Duration.ofMillis(50)) { /* do something*/ }</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><a class="icon go-to-source" href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/java/example/time/JSchedulerExamples.java#L63-L70" target="_blank" title="Go to snippet source"></a><code class="language-java">Runnable task = () -&gt; {/* do something*/};
scheduler.schedulePeriodically(utcTime, Duration.ofMillis(50), task);</code></pre></dd>
</dl>
<p>As with the schedule once API, there is also a periodic schedule API that takes a message and ActorRef.</p>
<h2><a href="#source-code-for-tmttime-examples" name="source-code-for-tmttime-examples" class="anchor"><span class="anchor-link"></span></a>Source code for TMTTime examples</h2>
<ul>
  <li><a href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/scala/example/time/TMTTimeExamples.scala">Scala Example</a></li>
  <li><a href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/java/example/time/JTMTTimeExamples.java">Java Example</a></li>
</ul>
<h2><a href="#source-code-for-scheduler-examples" name="source-code-for-scheduler-examples" class="anchor"><span class="anchor-link"></span></a>Source code for Scheduler examples</h2>
<ul>
  <li><a href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/scala/example/time/SchedulerExamples.scala">Scala Example</a></li>
  <li><a href="https://github.com/tmtsoftware/csw/tree/master/examples/src/main/java/example/time/JSchedulerExamples.java">Java Example</a></li>
</ul>
</div>
<div>
<a href="https://github.com/tmtsoftware/csw/tree/master/docs/src/main/services/time.md" title="Edit this page" class="md-source-file md-edit">
Edit this page
</a>
</div>
<div class="print-only">
<span class="md-source-file md-version">
0.1*
</span>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a href="../services/alarm.html" title="Alarm Service" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Previous
</span>
Alarm Service
</span>
</div>
</a>
<a href="../services/database.html" title="Database Service" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Next
</span>
Database Service
</span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
Powered by
<a href="https://github.com/lightbend/paradox">Paradox</a>
and
<a href="https://jonas.github.io/paradox-material-theme/">Paradox Material Theme</a>

</div>
</div>
</div>
</footer>

</div>
<script src="../assets/javascripts/application.583bbe55.js"></script>
<script src="../assets/javascripts/paradox-material-theme.js"></script>
<script>app.initialize({version:"0.17",url:{base:"../."}})</script>
<script type="text/javascript" src="../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
window.prettyPrint && prettyPrint();
});
</script>
</body>
</html>
