<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="description" content="docs">
<meta name="generator" content="Paradox, paradox-material-theme=0.7.0, mkdocs-material=3.0.3">

<meta name="lang:clipboard.copy" content="Copy to clipboard">
<meta name="lang:clipboard.copied" content="Copied to clipboard">
<meta name="lang:search.language" content="">
<meta name="lang:search.pipeline.stopwords" content="true">
<meta name="lang:search.pipeline.trimmer" content="true">
<meta name="lang:search.result.none" content="No matching documents">
<meta name="lang:search.result.one" content="1 matching document">
<meta name="lang:search.result.other" content="# matching documents">
<meta name="lang:search.tokenizer" content="[\s\-]+">


<meta name="description" content="docs">
<link rel="shortcut icon" href="../../assets/images/favicon.png">
<title>Prefix in CSW 2</title>
<link rel="stylesheet" href="../../assets/stylesheets/application.451f80e5.css">
<link rel="stylesheet" href="../../lib/material__tabs/dist/mdc.tabs.min.css">
<link rel="stylesheet" href="../../lib/prettify/prettify.css">
<script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
<style>
body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}
code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}
</style>
<link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
<link rel="stylesheet" href="../../assets/fonts/material-icons.css">
<link rel="stylesheet" href="../../assets/stylesheets/paradox-material-theme.css">
</head>
<body
>
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a href="../../migration_guide/migration_guide_1.0.0_to_2.0.0/prefix.html" title="Prefix in CSW 2" class="md-header-nav__button md-logo">
<i class="md-icon">local_library</i>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
Prefix in CSW 2
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
<label class="md-icon md-search__icon" for="__search"></label>
<button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix>
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
Type to start searching
</div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>

</div>
</div>
</nav>
</header>

<div class="md-container">
<main class="md-main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0" style="visibility: hidden">
<label class="md-nav__title md-nav__title--site" for="drawer">
<a href="../../migration_guide/migration_guide_1.0.0_to_2.0.0/prefix.html" title="Prefix in CSW 2" class="md-nav__button md-logo">
<span class="md-nav__button md-logo">
<i class="md-icon">local_library</i>
</a>
<a href="../../migration_guide/migration_guide_1.0.0_to_2.0.0/prefix.html" title="Prefix in CSW 2">
Prefix in CSW 2
</a>
</label>
<ul>
</ul>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="../../migration_guide/migration_guide_1.0.0_to_2.0.0/prefix.html#prefix-in-csw-2" class="header">Prefix in CSW 2</a>
  <ul>
    <li><a href="../../migration_guide/migration_guide_1.0.0_to_2.0.0/prefix.html#component-creation" class="header">Component Creation</a></li>
    <li><a href="../../migration_guide/migration_guide_1.0.0_to_2.0.0/prefix.html#location-service" class="header">Location Service</a></li>
    <li><a href="../../migration_guide/migration_guide_1.0.0_to_2.0.0/prefix.html#alarm-service" class="header">Alarm Service</a></li>
    <li><a href="../../migration_guide/migration_guide_1.0.0_to_2.0.0/prefix.html#logging-service" class="header">Logging Service</a></li>
  </ul></li>
</ul>
</nav>

</nav>
<ul style="display: none">
<li class="md-nav__item md-version" id="project.version">
<label class="md-nav__link" for="__version">
<i class="md-icon" title="Version">label_outline</i> 6.0.0-M3
</label>
</li>
</ul>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="../../migration_guide/migration_guide_1.0.0_to_2.0.0/prefix.html#prefix-in-csw-2" class="header">Prefix in CSW 2</a>
  <ul>
    <li><a href="../../migration_guide/migration_guide_1.0.0_to_2.0.0/prefix.html#component-creation" class="header">Component Creation</a></li>
    <li><a href="../../migration_guide/migration_guide_1.0.0_to_2.0.0/prefix.html#location-service" class="header">Location Service</a></li>
    <li><a href="../../migration_guide/migration_guide_1.0.0_to_2.0.0/prefix.html#alarm-service" class="header">Alarm Service</a></li>
    <li><a href="../../migration_guide/migration_guide_1.0.0_to_2.0.0/prefix.html#logging-service" class="header">Logging Service</a></li>
  </ul></li>
</ul>
</nav>

</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<div class="md-content__searchable">
<h1><a href="#prefix-in-csw-2" name="prefix-in-csw-2" class="anchor"><span class="anchor-link"></span></a>Prefix in CSW 2</h1>
<p>The use of prefixes has been made more consistent in CSW 2.0.0. Before this update, Prefix was a dot-separated String starting with a subsystem, where the component name was considered to be the last item. The Subsystem was extracted from the String on creation.</p>
<p>e.g IRIS.imager.filterWheelAssembly =&gt;  Subsystem: IRIS  Component Name: filterWheelAssembly</p>
<p>There was some confusion about what was the Prefix: the entire string (IRIS.imager.filterWheelAssembly), or everything except the component name (IRIS.imager)?</p>
<p>With CSW 2, we expect this to be less confusing. Prefix is the whole string and is made up of exactly two parts: the subsystem (explicitly as a Subsystem type) and a String component name, where everything after the subsystem is considered to be the component name.</p>
<p>e.g. IRIS.imager.filterWheelAssembly =&gt;  Subsystem: IRIS  Component Name: imager.filterWheelAssembly</p>
<p>Prefixes can be still be constructed using a String, but it must have a part at the beginning before the first dot that matches one of the valid TMT subsystems as specified in the <a href="https://github.com/tmtsoftware/csw/blob/v6.0.0-M3/csw-prefix/shared/src/main/scala/csw/prefix/models/Subsystem.scala">Subsystem.scala</a>.</p>
<p>This change will have the following effects on your code:</p>
<h2><a href="#component-creation" name="component-creation" class="anchor"><span class="anchor-link"></span></a>Component Creation</h2>
<p>ComponentInfo files now take a Prefix as a String instead of an ambiguous prefix and a component name. Similarly, Container configuration files also reference their components using Prefix instead of component name.</p>
<p>For example, in CSW 1:</p>
<pre class="prettyprint"><code class="language-hocon">name = &quot;SampleHcd&quot;
componentType = hcd
behaviorFactoryClassName = &quot;org.tmt.nfiraos.samplehcd.SampleHcdBehaviorFactory&quot;
prefix = &quot;nfiraos.samplehcd&quot;
locationServiceUsage = RegisterOnly
</code></pre>
<p>becomes in CSW 2:</p>
<pre class="prettyprint"><code class="language-hocon">prefix = &quot;nfiraos.samplehcd&quot;
componentType = hcd
behaviorFactoryClassName = &quot;org.tmt.nfiraos.samplehcd.SampleHcdBehaviorFactory&quot;
locationServiceUsage = RegisterOnly
</code></pre>
<h2><a href="#location-service" name="location-service" class="anchor"><span class="anchor-link"></span></a>Location Service</h2>
<p>A <code>ComponentId</code> is now constructed from a Prefix and <code>ComponentType</code> instead of a component name String and a <code>ComponentType</code>. This allows registration of components from different subsystems with the same component name. </p>
<p>For example, in CSW 1:</p>
<pre class="prettyprint"><code class="language-scala">val hcdConnection = PekkoConnection(ComponentId(&quot;hcd1&quot;), ComponentType.HCD)
</code></pre>
<p>becomes in CSW 2:</p>
<pre class="prettyprint"><code class="language-scala">val hcdConnection = PekkoConnection(ComponentId(Prefix(Subsystem.NFIRAOS, &quot;hcd1&quot;), ComponentType.HCD))
</code></pre>
<h2><a href="#alarm-service" name="alarm-service" class="anchor"><span class="anchor-link"></span></a>Alarm Service</h2>
<p>Alarms are defined in the Alarm Configuration file using a Prefix instead of a subsystem and component name.</p>
<p>For example, in CSW 1:</p>
<pre class="prettyprint"><code class="language-hocon">alarms: [
  {
    subsystem = nfiraos
    component = tromboneAssembly
    name = tromboneAxisLowLimitAlarm
    description = &quot;Warns when trombone axis has reached the low limit&quot;
    location = &quot;south side&quot;
    alarmType = Absolute
    supportedSeverities = [Warning, Major, Critical]
    probableCause = &quot;the trombone software has failed or the stage was driven into the low limit&quot;
    operatorResponse = &quot;go to the NFIRAOS engineering user interface and select the datum axis command&quot;
    isAutoAcknowledgeable = false
    isLatchable = true
    activationStatus = Active
  }
]
</code></pre>
<p>becomes in CSW 2:</p>
<pre class="prettyprint"><code class="language-hocon">alarms: [
  {
    prefix = nfiraos.tromboneAssembly
    name = tromboneAxisLowLimitAlarm
    description = &quot;Warns when trombone axis has reached the low limit&quot;
    location = &quot;south side&quot;
    alarmType = Absolute
    supportedSeverities = [Warning, Major, Critical]
    probableCause = &quot;the trombone software has failed or the stage was driven into the low limit&quot;
    operatorResponse = &quot;go to the NFIRAOS engineering user interface and select the datum axis command&quot;
    isAutoAcknowledgeable = false
    isLatchable = true
    activationStatus = Active
  }
]
</code></pre>
<p>AlarmKey also takes Prefix instead of a subsystem and a component name:</p>
<p>CSW 1:</p>
<pre class="prettyprint"><code class="language-scala">val alarmKey = AlarmKey(NFIRAOS, &quot;trombone&quot;, &quot;tromboneAxisLowLimitAlarm&quot;)
</code></pre>
<p>becomes in CSW 2:</p>
<pre class="prettyprint"><code class="language-scala">val alarmKey = AlarmKey(Prefix(NFIRAOS, &quot;trombone&quot;), &quot;tromboneAxisLowLimitAlarm&quot;)
</code></pre>
<h1><a href="#logging-service" name="logging-service" class="anchor"><span class="anchor-link"></span></a>Logging Service</h1>
<p>The construction of a Logging Service is typically done using a <code>LoggerFactory</code>. <code>LoggerFactory</code> now takes a Prefix instead of just a component name String. For components, this is done automatically for you in the framework. This has the additional effect that the Subsystem and Component Name are now added to the log messages.</p>
<p>For example, in CSW 1:</p>
<pre class="prettyprint"><code class="language-json">{&quot;@componentName&quot;:&quot;my-component-name&quot;,
 &quot;@host&quot;:&quot;INsaloni.local&quot;,
 &quot;@name&quot;:&quot;LocationServiceExampleClient&quot;,
 &quot;@severity&quot;:&quot;INFO&quot;,
 &quot;@version&quot;:&quot;0.1&quot;,
 &quot;actor&quot;: &quot;pekko://csw-examples-locationServiceClient@10.131.23.195:53618/user/$a&quot;,
 &quot;class&quot;:&quot;csw.location.LocationServiceExampleClient&quot;,
 &quot;file&quot;:&quot;LocationServiceExampleClientApp.scala&quot;,
 &quot;line&quot;:149,
 &quot;message&quot;:&quot;Result of the find call: None&quot;,
 &quot;timestamp&quot;:&quot;2017-11-30T10:58:03.102Z&quot; }
</code></pre>
<p>becomes in CSW 2:</p>
<pre class="prettyprint"><code class="language-json">{&quot;@prefix&quot;:&quot;CSW.my-component-name&quot;,
 &quot;@subsystem&quot;:&quot;CSW&quot;,
 &quot;@componentName&quot;:&quot;my-component-name&quot;,
 &quot;@host&quot;:&quot;INsaloni.local&quot;,
 &quot;@name&quot;:&quot;LocationServiceExampleClient&quot;,
 &quot;@severity&quot;:&quot;INFO&quot;,
 &quot;@version&quot;:&quot;0.1&quot;,
 &quot;actor&quot;:
   &quot;pekko://csw-examples-locationServiceClient@10.131.23.195:53618/user/$a&quot;,
 &quot;class&quot;:&quot;csw.location.LocationServiceExampleClient&quot;,
 &quot;file&quot;:&quot;LocationServiceExampleClientApp.scala&quot;,
 &quot;line&quot;:149,
 &quot;message&quot;:&quot;Result of the find call: None&quot;,
 &quot;timestamp&quot;:&quot;2017-11-30T10:58:03.102Z&quot;
 }
</code></pre>
<p>Also, configuring default log levels in application configuration files must be specified using the entire Prefix.</p>
<p>CSW 1:</p>
<pre class="prettyprint"><code class="language-hocon">component-log-levels {
    trombonehcd = debug
    tromboneassembly = error
  }
</code></pre>
<p>becomes in CSW 2:</p>
<pre class="prettyprint"><code class="language-hocon">component-log-levels {
    TCS.trombonehcd = debug
    TCS.tromboneassembly = error
  }
</code></pre>
<p>or alternatively:</p>
<pre class="prettyprint"><code class="language-hocon">component-log-levels {
    TCS {
        trombonehcd = debug
        tromboneassembly = error
    }
  }
</code></pre>
<p>In addition, the Prefix and Subsystem classes have been moved from csw.params.core.models to csw.prefix.models, so imports will have be updated.</p>
</div>
<div>
<a href="https://github.com/tmtsoftware/csw/tree/master/docs/src/main/migration_guide/migration_guide_1.0.0_to_2.0.0/prefix.md" title="Edit this page" class="md-source-file md-edit">
Edit this page
</a>
</div>
<div class="print-only">
<span class="md-source-file md-version">
6.0.0-M3
</span>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
Powered by
<a href="https://github.com/lightbend/paradox">Paradox</a>
and
<a href="https://jonas.github.io/paradox-material-theme/">Paradox Material Theme</a>

</div>
</div>
</div>
</footer>

</div>
<script src="../../assets/javascripts/application.583bbe55.js"></script>
<script src="../../assets/javascripts/paradox-material-theme.js"></script>
<script>app.initialize({version:"0.17",url:{base:"../../."}})</script>
<script type="text/javascript" src="../../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
window.prettyPrint && prettyPrint();
});
</script>
</body>
</html>
