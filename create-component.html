<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="description" content="docs">
<meta name="generator" content="Paradox, paradox-material-theme, mkdocs-material=1.11.0">

<meta name="lang:clipboard.copy" content="Copy to clipboard">
<meta name="lang:clipboard.copied" content="Copied to clipboard">
<meta name="lang:search.result.none" content="No matching documents">
<meta name="lang:search.result.one" content="1 matching document">
<meta name="lang:search.result.other" content="# matching documents">
<meta name="lang:search.languages" content="">
<meta name="lang:search.tokenizer" content="[\s\-]+">


<meta name="description" content="docs">
<link rel="shortcut icon" href="assets/images/favicon.png">
<title>Creating a Component Â· TMT Common Software (CSW)</title>
<script src="lib/modernizr/modernizr.min.js"></script>
<link rel="stylesheet" href="assets/stylesheets/application-0741cbeb94.css">
<link rel="stylesheet" href="lib/material__tabs/dist/mdc.tabs.min.css">
<link rel="stylesheet" href="lib/prettify/prettify.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
<style>
body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}
code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}
</style>
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="assets/stylesheets/paradox-material-theme.css">
</head>
<body
data-md-color-primary="indigo"
data-md-color-accent="indigo">
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
<label class="md-overlay" data-md-component="overlay" for="drawer"></label>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a href="index.html" title="TMT Common Software (CSW)" class="md-header-nav__button md-logo">
<i class="md-icon md-icon--home"></i>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<span class="md-flex__ellipsis md-header-nav__title">
Creating a Component
</span>
</div>
<form name="search" style="display: none">
<input type="text" name="query">
</form>
</div>
</nav>
</header>

<div class="md-container">
<main class="md-main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0" style="visibility: hidden">
<label class="md-nav__title md-nav__title--site" for="drawer">
<div class="md-nav__button md-logo">
<i class="md-icon md-icon--home"></i>
</div>
<a href="index.html" title="TMT Common Software (CSW)">
TMT Common Software (CSW)
</a>
</label>
<ul>
  <li><a href="csw-overview.html" class="page">Using CSW</a></li>
  <li><a href="getting-started.html" class="page">Getting Started</a></li>
  <li><a href="create-component.html" class="active page">Creating a Component</a></li>
  <li><a href="multiple-components.html" class="page">Multiple Components</a></li>
  <li><a href="messages.html" class="page">Messages</a>
  <ul>
    <li><a href="messages/keys-parameters.html" class="page">Keys and Parameters</a></li>
    <li><a href="messages/units.html" class="page">Units</a></li>
    <li><a href="messages/subsystem.html" class="page">Subsystem</a></li>
    <li><a href="messages/commands.html" class="page">Commands</a></li>
    <li><a href="messages/events.html" class="page">Events</a></li>
    <li><a href="messages/states.html" class="page">State variables</a></li>
    <li><a href="messages/result.html" class="page">Result</a></li>
  </ul></li>
  <li><a href="framework.html" class="page">Framework for creating components (HCD, Assembly, Container)</a>
  <ul>
    <li><a href="framework/describing-components.html" class="page">ComponentInfo</a></li>
    <li><a href="framework/creating-components.html" class="page">Creating an Assembly or Hcd Component</a></li>
    <li><a href="framework/handling-lifecycle.html" class="page">Lifecycle support</a></li>
    <li><a href="framework/managing-command-state.html" class="page">Managing Command State</a></li>
    <li><a href="framework/tracking-connections.html" class="page">Tracking Connections</a></li>
    <li><a href="framework/publishing-state.html" class="page">Publishing State</a></li>
    <li><a href="framework/handling-exceptions.html" class="page">Handling Exceptions</a></li>
    <li><a href="framework/deploying-components.html" class="page">Deploying Components</a></li>
  </ul></li>
  <li><a href="services.html" class="page">Services</a>
  <ul>
    <li><a href="services/location.html" class="page">Location service</a></li>
    <li><a href="services/config.html" class="page">Configuration service</a></li>
    <li><a href="services/logging.html" class="page">Logging service</a></li>
  </ul></li>
  <li><a href="command.html" class="page">Communication using Commands</a></li>
  <li><a href="creating-tests.html" class="page">Creating Tests</a></li>
  <li><a href="apps.html" class="page">Applications</a>
  <ul>
    <li><a href="apps/cswclusterseed.html" class="page">csw-cluster-seed</a></li>
    <li><a href="apps/cswlocationagent.html" class="page">csw-location-agent</a></li>
    <li><a href="apps/cswonfigserverapp.html" class="page">csw-config-server</a></li>
    <li><a href="apps/cswconfigclientcli.html" class="page">csw-config-client-cli</a></li>
    <li><a href="apps/hostconfig.html" class="page">csw-host-config</a></li>
  </ul></li>
  <li><a href="manuals.html" class="page">Manuals</a></li>
</ul>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="toc">Table of contents</label>
<ul>
  <li><a href="create-component.html#creating-a-component" class="header">Creating a Component</a>
  <ul>
    <li><a href="create-component.html#anatomy-of-component" class="header">Anatomy of Component</a></li>
    <li><a href="create-component.html#constructing-the-component" class="header">Constructing the Component</a></li>
    <li><a href="create-component.html#lifecycle" class="header">Lifecycle</a></li>
    <li><a href="create-component.html#logging" class="header">Logging</a></li>
    <li><a href="create-component.html#receiving-commands" class="header">Receiving Commands</a></li>
    <li><a href="create-component.html#building-staging-publishlocal" class="header">Building, Staging, PublishLocal</a></li>
    <li><a href="create-component.html#running-component-standalone-mode-" class="header">Running Component (Standalone mode)</a></li>
  </ul></li>
</ul>
</nav>

<div class="md-nav__title--site md-version" title="Version">
<i class="md-icon">label_outline</i> 0.1*
</div>
</nav>

</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="toc">Table of contents</label>
<ul>
  <li><a href="create-component.html#creating-a-component" class="header">Creating a Component</a>
  <ul>
    <li><a href="create-component.html#anatomy-of-component" class="header">Anatomy of Component</a></li>
    <li><a href="create-component.html#constructing-the-component" class="header">Constructing the Component</a></li>
    <li><a href="create-component.html#lifecycle" class="header">Lifecycle</a></li>
    <li><a href="create-component.html#logging" class="header">Logging</a></li>
    <li><a href="create-component.html#receiving-commands" class="header">Receiving Commands</a></li>
    <li><a href="create-component.html#building-staging-publishlocal" class="header">Building, Staging, PublishLocal</a></li>
    <li><a href="create-component.html#running-component-standalone-mode-" class="header">Running Component (Standalone mode)</a></li>
  </ul></li>
</ul>
</nav>

</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<div class="md-content__searchable">
<h1><a href="#creating-a-component" name="creating-a-component" class="anchor"><span class="anchor-link"></span></a>Creating a Component</h1>
<p>TODO This page should at least mention all of the features of CSW a developer might want to use, but only give details on the most commonly used. Links/references should be provided for the other features.</p>
<p>This gives a walkthrough of creating an HCD. </p>
<p>This tutorial helps in creating a HCD in Scala/Java. In order to create a HCD one needs to depend on <code>csw-framework</code> which can be referred <a href="https://tmtsoftware.github.io/csw-prod/framework.html">here</a>. This tutorial can be referred for creating an Assembly as well.</p>
<h2><a href="#anatomy-of-component" name="anatomy-of-component" class="anchor"><span class="anchor-link"></span></a>Anatomy of Component</h2>
<p>A component consists of a supervisor actor, a top level actor, a component handler and one or more worker actors. From all these, <code>csw-framework</code> provides supervisor actor, a top level actor and abstract class of handlers. Component developers are expected to implement this handler which also acts as a gateway from framework to component code. </p>
<h3><a href="#supervisor" name="supervisor" class="anchor"><span class="anchor-link"></span></a>Supervisor</h3>
<p>A Supervisor actor is the actor first started for any component. Two main responsibilities that supervisor performs is as follows:</p>
<ul>
  <li>Spawn a top level actor for the component and start watching it</li>
  <li>Register itself with location service</li>
</ul><div class="callout note "><div class="callout-title">Note</div>
<p>Supervisor registers itself with location service. That means supervisor acts as a gateway for external component/entity to talk to this component.</p></div>
<p>The source code of supervisor actor can be referred <a href="https://github.com/tmtsoftware/csw-prod/blob/master/csw-framework/src/main/scala/csw/framework/internal/supervisor/SupervisorBehavior.scala">here</a></p>
<h3><a href="#top-level-actor" name="top-level-actor" class="anchor"><span class="anchor-link"></span></a>Top level actor</h3>
<p>A top level actor is started by supervisor actor for any component. It takes a handler implementation (an instance of ComponentHandlers) as constructor parameter. The handler implementation would be written by component developer.</p>
<p>Whenever a message is received by top level actor, it calls an appropriate method of handlers which we refer as hooks in further explanation. For e.g. if top level actor receives <code>Initialize</code> message it will call <code>initialize()</code> hook of handlers.</p>
<p>The source code of top level actor can be referred <a href="https://github.com/tmtsoftware/csw-prod/blob/master/csw-framework/src/main/scala/csw/framework/internal/component/ComponentBehavior.scala">here</a>.</p>
<h3><a href="#handlers" name="handlers" class="anchor"><span class="anchor-link"></span></a>Handlers</h3>
<p>A <code>ComponentHandlers</code> is an abstract class provided by <code>csw-framework</code>. It provides a list of methods that a component developer should implement:</p>
<ul>
  <li>initialize</li>
  <li>validateCommand</li>
  <li>onSubmit</li>
  <li>onOneway</li>
  <li>onGoOffline</li>
  <li>onGoOnline</li>
  <li>onLocationTrackingEvent</li>
  <li>trackConnection</li>
  <li>onShutdown</li>
</ul>
<p>The source code of <code>ComponentHandlers</code> can be referred <a href="https://github.com/tmtsoftware/csw-prod/blob/master/csw-framework/src/main/scala/csw/framework/scaladsl/ComponentHandlers.scala">here</a>. </p>
<p>More details about handler significance and invocation can be referred <a href="https://tmtsoftware.github.io/csw-prod/framework/handling-lifecycle.html">here</a></p><div class="callout note "><div class="callout-title">Note</div>
<p>If the component developer wishes to write the handler implementation as java code, then he/she needs to implement the java version of <code>ComponentHandlers</code> which is <code>JComponentHandlers</code>. The source code of <code>JComponentHandlers</code> can be referred <a href="https://github.com/tmtsoftware/csw-prod/blob/master/csw-framework/src/main/scala/csw/framework/javadsl/JComponentHandlers.scala">here</a>. </p></div>
<h2><a href="#constructing-the-component" name="constructing-the-component" class="anchor"><span class="anchor-link"></span></a>Constructing the Component</h2>
<p>After writing the handlers, component developer needs to wire them up with framework. In order to do this, developer needs to implement a <code>ComponentBehaviorFactory</code>. This factory should to be configured in configuration file for the component. The sample of configuration file is discussed next. The <code>csw-framework</code> then picks up the full path of <code>ComponentBehaviorFactory</code> from configuration file and spawn the component handlers using this factory as a process of booting a component. The factory is instantiated using java reflection.</p>
<p>The sample code to implement the <code>ComponentBehaviorFactory</code> can be referred <a href="https://tmtsoftware.github.io/csw-prod/framework/creating-components.html">here</a> </p>
<h3><a href="#component-configuration-componentinfo-" name="component-configuration-componentinfo-" class="anchor"><span class="anchor-link"></span></a>Component Configuration (ComponentInfo)</h3>
<p>Component configuration contains details needed to spawn a component. This configuration resides in a configuration file for a particular component. The sample for a HCD is as follows:</p>
<pre><code>{
    name = &quot;Motion_Controller&quot;
    componentType = hcd
    behaviorFactoryClassName = tcs.hcd.SampleComponentBehaviorFactory
    prefix = tcs.mobie.blue.filter
    locationServiceUsage = RegisterOnly
}
</code></pre><div class="callout note "><div class="callout-title">Note</div>
<p><code>behaviorFactoryClassName</code> refers to class name of the concrete implementation of <code>ComponentBehaviorFactory</code>, which is <code>SampleComponentBehaviorFactory</code> in above sample.</p></div>
<p>The <code>name</code> and <code>componentType</code> is used to create the <code>ComponentId</code> representing a unique component in location service.</p>
<p>The <code>locationServiceUsage</code> is referred by supervisor actor to decide whether to only register a component with location service or register and track other components.</p>
<p>The configuration file is parsed to <code>ComponentInfo</code> and injected in supervisor actor. It is then injected in <code>ComponentHandlers</code> while spawning a component.</p>
<p>More details about <code>ComponentInfo</code> can be referred <a href="https://tmtsoftware.github.io/csw-prod/framework/describing-components.html">here</a>.</p>
<p>A sample configuration file can be referred <a href="https://github.com/tmtsoftware/csw-prod/blob/master/csw-benchmark/src/main/resources/container.conf">here</a>.</p>
<h2><a href="#lifecycle" name="lifecycle" class="anchor"><span class="anchor-link"></span></a>Lifecycle</h2>
<p>Describe lifecycle states, transitions, etc. - Registration in Location Service (other Location Service details are in the next part) - Loading a Configuration from Config Service (Again, details are in next part)</p>
<h2><a href="#logging" name="logging" class="anchor"><span class="anchor-link"></span></a>Logging</h2>
<h2><a href="#receiving-commands" name="receiving-commands" class="anchor"><span class="anchor-link"></span></a>Receiving Commands</h2>
<h3><a href="#command-types-and-implementing-handler-stubs" name="command-types-and-implementing-handler-stubs" class="anchor"><span class="anchor-link"></span></a>Command types, and Implementing Handler stubs</h3>
<h3><a href="#validation" name="validation" class="anchor"><span class="anchor-link"></span></a>Validation</h3>
<h3><a href="#csrm" name="csrm" class="anchor"><span class="anchor-link"></span></a>CSRM</h3>
<h2><a href="#building-staging-publishlocal" name="building-staging-publishlocal" class="anchor"><span class="anchor-link"></span></a>Building, Staging, PublishLocal</h2>
<p>Just for this in Standlone mode, but link to reference</p>
<h2><a href="#running-component-standalone-mode-" name="running-component-standalone-mode-" class="anchor"><span class="anchor-link"></span></a>Running Component (Standalone mode)</h2>
</div>
<div>
<a href="https://github.com/tmtsoftware/csw-prod/tree/master/docs/src/main/create-component.md" title="Edit this page" class="md-source-file md-edit">
Edit this page
</a>
</div>
<div class="print-only">
<span class="md-source-file md-version">
0.1*
</span>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a href="getting-started.html" title="Getting Started" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Previous
</span>
Getting Started
</span>
</div>
</a>
<a href="multiple-components.html" title="Multiple Components" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Next
</span>
Multiple Components
</span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
Powered by
<a href="https://github.com/lightbend/paradox" title="Paradox">Paradox</a>
and
<a href="https://jonas.github.io/paradox-material-theme/" title="Paradox Material Theme">Paradox Material Theme</a>

</div>
<div class="md-footer-social">
</div>

</div>
</div>
</footer>

</div>
<script src="assets/javascripts/application-268d62d82d.js"></script>
<script src="assets/javascripts/paradox-material-theme.js"></script>
<script>app.initialize({url:{base:"./"}})</script>
<script type="text/javascript" src="lib/prettify/prettify.js"></script>
<script type="text/javascript" src="lib/prettify/lang-scala.js"></script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
window.prettyPrint && prettyPrint();
});
</script>
</body>
</html>
