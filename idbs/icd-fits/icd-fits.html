<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="description" content="docs">
<meta name="generator" content="Paradox, paradox-material-theme=0.7.0, mkdocs-material=3.0.3">

<meta name="lang:clipboard.copy" content="Copy to clipboard">
<meta name="lang:clipboard.copied" content="Copied to clipboard">
<meta name="lang:search.language" content="">
<meta name="lang:search.pipeline.stopwords" content="true">
<meta name="lang:search.pipeline.trimmer" content="true">
<meta name="lang:search.result.none" content="No matching documents">
<meta name="lang:search.result.one" content="1 matching document">
<meta name="lang:search.result.other" content="# matching documents">
<meta name="lang:search.tokenizer" content="[\s\-]+">


<meta name="description" content="docs">
<link rel="shortcut icon" href="../assets/images/favicon.png">
<title>Using the icd-fits command line app Â· Interface Database System (IDBS)</title>
<link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
<link rel="stylesheet" href="../lib/material__tabs/dist/mdc.tabs.min.css">
<link rel="stylesheet" href="../lib/prettify/prettify.css">
<script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
<style>
body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}
code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}
</style>
<link rel="stylesheet" href="../assets/fonts/font-awesome.css">
<link rel="stylesheet" href="../assets/fonts/material-icons.css">
<link rel="stylesheet" href="../assets/stylesheets/paradox-material-theme.css">
</head>
<body
>
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a href="../index.html" title="Interface Database System (IDBS)" class="md-header-nav__button md-logo">
<i class="md-icon">local_library</i>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
Interface Database System (IDBS)
</span>
<span class="md-header-nav__topic">
Using the icd-fits command line app
</span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
<label class="md-icon md-search__icon" for="__search"></label>
<button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix>
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
Type to start searching
</div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>

</div>
</div>
</nav>
</header>

<div class="md-container">
<main class="md-main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0" style="visibility: hidden">
<label class="md-nav__title md-nav__title--site" for="drawer">
<a href="../index.html" title="Interface Database System (IDBS)" class="md-nav__button md-logo">
<span class="md-nav__button md-logo">
<i class="md-icon">local_library</i>
</a>
<a href="../index.html" title="Interface Database System (IDBS)">
Interface Database System (IDBS)
</a>
</label>
<ul>
  <li><a href="../idbs/introduction.html" class="page">Introduction</a></li>
  <li><a href="../idbs/overview.html" class="page">Overview</a></li>
  <li><a href="../workflow/workflow.html" class="page">IDBS Workflow and Creating ICDs</a></li>
  <li><a href="../installing/installing.html" class="page">Installing IDBS</a></li>
  <li><a href="../modelFiles/modelFiles.html" class="page">Model Files</a></li>
  <li><a href="../icd-db/icd-db.html" class="page">Using the icd-db command line app</a></li>
  <li><a href="../icd-fits/icd-fits.html" class="active page">Using the icd-fits command line app</a></li>
  <li><a href="../webapp/webapp.html" class="page">Using the Web Interface</a></li>
</ul>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="../icd-fits/icd-fits.html#using-the-icd-fits-command-line-app" class="header">Using the icd-fits command line app</a>
  <ul>
    <li><a href="../icd-fits/icd-fits.html#fits-keywords" class="header">FITS Keywords</a></li>
    <li><a href="../icd-fits/icd-fits.html#generating-a-document-listing-the-fits-keywords" class="header">Generating a Document listing the FITS Keywords</a></li>
  </ul></li>
</ul>
</nav>

</nav>
<ul style="display: none">
<li class="md-nav__item md-version" id="project.version">
<label class="md-nav__link" for="__version">
<i class="md-icon" title="Version">label_outline</i> 3.1.0
</label>
</li>
</ul>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="../icd-fits/icd-fits.html#using-the-icd-fits-command-line-app" class="header">Using the icd-fits command line app</a>
  <ul>
    <li><a href="../icd-fits/icd-fits.html#fits-keywords" class="header">FITS Keywords</a></li>
    <li><a href="../icd-fits/icd-fits.html#generating-a-document-listing-the-fits-keywords" class="header">Generating a Document listing the FITS Keywords</a></li>
  </ul></li>
</ul>
</nav>

</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<div class="md-content__searchable">
<h1><a href="#using-the-icd-fits-command-line-app" name="using-the-icd-fits-command-line-app" class="anchor"><span class="anchor-link"></span></a>Using the icd-fits command line app</h1>
<p>The <code>icd-fits</code> command line application can be used to view and update the FITS Dictionary and related files or to generate a PDF or other type of file displaying the FITS keywords for a given subsystem or component.</p>
<p>In normal operations, the FITS Dictionary is loaded automatically from the published <code>DMS-Model-Files</code> GitHub repository. At the time of writing this has not yet been published.</p>
<p>Below are the available options for the <code>icd-fits</code> program, which you can list with the <code>icd-fits --help</code> option:</p>
<pre><code>icd-fits 3.0.0
Usage: icd-fits [options]

  -d, --db &lt;name&gt;          The name of the database to use (for the --ingest option, default: icds4)
  --host &lt;hostname&gt;        The host name where the database is running (for the --ingest option, default: localhost)
  --port &lt;number&gt;          The port number to use for the database (for the --ingest option, default: 27017)
  -c, --component &lt;name&gt;   Specifies the component to be used by any following options (subsystem must also be specified)
  -s, --subsystem &lt;subsystem&gt;[:version]
                           Specifies the subsystem (and optional version) to be used by any following options
  -t, --tag &lt;tag&gt;          Filters the list of FITS keywords to those with the given tag
  -l, --list               Prints the list of known FITS keywords
  --validate &lt;file&gt;        Validates a JSON formatted file containing the FITS Keyword dictionary and prints out any errors
  -g, --generate &lt;file&gt;    Generates an updated FITS dictionary JSON file by merging the one currently in the
                        icd database with the FITS keyword information defined for event parameters in the
 				    publish model files. If a subsystem is specified (with optional version), the
 				    merging is limited to that subsystem.
  -i, --ingest &lt;file&gt;      Ingest a JSON formatted file containing a FITS Keyword dictionary into the icd database
  --ingestTags &lt;file&gt;      Ingest a JSON or HOCON formatted file defining tags for the FITS dictionary into the icd database
  --ingestChannels &lt;file&gt;  Ingest a JSON or HOCON formatted file defining the available FITS channels for each subsystem into the icd database
  -o, --out &lt;outputFile&gt;   Generates a document containing a table of FITS keyword information in a format 
			   based on the file&#39;s suffix (html, pdf, json, csv, conf (HOCON))
  --orientation [portrait|landscape]
                           For PDF output: The page orientation (default: landscape)
  --fontSize &lt;size&gt;        For PDF or HTML file output: The base font size in px for body text (default: 10)
  --lineHeight &lt;height&gt;    For PDF or HTML file output: The line height (default: 1.6)
  --paperSize [Letter|Legal|A4|A3]
                           For PDF output: The paper size (default: Letter)
  --help
  --version
 --version
</code></pre>
<h2><a href="#fits-keywords" name="fits-keywords" class="anchor"><span class="anchor-link"></span></a>FITS Keywords</h2>
<p>The generated subsystem APIs contain infomation about FITS keywords whose values come from event parameters. That is, an event&rsquo;s parameter value is the source of the FITS keyword&rsquo;s value.</p>
<p>FITS keyword data is stored in three files under <a href="https://github.com/tmt-icd/DMS-Model-Files/tree/master/FITS-Dictionary">DMS-Model-Files</a> on GitHub. Once DMS is published, the file should be automatically loaded by the <code>icdwebserver</code> or <code>icd-git --ingest</code> commands. Until then, the FITS keywords, channels and tags can be manually loaded into the icd database once by running (from the icd source directory):</p>
<pre><code>icd-fits -i examples/3.0/FITS-Dictionary.json --ingestChannels examples/3.0/FITS-Channels.conf --ingestTags examples/3.0/FITS-Tags.conf
</code></pre>
<p>Alternatively you can check out and manually ingest DMS-Model-Files into the local icd database by using the Upload feature in the icd web app or with the command line:</p>
<pre><code>icd-db -i DMS-Model-Files
</code></pre>
<p>The contents of the files are as follows: * * <code>FITS-Dictionary.json</code> - This is the FITS dictionary and contains an entry for each FITS keyword, mapping it to source event parameters. If a keyword has multiple sources, named channels are used, each containing one source. * <code>FITS-Channels.conf</code> - This defines which channels are available for each subsystem (Channels are used when a FITS keyword has multiple source event parameters). * <code>FITS-Tags.conf</code> - Assigns tags to FITS keywords, which can be used in the web app to filter and display the FITS keyword information.</p>
<p>Besides the three above files, FITS keyword information can be defined in the <code>publish-model.conf</code> files for each subsystem component. Event parameters can define the associated keyword as follows:</p>
<pre><code>keyword = IMGDISWV
</code></pre>
<p>If the keyword has multiple source parameters, you can specify the channel:</p>
<pre><code>keyword = IMGDISWV
channel = ATM
</code></pre>
<p>In some more complicated cases, you can also specify multiple keywords whose values are taken from an index (or rowIndex for matrix/2d arrays) in the parameter&rsquo;s array values:</p>
<pre><code>keywords: [
     {
       keyword = OIWFS1PS
       rowIndex = 0
     }
     {
       keyword = OIWFS2PS
       rowIndex = 1
     }
     {
       keyword = OIWFS3PS
       rowIndex = 2
     }
]
</code></pre>
<p>The FITS keyword definitions in a subsystem&rsquo;s model files can be used to generate a new FITS dictionary by merging the existing FITS dictionary with the definitions in the publish model files. In this case the information from the published events overrides the information in the existing FITS dictionary:</p>
<pre><code>icd-fits --subsystem IRIS --generate FITS-Dictionary.json
</code></pre>
<p>Or using the short form options and with a subsystem version:</p>
<pre><code>icd-fits -s IRIS:1.7 -g FITS-Dictionary.json
</code></pre>
<p>The generated FITS dictionary JSON file can then be copied to the <a href="https://github.com/tmt-icd/DMS-Model-Files/tree/master/FITS-Dictionary">DMS-Model-Files</a> repository and published, so that it will be automatically used by the icd web app and command line apps (Note that Publishing DMS-Model-files requires special permission).</p>
<p>You can also manually load the new FITS dictionary into your local icd database using the command line:</p>
<pre><code>icd-fits -i FITS-Dictionary.json
</code></pre>
<h2><a href="#generating-a-document-listing-the-fits-keywords" name="generating-a-document-listing-the-fits-keywords" class="anchor"><span class="anchor-link"></span></a>Generating a Document listing the FITS Keywords</h2>
<p>You can use <code>icd-fits</code> to print a list of keywords coming from a subsystem or component to stdout. For example, the following command lists the keywords for IRIS:</p>
<pre><code>icd-fits --subsystem IRIS --list
</code></pre>
<p>Or you can use the short form options and restrict the output to a component:</p>
<pre><code>icd-fits -s IRIS -c pupilview -l
</code></pre>
<p>You can create a PDF of the IRIS FITS keywords like this:</p>
<pre><code>icd-fits -s IRIS -o IRIS-Keywords.pdf
</code></pre>
<p>The format of the output file depends on the suffix. You can also generate <code>csv</code>, <code>html</code>, <code>json</code> and <code>conf</code> (HCON) formatted files with the same information.</p>
</div>
<div>
<a href="https://github.com/tmtsoftware/icd/tree/master/docs/src/main/icd-fits/icd-fits.md" title="Edit this page" class="md-source-file md-edit">
Edit this page
</a>
</div>
<div class="print-only">
<span class="md-source-file md-version">
3.1.0
</span>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a href="../icd-db/icd-db.html" title="Using the icd-db command line app" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Previous
</span>
Using the icd-db command line app
</span>
</div>
</a>
<a href="../webapp/webapp.html" title="Using the Web Interface" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Next
</span>
Using the Web Interface
</span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
Powered by
<a href="https://github.com/lightbend/paradox">Paradox</a>
and
<a href="https://jonas.github.io/paradox-material-theme/">Paradox Material Theme</a>

</div>
</div>
</div>
</footer>

</div>
<script src="../assets/javascripts/application.583bbe55.js"></script>
<script src="../assets/javascripts/paradox-material-theme.js"></script>
<script>app.initialize({version:"0.17",url:{base:"../."}})</script>
<script type="text/javascript" src="../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
window.prettyPrint && prettyPrint();
});
</script>
</body>
</html>
