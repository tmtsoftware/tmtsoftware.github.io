<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="description" content="docs">
<meta name="generator" content="Paradox, paradox-material-theme=0.7.0, mkdocs-material=3.0.3">

<meta name="lang:clipboard.copy" content="Copy to clipboard">
<meta name="lang:clipboard.copied" content="Copied to clipboard">
<meta name="lang:search.language" content="">
<meta name="lang:search.pipeline.stopwords" content="true">
<meta name="lang:search.pipeline.trimmer" content="true">
<meta name="lang:search.result.none" content="No matching documents">
<meta name="lang:search.result.one" content="1 matching document">
<meta name="lang:search.result.other" content="# matching documents">
<meta name="lang:search.tokenizer" content="[\s\-]+">


<meta name="description" content="docs">
<link rel="shortcut icon" href="../assets/images/favicon.png">
<title>Using the icd-db command line app · Interface Database System (IDBS)</title>
<link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
<link rel="stylesheet" href="../lib/material__tabs/dist/mdc.tabs.min.css">
<link rel="stylesheet" href="../lib/prettify/prettify.css">
<script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
<style>
body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}
code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}
</style>
<link rel="stylesheet" href="../assets/fonts/font-awesome.css">
<link rel="stylesheet" href="../assets/fonts/material-icons.css">
<link rel="stylesheet" href="../assets/stylesheets/paradox-material-theme.css">
</head>
<body
>
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a href="../index.html" title="Interface Database System (IDBS)" class="md-header-nav__button md-logo">
<i class="md-icon">local_library</i>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
Interface Database System (IDBS)
</span>
<span class="md-header-nav__topic">
Using the icd-db command line app
</span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
<label class="md-icon md-search__icon" for="__search"></label>
<button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix>
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
Type to start searching
</div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>

</div>
</div>
</nav>
</header>

<div class="md-container">
<main class="md-main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0" style="visibility: hidden">
<label class="md-nav__title md-nav__title--site" for="drawer">
<a href="../index.html" title="Interface Database System (IDBS)" class="md-nav__button md-logo">
<span class="md-nav__button md-logo">
<i class="md-icon">local_library</i>
</a>
<a href="../index.html" title="Interface Database System (IDBS)">
Interface Database System (IDBS)
</a>
</label>
<ul>
  <li><a href="../idbs/introduction.html" class="page">Introduction</a></li>
  <li><a href="../idbs/overview.html" class="page">Overview</a></li>
  <li><a href="../workflow/workflow.html" class="page">IDBS Workflow and Creating ICDs</a></li>
  <li><a href="../installing/installing.html" class="page">Installing IDBS</a></li>
  <li><a href="../modelFiles/modelFiles.html" class="page">Model Files</a></li>
  <li><a href="../icd-db/icd-db.html" class="active page">Using the icd-db command line app</a></li>
  <li><a href="../icd-fits/icd-fits.html" class="page">Using the icd-fits command line app</a></li>
  <li><a href="../webapp/webapp.html" class="page">Using the Web Interface</a></li>
</ul>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="../icd-db/icd-db.html#using-the-icd-db-command-line-app" class="header">Using the icd-db command line app</a>
  <ul>
    <li><a href="../icd-db/icd-db.html#generating-documents-and-code-from-the-icd-database" class="header">Generating Documents and Code from the ICD Database</a></li>
  </ul></li>
</ul>
</nav>

</nav>
<ul style="display: none">
<li class="md-nav__item md-version" id="project.version">
<label class="md-nav__link" for="__version">
<i class="md-icon" title="Version">label_outline</i> 3.1.0
</label>
</li>
</ul>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="../icd-db/icd-db.html#using-the-icd-db-command-line-app" class="header">Using the icd-db command line app</a>
  <ul>
    <li><a href="../icd-db/icd-db.html#generating-documents-and-code-from-the-icd-database" class="header">Generating Documents and Code from the ICD Database</a></li>
  </ul></li>
</ul>
</nav>

</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<div class="md-content__searchable">
<h1><a href="#using-the-icd-db-command-line-app" name="using-the-icd-db-command-line-app" class="anchor"><span class="anchor-link"></span></a>Using the icd-db command line app</h1>
<p>The <code>icd-db</code> program can be used to validate and ingest model files into the database. In order to use the <code>icd-db</code> program, the MongoDB server must be running (see <a href="../installing/installing.html#installing-mongodb">Installing MongoDB</a>). Most of what <code>icd-db</code> command provides can also be done using the web interface, so it’s possible to skip this step.</p>
<p><img src="../images/icd-db/icd-db.png" /></p>
<p>The figure above shows the usage of the <code>icd-db</code> program. Its primary purpose is to validate and ingest model files into the ICD Model File Database. If any of the model files under the given directory don’t pass validation, then nothing is changed in the database. Error messages indicate where the validation errors occurred, including a file name and a position in JSONPath format.</p>
<p>Below you see the options for the <code>icd-db</code> command, which are listed with the &ndash;help option. Some of the options are basic querying of the database, to see what subsystems and components are currently in the local database, and information about them, such as data rates and units used. This can be useful when developing and browsing APIs without bringing up the full system.</p>
<pre><code>icd-db 3.0.0
Usage: icd-db [options]

  --db &lt;name&gt;              The name of the database to use (default: icds4)
  -h, --host &lt;hostname&gt;    The host name where the database is running (default: localhost)
  -p, --port &lt;number&gt;      The port number to use for the database (default: 27017)
  -i, --ingest &lt;dir&gt;       Top level directory containing files to ingest into the database
  -l, --list [subsystems|assemblies|hcds|all]
                           Prints a list of ICD subsystems, assemblies, HCDs or all components
  --listData &lt;subsystem&gt;   Prints a list of event sizes and yearly accumulation of archived data for 
			   components of the specified subsystem.
  -u, --allUnits           Prints the set of unique units used in all received commands and published events 
			   for all components in DB.
  -c, --component &lt;name&gt;   Specifies the component to be used by any following options 
			   (subsystem must also be specified)
  -s, --subsystem &lt;subsystem&gt;[:version]
                           Specifies the subsystem (and optional version) to be used by any following options
  -t, --subsystem2 &lt;subsystem&gt;[:version]
                           Specifies the second subsystem (and optional version) in an ICD to be used by 
			   any following options
  --component2 &lt;name&gt;      Specifies the subsytem2 component to be used by any following options 
			   (subsystem2 must also be specified)
  --icdversion &lt;icd-version&gt;
                           Specifies the version to be used by any following options (overrides subsystem 
			   and subsystem2 versions)
  -o, --out &lt;outputFile&gt;   Saves the selected API (or ICD) to the given file in a format based on the file&#39;s
 			   suffix (html, pdf) or generates code for the given API in a language based on the
 			   suffix (&#39;scala&#39;, &#39;java&#39;, &#39;ts&#39; (typescript), py (python))
  --drop [db|subsystem|component]
                           Drops the specified component, subsystem, or the entire icd database 
			   (requires restart of icd web app)
  --versions &lt;subsystem&gt;   List the version history of the given subsystem
  --diff &lt;subsystem&gt;:&lt;version1&gt;[,version2]
                           For the given subsystem, list the differences between &lt;version1&gt; and &lt;version2&gt; 
			   (or the current version)
  -m, --missing &lt;outputFile&gt;
                           Generates a &#39;Missing Items&#39; report to the given file (dir for csv) in a format 
			   based on the file&#39;s suffix (html, pdf, otherwise text/csv formatted files are
 			   generated in given dir)
  -a, --archived &lt;outputFile&gt;
                           Generates an &#39;Archived Items&#39; report for all subsystems (or the given one) to the
 			   given file in a format based on the file&#39;s suffix (html, pdf, csv)
  --allSubsystems          Include all subsystems in searches for publishers, subscribers, etc. while 
			   generating API doc (Default: only consider the one subsystem)
  --clientApi              Include subscribed events and sent commands in the API dic (Default: only include
			   published events and received commands)
  --orientation [portrait|landscape]
                           For PDF output: The page orientation (default: landscape)
  --fontSize &lt;size&gt;        For PDF or HTML file output: The base font size in px for body text (default: 10)
  --lineHeight &lt;height&gt;    For PDF or HTML file output: The line height (default: 1.6)
  --paperSize [Letter|Legal|A4|A3]
                           For PDF output: The paper size (default: Letter)
  --documentNumber text    For PDF output: An optional document number to display after the title/subtitle
  --package package.name   Package name for generated Scala files (default: no package)
  --help
  --version
</code></pre>
<p>Some example commands are shown below.</p>
<p>To ingest the directory of model files created in the last section use the <code>-i</code> or <code>--ingest</code> option:</p>
<pre><code>icd-db --ingest directoryName
</code></pre>
<p>The <code>–l</code> or <code>--list</code> option with a value of <code>subsystems</code>, <code>assemblies</code>, <code>HCDs</code>, or <code>all</code> will list the components in the database that meet the criteria:</p>
<pre><code>$ icd-db –list all
</code></pre>
<p>To list just assemblies:</p>
<pre><code>$ icd-db –list assemblies
</code></pre>
<p>List only HCDs:</p>
<pre><code>$ icd-db –list hcds
</code></pre>
<p>List the existing subsystems in the local database:</p>
<pre><code>$ icd-db –list subsystems
</code></pre>
<p>Several other commands are available and are not documented here.</p>
<h2><a href="#generating-documents-and-code-from-the-icd-database" name="generating-documents-and-code-from-the-icd-database" class="anchor"><span class="anchor-link"></span></a>Generating Documents and Code from the ICD Database</h2>
<p>The <code>icd-db –o</code> option can be used to output a file in a format based on the file’s suffix (<code>.pdf</code> and <code>.html</code> are supported for generating documentation and <code>.scala</code>, <code>.java</code>, <code>.py</code> (python) and <code>.ts</code> (typescript) are supported for generating code containing the event, command and parameter keys for the given subsystem and/or component:</p>
<pre><code>$ icd-db –s TCS -o TcsApi.pdf    // Generate a PDF for TCS
$ icd-db –s TCS -o TcsApi.scala  // Generate Scala code for TCS
$ icd-db –s TCS -o TcsApi.java   // Generate Java code for TCS
$ icd-db –s TCS -o TcsApi.py     // Generate Python code for TCS
$ icd-db –s TCS -o TcsApi.ts     // Generate Typescript code for TCS
</code></pre>
<p>You can also generate documentation and code for a specific component of a subsystem and specify the package name (required for Java):</p>
<pre><code>$ icd-db –s IRIS -c ifs.scale -o IrisApi.pdf                     // Generate a PDF for IRIS.ifs.scale
$ icd-db –s IRIS -c ifs.scale –package iris.api -o IrisApi.scala // Generate Scala code for IRIS.ifs.scale
$ icd-db –s IRIS -c ifs.scale –package iris.api -o IrisApi.java  // Generate Java code for IRIS.ifs.scale
$ icd-db –s IRIS -c ifs.scale -o IrisApi.py                      // Generate Python code for IRIS.ifs.scale
$ icd-db –s IRIS -c ifs.scale -o IrisApi.ts                      // Generate Typescript code for IRIS.ifs.scale
</code></pre>
<p>The generated code always contains a top level object (scala), class (java, python) or namespace (typescript) with the base name of the file. Then there are nested objects for each component, and in each component, nested objects for each event and command, containing constants for all the event keys, command names and parameter keys.</p><div class="callout note "><div class="callout-title">Note</div>
<p>After generating the code, <code>icd-db</code> attempts to format it using a command line formatter application in your shell path. It uses <a href="https://scalameta.org/scalafmt/">scalafmt</a> for Scala, <a href="https://prettier.io/">prettier</a> for TypeScript, <a href="https://github.com/psf/black">black</a> for Python and <a href="https://github.com/google/google-java-format">google-java-format</a> for Java. If it doesn&rsquo;t find those it will print a message, but still generate the file. You can install scalafmt and <code>google-java-format</code> with <a href="https://get-coursier.io/">cs (coursier)</a>, <code>black</code> with <code>pip</code> (<code>pip3</code>), and <code>prettier</code> with <a href="https://www.npmjs.com/">npm</a>.</p></div>
<p>You can also generate code using the web interface, as described later.</p>
</div>
<div>
<a href="https://github.com/tmtsoftware/icd/tree/master/docs/src/main/icd-db/icd-db.md" title="Edit this page" class="md-source-file md-edit">
Edit this page
</a>
</div>
<div class="print-only">
<span class="md-source-file md-version">
3.1.0
</span>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a href="../modelFiles/modelFiles.html" title="Model Files" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Previous
</span>
Model Files
</span>
</div>
</a>
<a href="../icd-fits/icd-fits.html" title="Using the icd-fits command line app" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Next
</span>
Using the icd-fits command line app
</span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
Powered by
<a href="https://github.com/lightbend/paradox">Paradox</a>
and
<a href="https://jonas.github.io/paradox-material-theme/">Paradox Material Theme</a>

</div>
</div>
</div>
</footer>

</div>
<script src="../assets/javascripts/application.583bbe55.js"></script>
<script src="../assets/javascripts/paradox-material-theme.js"></script>
<script>app.initialize({version:"0.17",url:{base:"../."}})</script>
<script type="text/javascript" src="../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
window.prettyPrint && prettyPrint();
});
</script>
</body>
</html>
