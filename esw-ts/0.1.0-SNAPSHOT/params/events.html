<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="description" content="docs">
<meta name="generator" content="Paradox, paradox-material-theme=0.7.0, mkdocs-material=3.0.3">

<meta name="lang:clipboard.copy" content="Copy to clipboard">
<meta name="lang:clipboard.copied" content="Copied to clipboard">
<meta name="lang:search.language" content="">
<meta name="lang:search.pipeline.stopwords" content="true">
<meta name="lang:search.pipeline.trimmer" content="true">
<meta name="lang:search.result.none" content="No matching documents">
<meta name="lang:search.result.one" content="1 matching document">
<meta name="lang:search.result.other" content="# matching documents">
<meta name="lang:search.tokenizer" content="[\s\-]+">


<meta name="description" content="docs">
<link rel="shortcut icon" href="../assets/images/favicon.png">
<title>Events Â· TMT JavaScript/Typescript Library</title>
<link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
<link rel="stylesheet" href="../lib/material__tabs/dist/mdc.tabs.min.css">
<link rel="stylesheet" href="../lib/prettify/prettify.css">
<script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
<style>
body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}
code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}
</style>
<link rel="stylesheet" href="../assets/fonts/font-awesome.css">
<link rel="stylesheet" href="../assets/fonts/material-icons.css">
<link rel="stylesheet" href="../assets/stylesheets/paradox-material-theme.css">
</head>
<body
>
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a href="../index.html" title="TMT JavaScript/Typescript Library" class="md-header-nav__button md-logo">
<i class="md-icon">local_library</i>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
TMT JavaScript/Typescript Library
</span>
<span class="md-header-nav__topic">
Events
</span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
<label class="md-icon md-search__icon" for="__search"></label>
<button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix>
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
Type to start searching
</div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>

</div>
</div>
</nav>
</header>

<div class="md-container">
<main class="md-main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0" style="visibility: hidden">
<label class="md-nav__title md-nav__title--site" for="drawer">
<a href="../index.html" title="TMT JavaScript/Typescript Library" class="md-nav__button md-logo">
<span class="md-nav__button md-logo">
<i class="md-icon">local_library</i>
</a>
<a href="../index.html" title="TMT JavaScript/Typescript Library">
TMT JavaScript/Typescript Library
</a>
</label>
<ul>
  <li><a href="../UIOverview.html" class="page">User Interfaces in ESW and TMT</a></li>
  <li><a href="../common/getting-started.html" class="page">Getting Started with ESW-TS</a></li>
  <li><a href="../params/index.html" class="page">Params</a>
  <ul>
    <li><a href="../params/commands.html" class="page">Commands</a></li>
    <li><a href="../params/events.html" class="active page">Events</a></li>
    <li><a href="../params/keys-and-parameters.html" class="page">Keys and Parameters</a></li>
    <li><a href="../params/result.html" class="page">Result</a></li>
    <li><a href="../params/subsystem.html" class="page">Subsystem</a></li>
    <li><a href="../params/state-variables.html" class="page">State variables</a></li>
    <li><a href="../params/units.html" class="page">Units</a></li>
  </ul></li>
  <li><a href="../aas/auth-components.html" class="page">Auth Components</a></li>
  <li><a href="../common/response-handling.html" class="page">Response Handling in ESW-TS</a></li>
  <li><a href="../common/error-handling.html" class="page">Error Handling in ESW-TS</a></li>
  <li><a href="../services/index.html" class="page">Services</a>
  <ul>
    <li><a href="../services/admin-service.html" class="page">Admin Service</a></li>
    <li><a href="../services/alarm-service.html" class="page">Alarm Service</a></li>
    <li><a href="../services/command-service.html" class="page">Command Service</a></li>
    <li><a href="../services/config-service.html" class="page">Config Service</a></li>
    <li><a href="../services/event-service.html" class="page">Event Service</a></li>
    <li><a href="../services/location-service.html" class="page">Location Service</a></li>
    <li><a href="../services/logging-service.html" class="page">Logging Service</a></li>
  </ul></li>
  <li><a href="../technical/index.html" class="page">Technical Design Documentation</a>
  <ul>
    <li><a href="../technical/agent-service.html" class="page">Agent Service</a></li>
    <li><a href="../technical/sequencer-service.html" class="page">Sequencer Service</a></li>
    <li><a href="../technical/sequence-manager-service.html" class="page">Sequence Manager Service</a></li>
    <li><a href="../technical/auth-components.html" class="page">Auth Components</a></li>
    <li><a href="../common/contract.html" class="page">Service Contract</a></li>
  </ul></li>
  <li><a href="../common/ts-docs.html" class="page">Type Definitions</a></li>
</ul>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="../params/events.html#events" class="header">Events</a>
  <ul>
    <li><a href="../params/events.html#eventtime" class="header">EventTime</a></li>
    <li><a href="../params/events.html#system-event" class="header">System Event</a></li>
    <li><a href="../params/events.html#observe-event" class="header">Observe Event</a></li>
    <li><a href="../params/events.html#unique-key-constraint" class="header">Unique Key Constraint</a></li>
  </ul></li>
</ul>
</nav>

</nav>
<ul style="display: none">
<li class="md-nav__item md-version" id="project.version">
<label class="md-nav__link" for="__version">
<i class="md-icon" title="Version">label_outline</i> 0.1.0*
</label>
</li>
</ul>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="../params/events.html#events" class="header">Events</a>
  <ul>
    <li><a href="../params/events.html#eventtime" class="header">EventTime</a></li>
    <li><a href="../params/events.html#system-event" class="header">System Event</a></li>
    <li><a href="../params/events.html#observe-event" class="header">Observe Event</a></li>
    <li><a href="../params/events.html#unique-key-constraint" class="header">Unique Key Constraint</a></li>
  </ul></li>
</ul>
</nav>

</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<div class="md-content__searchable">
<h1><a href="#events" name="events" class="anchor"><span class="anchor-link"></span></a>Events</h1>
<p>Events are the most basic type of asynchronous notification in TMT when an activity occurs somewhere in the TMT system and other components need to be notified. Each type of event has a unique purpose and unique information, but they all share the same structural features. All events have <code>EventInfo</code> and a <code>ParameterSet</code>.</p>
<p>Type definition for Event can be found <a href="file:///Users/manishgowardipe/projects/tmt/esw-ts/target/site/esw-ts/0.1.0-SNAPSHOT/ts-docs/modules/models.html#event">here</a></p>
<h2><a href="#eventtime" name="eventtime" class="anchor"><span class="anchor-link"></span></a>EventTime</h2>
<p>Each event includes its time of creation in UTC format. You can access that <code>eventTime</code> as follows:</p>
<dl>
  <dt>Typescript</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/tmtsoftware/esw-ts/tree/master/example/src/documentation/params/EventExample.ts#L14-L19" target="_blank" title="Go to snippet source">source</a><code class="language-ts">const source = new Prefix(&#39;IRIS&#39;, &#39;filter.wheel&#39;)
const eventName = new EventName(&#39;temperatures&#39;)
const event = SystemEvent.make(source, eventName)

// accessing eventTime
const eventTime = event.eventTime</code></pre></dd>
</dl>
<h2><a href="#system-event" name="system-event" class="anchor"><span class="anchor-link"></span></a>System Event</h2>
<p><code>SystemEvent</code> is the type used to describe the majority of events in the system. An example is a demand that is the output of an algorithm in one component that is used as an input to another. SystemEvent is also used to publish internal state or status values of a component that may be of interest to other components in the system.</p>
<h3><a href="#example-snippets-for-creation-of-system-event" name="example-snippets-for-creation-of-system-event" class="anchor"><span class="anchor-link"></span></a>Example snippets for creation of System Event</h3>
<dl>
  <dt>Typescript</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/tmtsoftware/esw-ts/tree/master/example/src/documentation/params/EventExample.ts#L23-L65" target="_blank" title="Go to snippet source">source</a><code class="language-ts">//keys
const k1 = intKey(&#39;encoder&#39;)
const k2 = intKey(&#39;speed&#39;)
const k3 = stringKey(&#39;filter&#39;)
const k4 = intKey(&#39;notUsed&#39;)

//prefixes
const ck1 = Prefix.fromString(&#39;wfos.red.filter&#39;)
const name1 = new EventName(&#39;filterWheel&#39;)
const ck3 = Prefix.fromString(&#39;iris.imager.filter&#39;)
const name3 = new EventName(&#39;status&#39;)

//parameters
const p1: Parameter&lt;IntKey&gt; = k1.set([22])
const p2: Parameter&lt;IntKey&gt; = k2.set([44])
const p3: Parameter&lt;StringKey&gt; = k3.set([&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;])

//Create SystemEvent using madd
const se1: SystemEvent = SystemEvent.make(ck1, name1).madd([p1, p2])
//Create SystemEvent using make
const se2: SystemEvent = SystemEvent.make(ck3, name3, [p1, p2])
//Create SystemEvent and use add
const se3: SystemEvent = SystemEvent.make(ck3, name3).add(p1).add(p2).add(p3)

//access keys
const k1Exists: Boolean = se1.exists(k1) //true

//access Parameters
const p4: Option&lt;Parameter&lt;IntKey&gt;&gt; = se1.get(k1)

//access values
const v1: Option&lt;number[]&gt; = se1.get(k1)?.values
const v2: Option&lt;number[]&gt; = se2.get(k2)?.values

//remove keys
const se4: SystemEvent = se3.remove(k3)

//add more than one parameters, using madd
const se5: SystemEvent = se4.madd([k3.set([&#39;X&#39;, &#39;Y&#39;, &#39;Z&#39;]), k4.set([99, 100])])
const paramSize: number = se5.size()

//update existing key with set
const se6: SystemEvent = se5.add(k2.set([5, 6, 7, 8]))</code></pre></dd>
</dl>
<h2><a href="#observe-event" name="observe-event" class="anchor"><span class="anchor-link"></span></a>Observe Event</h2>
<p><code>ObserveEvent</code> are standardized events used to describe the activities within the data acquisition process. These events are typically published by Science Detector Assemblies, which emit ObserveEvents during their exposures to signal the occurrence of specific activities/actions during the acquisition of data.</p>
<h3><a href="#example-snippets-for-creation-of-observe-event" name="example-snippets-for-creation-of-observe-event" class="anchor"><span class="anchor-link"></span></a>Example snippets for creation of Observe Event</h3>
<dl>
  <dt>Typescript</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/tmtsoftware/esw-ts/tree/master/example/src/documentation/params/EventExample.ts#L70-L106" target="_blank" title="Go to snippet source">source</a><code class="language-ts"><br/>//keys
const k1 = intKey(&#39;readoutsCompleted&#39;)
const k2 = intKey(&#39;coaddsCompleted&#39;)
const k3 = stringKey(&#39;fileID&#39;)
const k4 = intKey(&#39;notUsed&#39;)

//prefixes
const ck1 = Prefix.fromString(&#39;iris.ifu.detectorAssembly&#39;)
const name1 = new EventName(&#39;readoutEnd&#39;)
const ck3 = Prefix.fromString(&#39;wfos.red.detector&#39;)
const name3 = new EventName(&#39;exposureStarted&#39;)

//parameters
const p1: Parameter&lt;IntKey&gt; = k1.set([4])
const p2: Parameter&lt;IntKey&gt; = k2.set([2])
const p3: Parameter&lt;StringKey&gt; = k3.set([&#39;WFOS-RED-0001&#39;])

//Create ObserveEvent using madd
const se1: ObserveEvent = ObserveEvent.make(ck1, name1).madd([p1, p2])
//Create ObserveEvent using apply
const se2: ObserveEvent = ObserveEvent.make(ck3, name3, [p1, p2])
//Create ObserveEvent and use add
const se3: ObserveEvent = ObserveEvent.make(ck3, name3).add(p1).add(p2).add(p3)

//access keys
const k1Exists: Boolean = se1.exists(k1) //true

//access Parameters
const p4: Option&lt;Parameter&lt;IntKey&gt;&gt; = se1.get(k1)

//access values
const v1: Option&lt;number[]&gt; = se1.get(k1)?.values
const v2: Option&lt;number[]&gt; = se2.get(k2)?.values

//remove keys
const se4: ObserveEvent = se3.remove(k3)</code></pre></dd>
</dl>
<h2><a href="#unique-key-constraint" name="unique-key-constraint" class="anchor"><span class="anchor-link"></span></a>Unique Key Constraint</h2>
<p>By choice, a <code>ParameterSet</code> in either <code>ObserveEvent</code> or <code>SystemEvent</code> event will be optimized to store only unique keys. When using <code>add</code> or <code>madd</code> methods on events to add new parameters, if the parameter being added has a key which is already present in the paramSet, the already stored parameter will be replaced by the given parameter.</p><div class="callout note "><div class="callout-title">Note</div>
<p>If the Set is created by component developers and given directly while creating an event, then it will be the responsibility of component developers to maintain uniqueness with parameters based on key.</p></div>
<h3><a href="#here-are-some-examples-that-illustrate-this-point" name="here-are-some-examples-that-illustrate-this-point" class="anchor"><span class="anchor-link"></span></a>Here are some examples that illustrate this point</h3>
<dl>
  <dt>Typescript</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/tmtsoftware/esw-ts/tree/master/example/src/documentation/params/EventExample.ts#L111-L150" target="_blank" title="Go to snippet source">source</a><code class="language-ts">//keys
const encoderKey = intKey(&#39;encoder&#39;)
const filterKey = intKey(&#39;filter&#39;)
const miscKey = intKey(&#39;misc&#39;)

//prefix
const prefix = Prefix.fromString(&#39;wfos.blue.filter&#39;)

const name1 = new EventName(&#39;filterWheel&#39;)

//params
const encParam1 = encoderKey.set([1])
const encParam2 = encoderKey.set([2])

const encParam3 = encoderKey.set([3])
const filterParam1 = filterKey.set([1])
const filterParam2 = filterKey.set([2])

const filterParam3 = filterKey.set([3])

const miscParam1 = miscKey.set([100])
//StatusEvent with duplicate key via constructor
const systemEvent = SystemEvent.make(prefix, name1, [
  encParam1,
  encParam2,
  encParam3,
  filterParam1,
  filterParam2,
  filterParam3
])

//try adding duplicate keys via add + madd
const changedStatusEvent = systemEvent.add(encParam3).madd([filterParam1, filterParam2, filterParam3])
//duplicate keys will not be added. Should contain one Encoder and one Filter key
const uniqueKeys2 = changedStatusEvent.paramSet.map((x) =&gt; x.keyName)

//miscKey(unique) will be added; encoderKey(duplicate) will not be added
const finalStatusEvent = systemEvent.madd([miscParam1, encParam1])
//now contains encoderKey, filterKey, miscKey
const uniqueKeys3 = finalStatusEvent.paramSet.map((x) =&gt; x.keyName)</code></pre></dd>
</dl>
</div>
<div>
<a href="https://github.com/tmtsoftware/esw-ts/tree/master/docs/src/main/params/events.md" title="Edit this page" class="md-source-file md-edit">
Edit this page
</a>
</div>
<div class="print-only">
<span class="md-source-file md-version">
0.1.0*
</span>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a href="../params/commands.html" title="Commands" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Previous
</span>
Commands
</span>
</div>
</a>
<a href="../params/keys-and-parameters.html" title="Keys and Parameters" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Next
</span>
Keys and Parameters
</span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
Powered by
<a href="https://github.com/lightbend/paradox">Paradox</a>
and
<a href="https://jonas.github.io/paradox-material-theme/">Paradox Material Theme</a>

</div>
</div>
</div>
</footer>

</div>
<script src="../assets/javascripts/application.583bbe55.js"></script>
<script src="../assets/javascripts/paradox-material-theme.js"></script>
<script>app.initialize({version:"0.17",url:{base:"../."}})</script>
<script type="text/javascript" src="../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
window.prettyPrint && prettyPrint();
});
</script>
</body>
</html>
