<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="description" content="docs">
<meta name="generator" content="Paradox, paradox-material-theme=0.7.0, mkdocs-material=3.0.3">

<meta name="lang:clipboard.copy" content="Copy to clipboard">
<meta name="lang:clipboard.copied" content="Copied to clipboard">
<meta name="lang:search.language" content="">
<meta name="lang:search.pipeline.stopwords" content="true">
<meta name="lang:search.pipeline.trimmer" content="true">
<meta name="lang:search.result.none" content="No matching documents">
<meta name="lang:search.result.one" content="1 matching document">
<meta name="lang:search.result.other" content="# matching documents">
<meta name="lang:search.tokenizer" content="[\s\-]+">


<meta name="description" content="docs">
<link rel="shortcut icon" href="../../../assets/images/favicon.png">
<title>Event Service Â· TMT Executive Software Documentation</title>
<link rel="stylesheet" href="../../../assets/stylesheets/application.451f80e5.css">
<link rel="stylesheet" href="../../../lib/material__tabs/dist/mdc.tabs.min.css">
<link rel="stylesheet" href="../../../lib/prettify/prettify.css">
<script src="../../../assets/javascripts/modernizr.1aa3b519.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
<style>
body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}
code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}
</style>
<link rel="stylesheet" href="../../../assets/fonts/font-awesome.css">
<link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
<link rel="stylesheet" href="../../../assets/stylesheets/paradox-material-theme.css">
</head>
<body
>
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a href="../../../index.html" title="TMT Executive Software Documentation" class="md-header-nav__button md-logo">
<i class="md-icon">local_library</i>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
TMT Executive Software Documentation
</span>
<span class="md-header-nav__topic">
Event Service
</span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
<label class="md-icon md-search__icon" for="__search"></label>
<button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix>
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
Type to start searching
</div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>

</div>
</div>
</nav>
</header>

<div class="md-container">
<main class="md-main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0" style="visibility: hidden">
<label class="md-nav__title md-nav__title--site" for="drawer">
<a href="../../../index.html" title="TMT Executive Software Documentation" class="md-nav__button md-logo">
<span class="md-nav__button md-logo">
<i class="md-icon">local_library</i>
</a>
<a href="../../../index.html" title="TMT Executive Software Documentation">
TMT Executive Software Documentation
</a>
</label>
<ul>
  <li><a href="../../../esw/eswOverview.html" class="page">Executive Software Overview</a></li>
  <li><a href="../../../sequencersandscripts/seq-index.html" class="page">Sequencers and Sequence Components</a>
  <ul>
    <li><a href="../../../sequencersandscripts/sequencer.html" class="page">Sequencers in the Executive Software</a></li>
    <li><a href="../../../sequencersandscripts/sequencer-app.html" class="page">Running a Sequencer Using esw-ocs-app</a></li>
  </ul></li>
  <li><a href="../../../scripts/scripts-index.html" class="page">Sequencer Scripts</a>
  <ul>
    <li><a href="../../../scripts/script-styles.html" class="page">Sequencer Script Styles</a></li>
    <li><a href="../../../scripts/dsl/script-constructs.html" class="page">Script DSL Constructs</a></li>
    <li><a href="../../../scripts/dsl/csw-services.html" class="page">CSW Services DSL</a></li>
  </ul></li>
  <li><a href="../../../uisupport/uisupp-index.html" class="page">User Interface Support</a>
  <ul>
    <li><a href="../../../uisupport/UIOverview.html" class="page">User Interfaces in ESW and TMT</a></li>
    <li><a href="../../../uisupport/gatewayUI-template.html" class="page">Using the Gateway-only UI Template and Tutorial</a></li>
    <li><a href="../../../uisupport/webapp-template.html" class="page">Using the Web Application Template and Tutorial</a></li>
    <li><a href="../../../uisupport/gateway.html" class="page">User Interface Gateway</a></li>
  </ul></li>
  <li><a href="../../../technical/apps/apps-index.html" class="page">ESW Applications</a>
  <ul>
    <li><a href="../../../technical/apps/getting-apps.html" class="page">Getting and Running ESW Applications</a></li>
    <li><a href="../../../technical/apps/esw-shell.html" class="page">ESW Shell - A Testing Environment for ESW and CSW</a></li>
    <li><a href="../../../technical/apps/sequence-manager-app.html" class="page">Starting the Sequence Manager Application</a></li>
    <li><a href="../../../technical/apps/agent-service-app.html" class="page">The Agent Service Application</a></li>
    <li><a href="../../../technical/apps/agent-app.html" class="page">The Agent Application</a></li>
    <li><a href="../../../uisupport/gateway-app.html" class="page">Running the UI Gateway App</a></li>
    <li><a href="../../../technical/apps/esw-services.html" class="page">Running Multiple ESW Applications with esw-services</a></li>
    <li><a href="../../../technical/apps/eng-ui.html" class="page">ESW OCS Engineering User Interface User Manual</a></li>
  </ul></li>
  <li><a href="../../../technical/tech-index.html" class="page">Technical Design Documents</a>
  <ul>
    <li><a href="../../../technical/sequence-manager-tech.html" class="page">Sequence Manager Technical Documentation</a></li>
    <li><a href="../../../technical/sequencer-tech.html" class="page">Sequencer Technical Documentation</a></li>
    <li><a href="../../../technical/sequence-component-tech.html" class="page">Sequence Component Technical Documentation</a></li>
    <li><a href="../../../technical/gateway-tech.html" class="page">Gateway Technical Documentation</a></li>
    <li><a href="../../../technical/agent-service-tech.html" class="page">Agent Service and Agent Technical Documentation</a></li>
    <li><a href="../../../technical/esw-application-parts.html" class="page">ESW Application Architecture</a></li>
    <li><a href="../../../technical/contracts.html" class="page">Service Contracts</a></li>
    <li><a href="../../../technical/testing-philosophy.html" class="page">OSW Testing Philosophy</a></li>
  </ul></li>
</ul>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="../../../scripts/dsl/services/event-service.html#event-service" class="header">Event Service</a>
  <ul>
    <li><a href="../../../scripts/dsl/services/event-service.html#helper-methods" class="header">Helper Methods</a></li>
    <li><a href="../../../scripts/dsl/services/event-service.html#publishevent" class="header">publishEvent</a></li>
    <li><a href="../../../scripts/dsl/services/event-service.html#onevent" class="header">onEvent</a></li>
    <li><a href="../../../scripts/dsl/services/event-service.html#getevent" class="header">getEvent</a></li>
    <li><a href="../../../scripts/dsl/services/event-service.html#source-code-for-examples" class="header">Source code for examples</a></li>
  </ul></li>
</ul>
</nav>

</nav>
<ul style="display: none">
<li class="md-nav__item md-version" id="project.version">
<label class="md-nav__link" for="__version">
<i class="md-icon" title="Version">label_outline</i> 0.3.0-RC2
</label>
</li>
</ul>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="../../../scripts/dsl/services/event-service.html#event-service" class="header">Event Service</a>
  <ul>
    <li><a href="../../../scripts/dsl/services/event-service.html#helper-methods" class="header">Helper Methods</a></li>
    <li><a href="../../../scripts/dsl/services/event-service.html#publishevent" class="header">publishEvent</a></li>
    <li><a href="../../../scripts/dsl/services/event-service.html#onevent" class="header">onEvent</a></li>
    <li><a href="../../../scripts/dsl/services/event-service.html#getevent" class="header">getEvent</a></li>
    <li><a href="../../../scripts/dsl/services/event-service.html#source-code-for-examples" class="header">Source code for examples</a></li>
  </ul></li>
</ul>
</nav>

</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<div class="md-content__searchable">
<h1><a href="#event-service" name="event-service" class="anchor"><span class="anchor-link"></span></a>Event Service</h1>
<p>The Event Service DSL is a Kotlin wrapper for the CSW Event Service. This DSL has the ability of publishing, getting, and subscribing to events, and also contains some helper methods for model creation. You can refer to the detailed documentation of Event Service provided by CSW <a href="https://tmtsoftware.github.io/csw/4.0.0-RC2/services/event">here</a>.</p>
<h2><a href="#helper-methods" name="helper-methods" class="anchor"><span class="anchor-link"></span></a>Helper Methods</h2>
<p>These methods can be used to create System and Observe Events. Additionally, a System or Observe &ldquo;Event Variable&rdquo; can be created that can be tied to the first value of a parameter of an Event, similar to the way local variables are tied to &ldquo;process variables&rdquo; in the EPICS State Notation Language.</p>
<h3><a href="#systemevent" name="systemevent" class="anchor"><span class="anchor-link"></span></a>SystemEvent</h3>
<p>Helper DSL to create a <code>SystemEvent</code> from the provided <code>prefix</code>, <code>event name</code> and <code>parameters</code> (optional).</p>
<dl>
  <dt>Kotlin</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/tmtsoftware/esw/tree/master/examples/src/main/kotlin/esw/ocs/scripts/examples/paradox/EventServiceDslExample.kts#L22-L25" target="_blank" title="Go to snippet source">source</a><code class="language-kts">val parameters = intKey(&quot;stepNumber&quot;).set(1)

val systemEvent: SystemEvent = SystemEvent(&quot;ESW.IRIS_darkNight&quot;, &quot;stepInfo&quot;, parameters)</code></pre></dd>
</dl>
<h3><a href="#observeevent" name="observeevent" class="anchor"><span class="anchor-link"></span></a>ObserveEvent</h3>
<p>Helper DSL to create an <code>ObserveEvent</code> using factory provided to create various sequencer observe events. <code>sequencerObserveEvent</code> object is available in the script scope.</p>
<p>Refer <a href="https://tmtsoftware.github.io/csw/4.0.0-RC2/params/events.html#sequencers">here</a> to get the list of other Sequencer Events.</p>
<dl>
  <dt>Kotlin</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/tmtsoftware/esw/tree/master/examples/src/main/kotlin/esw/ocs/scripts/examples/paradox/EventServiceDslExample.kts#L30" target="_blank" title="Go to snippet source">source</a><code class="language-kts">val observeEvent: ObserveEvent = observationStart(ObsId(&quot;2020A-001-123&quot;))</code></pre></dd>
</dl>
<h2><a href="#publishevent" name="publishevent" class="anchor"><span class="anchor-link"></span></a>publishEvent</h2>
<p>DSL to publish the given <code>Event</code>.</p>
<dl>
  <dt>Kotlin</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/tmtsoftware/esw/tree/master/examples/src/main/kotlin/esw/ocs/scripts/examples/paradox/EventServiceDslExample.kts#L25-L34" target="_blank" title="Go to snippet source">source</a><code class="language-kts">val systemEvent: SystemEvent = SystemEvent(&quot;ESW.IRIS_darkNight&quot;, &quot;stepInfo&quot;, parameters)
publishEvent(systemEvent)</code></pre></dd>
</dl>
<p>This DSL can also publish events periodically when provided with the optional <code>duration</code> and an <code>event generator</code> function. In the below example, an Event with temperature Key will get published every 10 seconds, with current temperature value given by <em>getTemperature</em> method.</p>
<dl>
  <dt>Kotlin</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/tmtsoftware/esw/tree/master/examples/src/main/kotlin/esw/ocs/scripts/examples/paradox/EventServiceDslExample.kts#L58-L61" target="_blank" title="Go to snippet source">source</a><code class="language-kts">publishEvent(Duration.seconds(10)) {
    val temperatureKey = intKey(&quot;temperature&quot;).set(getTemperature())
    SystemEvent(&quot;ESW.IRIS_darkNight&quot;, &quot;temperature&quot;, temperatureKey)
}</code></pre></dd>
</dl>
<h2><a href="#onevent" name="onevent" class="anchor"><span class="anchor-link"></span></a>onEvent</h2>
<p>DSL to subscribe to events getting published on the given <code>EventKey</code> names. This DSL takes a <code>callback</code> as a lambda which operates on an event. The callback block will be invoked whenever an Event is published on any of the provided event keys.</p>
<dl>
  <dt>Kotlin</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/tmtsoftware/esw/tree/master/examples/src/main/kotlin/esw/ocs/scripts/examples/paradox/EventServiceDslExample.kts#L39-L45" target="_blank" title="Go to snippet source">source</a><code class="language-kts">val tempEventKey = &quot;IRIS.env.temperature.temp&quot;
val stateEventKey = &quot;IRIS.env.temperature.state&quot;
onEvent(tempEventKey, stateEventKey) { event -&gt;
    // logic to execute on every event
    println(event.eventKey())
}</code></pre></dd>
</dl>
<p>This DSL has the ability to control the subscription rate by providing a <code>duration</code> with the <code>callback</code>. This operates like the <a href="https://tmtsoftware.github.io/csw/4.0.0-RC2/services/event#controlling-subscription-rate">Rate Adapter Mode</a> for regular Event Service subscriptions.</p>
<dl>
  <dt>Kotlin</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/tmtsoftware/esw/tree/master/examples/src/main/kotlin/esw/ocs/scripts/examples/paradox/EventServiceDslExample.kts#L49-L52" target="_blank" title="Go to snippet source">source</a><code class="language-kts">onEvent(tempEventKey, stateEventKey, duration = Duration.seconds(2)) { event -&gt;
    // logic to execute on every event
    println(event.eventKey())
}</code></pre></dd>
</dl>
<h2><a href="#getevent" name="getevent" class="anchor"><span class="anchor-link"></span></a>getEvent</h2>
<p>DSL to get the latest Event published on each of the given <code>EventKey</code> names. There are two variations. One is for getting the latest event for single key, the other variation is to get the latest events against multiple keys.</p>
<dl>
  <dt>Kotlin</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/tmtsoftware/esw/tree/master/examples/src/main/kotlin/esw/ocs/scripts/examples/paradox/EventServiceDslExample.kts#L39-L67" target="_blank" title="Go to snippet source">source</a><code class="language-kts">val tempEventKey = &quot;IRIS.env.temperature.temp&quot;
val stateEventKey = &quot;IRIS.env.temperature.state&quot;
val event = getEvent(tempEventKey) // for single event key

val events: Set&lt;Event&gt; = getEvent(tempEventKey, stateEventKey) // for single event key</code></pre></dd>
</dl>
<h2><a href="#source-code-for-examples" name="source-code-for-examples" class="anchor"><span class="anchor-link"></span></a>Source code for examples</h2>
<ul>
  <li><a href="https://github.com/tmtsoftware/esw/blob/v0.3.0-RC2/examples/src/main/kotlin/esw/ocs/scripts/examples/paradox/EventServiceDslExample.kts">Event Service Examples</a></li>
  <li><a href="https://github.com/tmtsoftware/esw/blob/v0.3.0-RC2/examples/src/main/kotlin/esw/ocs/scripts/examples/testData/ObserveEventExampleScript.kts">Observe Event Example</a></li>
</ul>
</div>
<div>
<a href="https://github.com/tmtsoftware/esw/tree/master/docs/src/main/scripts/dsl/services/event-service.md" title="Edit this page" class="md-source-file md-edit">
Edit this page
</a>
</div>
<div class="print-only">
<span class="md-source-file md-version">
0.3.0-RC2
</span>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a href="../../../scripts/dsl/services/sequencer-command-service.html" title="Sequencer Command Service" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Previous
</span>
Sequencer Command Service
</span>
</div>
</a>
<a href="../../../scripts/dsl/services/logging-service.html" title="Logging Service" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Next
</span>
Logging Service
</span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
Powered by
<a href="https://github.com/lightbend/paradox">Paradox</a>
and
<a href="https://jonas.github.io/paradox-material-theme/">Paradox Material Theme</a>

</div>
</div>
</div>
</footer>

</div>
<script src="../../../assets/javascripts/application.583bbe55.js"></script>
<script src="../../../assets/javascripts/paradox-material-theme.js"></script>
<script>app.initialize({version:"0.17",url:{base:"../../../."}})</script>
<script type="text/javascript" src="../../../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../../../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
window.prettyPrint && prettyPrint();
});
</script>
</body>
</html>
