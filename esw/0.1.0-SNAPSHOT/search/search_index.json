{"docs":[{"location":"/paradox.json","text":"","title":""},{"location":"/index.html","text":"","title":"TMT Executive Software (ESW)"},{"location":"/index.html#tmt-executive-software-esw-","text":"","title":"TMT Executive Software (ESW)"},{"location":"/sequencer-server.html","text":"","title":"sequencer-http-server"},{"location":"/sequencer-server.html#sequencer-http-server","text":"When sequencer is started on machine, it also starts embedded http server on random free port. This embedded sequencer server is registered with location service so that it can be discovered and used to communicate with sequencer component. sequencer-http-server exposes http endpoints of SequencerCommandService which enables to submit sequence to sequencer and query for response. It also exposes other endpoints (SequencerApi) which allows to edit sequence, pause/resume sequence, sequencer lifecycle enpdoints etc. sequencer-http-server http interface is explained in detail in Routes section.","title":"sequencer-http-server"},{"location":"/sequencer-server.html#prerequisite","text":"It requires csw-location-server running on machine. The csw-services.sh script does this for you. This application will start a HTTP CSW Location Server on port 7654 which is required for all Location Service consumers who uses HTTP Location client. All components (HCD’s, Assemblies, Services, Sequencer, sequencer-http-server etc.) use a local HTTP Location client which expects the Location Server running at localhost:7654. In a production environment, it is required that all machines running components should have the HTTP Location Server running locally.","title":"Prerequisite"},{"location":"/sequencer-server.html#starting-sequencer-http-server","text":"When sequencer app is started, it starts sequencer server and registers it with location server. Sequencer is registered as akka as well as http location. For example, sequencer with subsystem iris and observing mode darknight is registered with iris.darknight (.) prefix.","title":"Starting sequencer-http-server"},{"location":"/sequencer-server.html#http-endpoints","text":"Note Please replace port in following examples with appropriate sequencer-server port. e.g. - POST http://localhost:<your-port>/post-endpoint Please use appropriate id in respective APIs. e.g. - delete, addBreakpoint etc.","title":"http endpoints"},{"location":"/sequencer-server.html#sequencer-command-service","text":"This allows to submit sequence to sequencer and query for response","title":"Sequencer command service"},{"location":"/sequencer-server.html#submit","text":"This endpoint allows to submit sequence to sequencer. Sequencer will start executing sequence. This api gives SubmitResponse future as response. Submit won’t wait for final response. It will give started response saying sequence is submitted successfully and started.\nSubmit POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"Submit\": {\n    \"sequence\": [\n      {\n        \"Setup\": {\n          \"source\": \"esw.test\",\n          \"commandName\": \"command-2\",\n          \"maybeObsId\": [\n            \"obsId\"\n          ],\n          \"paramSet\": []\n        }\n      }\n    ]\n  }\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 06:36:10 GMT\nContent-Type: application/json\nContent-Length: 60\n\n{\n  \"Started\": {\n    \"runId\": \"eee70d8c-8edb-4858-8994-5fe0357d3a90\"\n  }\n}\n\n###","title":"Submit"},{"location":"/sequencer-server.html#re-submit-sequence-when-previous-sequence-is-in-progress","text":"Re-Submit POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"Submit\": {\n    \"sequence\": [\n      {\n        \"Setup\": {\n          \"source\": \"esw.test\",\n          \"commandName\": \"command-2\",\n          \"maybeObsId\": [\n            \"obsId\"\n          ],\n          \"paramSet\": []\n        }\n      },\n      {\n        \"Observe\": {\n          \"source\": \"esw.test\",\n          \"commandName\": \"command-1\",\n          \"maybeObsId\": [\n            \"obsId\"\n          ],\n          \"paramSet\": []\n        }\n      }\n    ]\n  }\n}\n\n### 200 OK with Domain error HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 06:44:23 GMT\nContent-Type: application/json\nContent-Length: 174\n\n{\n  \"Invalid\": {\n    \"runId\": \"IdNotAvailable\",\n    \"issue\": {\n      \"UnsupportedCommandInStateIssue\": {\n        \"reason\": \"Sequencer can not accept 'SubmitSequenceInternal' message in 'InProgress' state\"\n      }\n    }\n  }\n}\n\n###","title":"Re-Submit sequence when previous sequence is in progress"},{"location":"/sequencer-server.html#malformed-request","text":"Malformed request for submit POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"Submit\": {\n    \"sequence\": [\n      {\n        \"Setup\": {\n          \"source\": \"esw.test\",\n          \"commandName\": \"command-1\",\n          \"paramSet\": []\n        }\n      }\n    ]\n  }\n}\n\n### 400 Bad Request HTTP/1.1 400 Bad Request\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 06:48:15 GMT\nContent-Type: text/plain; charset=UTF-8\nContent-Length: 122\n\nThe request content was malformed:\nCannot decode `Setup` instance due to missing map key \"maybeObsId\" (input position 164)\n\n###","title":"Malformed Request"},{"location":"/sequencer-server.html#query","text":"This endpoint allows to query for sequence response. Query response can be intermediate reponse or final response.\nQuery POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"Query\": \"6ed2bf72-d7a3-498f-85e4-b3719727d18c\"\n}\n\n### 200 OK [Started Response] HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 07:12:34 GMT\nContent-Type: application/json\nContent-Length: 60\n\n{\n  \"Started\": {\n    \"runId\": \"6ed2bf72-d7a3-498f-85e4-b3719727d18c\"\n  }\n}\n\n### 200 OK [Completed Response] HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 07:13:21 GMT\nContent-Type: application/json\nContent-Length: 62\n\n{\n  \"Completed\": {\n    \"runId\": \"6ed2bf72-d7a3-498f-85e4-b3719727d18c\"\n  }\n}\n\n\n###","title":"Query"},{"location":"/sequencer-server.html#queryfinal","text":"This endpoint allows to query for final response of sequence.","title":"QueryFinal"},{"location":"/sequencer-server.html#sequencer-editor-apis","text":"This exposes APIs to edit sequence, get status of sequence","title":"Sequencer editor APIs"},{"location":"/sequencer-server.html#loadsequence","text":"This api loads sequence in sequencer. Sequencer will be in Loaded state. Sequencer will wait for StartSequence command to start execution.\nLoadSequence POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"LoadSequence\": {\n    \"sequence\": [\n      {\n        \"Setup\": {\n          \"source\": \"esw.darknight\",\n          \"commandName\": \"command-2\",\n          \"maybeObsId\": [\n            \"obsId1\"\n          ],\n          \"paramSet\": []\n        }\n      }\n    ]\n  }\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 09:22:58 GMT\nContent-Type: application/json\nContent-Length: 9\n\n{\n  \"Ok\": {}\n}\n\n###","title":"loadSequence"},{"location":"/sequencer-server.html#startsequence","text":"This api starts loaded sequence in sequencer. This gives Started as response. Api returns Unhandled Response is sequence is not loaded.\nStartSequence POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"StartSequence\": {}\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 09:23:28 GMT\nContent-Type: application/json\nContent-Length: 60\n\n{\n  \"Started\": {\n    \"runId\": \"537520b9-6de8-4d73-88c7-d44c31181d00\"\n  }\n}\n\n###","title":"startSequence"},{"location":"/sequencer-server.html#getsequence","text":"This api allows to get state of sequence submitted.\nGetSequence POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"GetSequence\": {}\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 09:23:49 GMT\nContent-Type: application/json\nContent-Length: 216\n\n[\n  {\n    \"steps\": [\n      {\n        \"id\": \"8d8bc85f-bcdd-4eda-8960-d29b5e64d03f\",\n        \"command\": {\n          \"Setup\": {\n            \"source\": \"esw.darknight\",\n            \"commandName\": \"command-1\",\n            \"maybeObsId\": [\n              \"obsId1\"\n            ],\n            \"paramSet\": []\n          }\n        },\n        \"status\": {\n          \"Success\": {}\n        },\n        \"hasBreakpoint\": false\n      }\n    ]\n  }\n]\n\n###","title":"getSequence"},{"location":"/sequencer-server.html#add","text":"This api allows to add more commands to running sequence. These commands will be added at the end of sequence.\nAdd POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"Add\": {\n    \"commands\": [\n      {\n        \"Setup\": {\n          \"source\": \"esw.darknight\",\n          \"commandName\": \"command-1\",\n          \"maybeObsId\": [\n            \"obsId1\"\n          ],\n          \"paramSet\": []\n        }\n      },\n      {\n        \"Setup\": {\n          \"source\": \"esw.darknight\",\n          \"commandName\": \"command-2\",\n          \"maybeObsId\": [\n            \"obsId1\"\n          ],\n          \"paramSet\": []\n        }\n      }\n    ]\n  }\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 09:24:50 GMT\nContent-Type: application/json\nContent-Length: 9\n\n{\n  \"Ok\": {}\n}\n\n###","title":"add"},{"location":"/sequencer-server.html#prepend","text":"This api allows to add more commands to running sequence. These commands will be prepended to all pending commands of sequence.\nPrepend POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"Prepend\": {\n    \"commands\": [\n      {\n        \"Setup\": {\n          \"source\": \"esw.darknight\",\n          \"commandName\": \"command-3\",\n          \"maybeObsId\": [\n            \"obsId1\"\n          ],\n          \"paramSet\": []\n        }\n      }\n    ]\n  }\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 09:25:23 GMT\nContent-Type: application/json\nContent-Length: 9\n\n{\n  \"Ok\": {}\n}\n\n###","title":"prepend"},{"location":"/sequencer-server.html#replace","text":"This api allows to replace command with given id with list of commands. This api will return error response if provided id does not exist or command to be replaces is finished or in progress.\nReplace POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"Replace\": {\n    \"id\": \"0b7a4271-7cea-46e2-b162-37118c1b1499\",\n    \"commands\": [\n      {\n        \"Setup\": {\n          \"source\": \"esw.darknight\",\n          \"commandName\": \"command-2\",\n          \"maybeObsId\": [\n            \"obsId1\"\n          ],\n          \"paramSet\": []\n        }\n      }\n    ]\n  }\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 09:25:23 GMT\nContent-Type: application/json\nContent-Length: 9\n\n{\n  \"Ok\": {}\n}\n\n###","title":"replace"},{"location":"/sequencer-server.html#insertafter","text":"This api allows to add more commands to sequence after command with provided run id. This api return error is provided id does not exist or sequence execution has gone ahead of provided id.\nInsertAfter POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"InsertAfter\": {\n    \"id\": \"3496109d-8b00-4cf7-aa06-31a19702fea1\",\n    \"commands\": [\n      {\n        \"Setup\": {\n          \"source\": \"esw.darknight\",\n          \"commandName\": \"command-4\",\n          \"maybeObsId\": [\n            \"obsId1\"\n          ],\n          \"paramSet\": []\n        }\n      }\n    ]\n  }\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 09:25:23 GMT\nContent-Type: application/json\nContent-Length: 9\n\n{\n  \"Ok\": {}\n}\n\n###","title":"insertAfter"},{"location":"/sequencer-server.html#delete","text":"This api allows to delete command with provided id.\nDelete POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"Delete\": {\n    \"id\": \"dc731e1e-20af-4edd-b5b1-530ead12792e\"\n  }\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 09:25:23 GMT\nContent-Type: application/json\nContent-Length: 9\n\n{\n  \"Ok\": {}\n}\n\n###","title":"delete"},{"location":"/sequencer-server.html#addbreakpoint","text":"This api allows to put breakpoint at command with provided id. Sequence execution will pause where breakpoint is applied.\nAddBreakpoint POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"AddBreakpoint\": {\n    \"id\": \"88b1b3ad-36ed-4be0-837c-0f93cb3a0e1f\"\n  }\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 09:25:23 GMT\nContent-Type: application/json\nContent-Length: 9\n\n{\n  \"Ok\": {}\n}\n\n###","title":"addBreakpoint"},{"location":"/sequencer-server.html#removebreakpoint","text":"This api allows to remove breakpoint from command with provided id.\nRemoveBreakpoint POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"RemoveBreakpoint\": {\n    \"id\": \"cf8962ae-b877-4413-9e48-f9b168793aa1\"\n  }\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 09:25:23 GMT\nContent-Type: application/json\nContent-Length: 9\n\n{\n  \"Ok\": {}\n}\n\n###","title":"removeBreakpoint"},{"location":"/sequencer-server.html#reset","text":"This api allows to remove all pending commands from sequence.\nReset POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"Reset\": {}\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 09:25:23 GMT\nContent-Type: application/json\nContent-Length: 9\n\n{\n  \"Ok\": {}\n}\n\n###","title":"reset"},{"location":"/sequencer-server.html#pause","text":"This api allows to pause sequence. Command which is currently in progress will execute but sequence execution will not proceed.\nPause POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"Pause\": {}\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 09:25:23 GMT\nContent-Type: application/json\nContent-Length: 9\n\n{\n  \"Ok\": {}\n}\n\n###","title":"pause"},{"location":"/sequencer-server.html#resume","text":"This api allows to resume sequence from paused point.\nResume POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"Resume\": {}\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 09:25:23 GMT\nContent-Type: application/json\nContent-Length: 9\n\n{\n  \"Ok\": {}\n}\n\n###","title":"resume"},{"location":"/sequencer-server.html#getsequencecomponent","text":"This api allows to get location of sequence component where sequencer is running.\nGetSequenceComponent POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"GetSequenceComponent\": {}\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 09:29:29 GMT\nContent-Type: application/json\nContent-Length: 191\n\n{\n  \"AkkaLocation\": {\n    \"connection\": {\n      \"prefix\": \"esw.primary\",\n      \"componentType\": \"sequence_component\",\n      \"connectionType\": \"akka\"\n    },\n    \"uri\": \"akka://esw-system@10.131.20.138:50483/user/esw.primary#-718513434\"\n  }\n}\n\n###","title":"getSequenceComponent"},{"location":"/sequencer-server.html#isavailable","text":"This api allows to check whether sequencer is executing any sequence. It return true if any sequence is in execution else false.\nIsAvailable POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"IsAvailable\": {}\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 09:30:01 GMT\nContent-Type: application/json\nContent-Length: 5\n\nfalse\n\n###","title":"isAvailable"},{"location":"/sequencer-server.html#sequencer-lifecycle-apis","text":"This exposes endpoints for sequencer lifecycle APIs e.g - goOffline, diagnostic mode, abortSequence etc.","title":"Sequencer lifecycle APIs"},{"location":"/sequencer-server.html#isonline","text":"This api allows to check whether sequencer is online.\nIsOnline POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"IsOnline\": {}\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 09:30:23 GMT\nContent-Type: application/json\nContent-Length: 4\n\ntrue\n\n###","title":"isOnline"},{"location":"/sequencer-server.html#abortsequence","text":"This api allows to abort sequence by removing all pending commands and also executes abort handler written in sequencer script.\nAbortSequence POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"AbortSequence\": {}\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 10:13:31 GMT\nContent-Type: application/json\nContent-Length: 9\n\n{\n  \"Ok\": {}\n}\n\n###","title":"abortSequence"},{"location":"/sequencer-server.html#stop","text":"This api allows to stop sequence by removing all pending commands and also executes stop handler written in sequencer script.\nStop POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"Stop\": {}\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 10:06:29 GMT\nContent-Type: application/json\nContent-Length: 9\n\n{\n  \"Ok\": {}\n}\n\n###","title":"stop"},{"location":"/sequencer-server.html#goonline","text":"This api allows to set sequencer in online mode.\nGoOnline POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"GoOnline\": {}\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 10:17:21 GMT\nContent-Type: application/json\nContent-Length: 9\n\n{\n  \"Ok\": {}\n}\n\n###","title":"goOnline"},{"location":"/sequencer-server.html#gooffline","text":"This api allows to set sequencer in offline mode.\nGoOffline POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"GoOffline\": {}\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 10:16:57 GMT\nContent-Type: application/json\nContent-Length: 9\n\n{\n  \"Ok\": {}\n}\n\n###","title":"goOffline"},{"location":"/sequencer-server.html#diagnosticmode","text":"This api executes diagnostic handler from script\nDiagnosticMode POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"DiagnosticMode\": {\n    \"startTime\": \"2020-01-02T09:18:37.370396Z\",\n    \"hint\": \"hint1\"\n  }\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 10:06:29 GMT\nContent-Type: application/json\nContent-Length: 9\n\n{\n  \"Ok\": {}\n}\n\n###","title":"diagnosticMode"},{"location":"/sequencer-server.html#operationsmode","text":"This api executes operations mode handler from script\nOperationsMode POST http://localhost:57236/post-endpoint\nContent-Type: application/json\n\n{\n  \"OperationsMode\": {}\n}\n\n### 200 OK HTTP/1.1 200 OK\nServer: akka-http/10.1.11\nDate: Thu, 02 Jan 2020 10:06:29 GMT\nContent-Type: application/json\nContent-Length: 9\n\n{\n  \"Ok\": {}\n}\n\n###","title":"operationsMode"}]}