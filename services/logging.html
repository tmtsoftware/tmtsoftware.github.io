<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>Logging service · TMT Common Software (CSW)</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content='docs'/>
<link href="https://fonts.googleapis.com/css?family=Roboto:100normal,100italic,300normal,300italic,400normal,400italic,500normal,500italic,700normal,700italic,900normal,900italicc" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../js/page.js"></script>
<script type="text/javascript" src="../js/groups.js"></script>
<link rel="stylesheet" type="text/css" href="../lib/normalize.css/normalize.css"/>
<link rel="stylesheet" type="text/css" href="../lib/foundation/dist/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="../css/page.css"/>

<!--
<link rel="shortcut icon" href="../images/favicon.ico" />
-->
</head>

<body>
<div class="off-canvas-wrapper">
<div class="off-canvas-wrapper-inner" data-off-canvas-wrapper>

<div class="off-canvas position-left" id="off-canvas-menu" data-off-canvas>
<nav class="off-canvas-nav">
<div class="nav-home">
<a href="../index.html" >
<span class="home-icon">⌂</span>TMT Common Software (CSW)
</a>
<div class="version-number">
0.1*
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="../manuals.html" class="page">Manuals</a></li>
  <li><a href="../apps.html" class="page">Applications</a>
  <ul>
    <li><a href="../apps/cswclusterseed.html" class="page">csw-cluster-seed</a></li>
    <li><a href="../apps/cswlocationagent.html" class="page">csw-location-agent</a></li>
    <li><a href="../apps/cswonfigserverapp.html" class="page">csw-config-server</a></li>
    <li><a href="../apps/cswconfigclientcli.html" class="page">csw-config-client-cli</a></li>
  </ul></li>
  <li><a href="../services.html" class="page">Services</a>
  <ul>
    <li><a href="../services/location.html" class="page">Location service</a></li>
    <li><a href="../services/config.html" class="page">Configuration service</a></li>
    <li><a href="../services/logging.html" class="active page">Logging service</a></li>
  </ul></li>
</ul>
</div>

</nav>
</div>

<div class="off-canvas-content" data-off-canvas-content>

<header class="site-header expanded row">
<div class="small-12 column">
<a href="#" class="off-canvas-toggle hide-for-medium" data-toggle="off-canvas-menu"><svg class="svg-icon svg-icon-menu" version="1.1" id="Menu" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"> <path class="svg-icon-menu-path" fill="#53CDEC" d="M16.4,9H3.6C3.048,9,3,9.447,3,10c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,9.447,16.952,9,16.4,9z M16.4,13
H3.6C3.048,13,3,13.447,3,14c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,13.447,16.952,13,16.4,13z M3.6,7H16.4
C16.952,7,17,6.553,17,6c0-0.553-0.048-1-0.6-1H3.6C3.048,5,3,5.447,3,6C3,6.553,3.048,7,3.6,7z"/></svg>
</a>
<div class="title"><a href="../index.html">TMT Common Software (CSW)</a></div>

<!--
<a href="https://www.example.com" class="logo show-for-medium">logo</a>
-->
</div>
</header>

<div class="expanded row">

<div class="medium-3 large-2 show-for-medium column">
<nav class="site-nav">
<div class="nav-home">
<a href="../index.html" >
<span class="home-icon">⌂</span>TMT Common Software (CSW)
</a>
<div class="version-number">
0.1*
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="../manuals.html" class="page">Manuals</a></li>
  <li><a href="../apps.html" class="page">Applications</a>
  <ul>
    <li><a href="../apps/cswclusterseed.html" class="page">csw-cluster-seed</a></li>
    <li><a href="../apps/cswlocationagent.html" class="page">csw-location-agent</a></li>
    <li><a href="../apps/cswonfigserverapp.html" class="page">csw-config-server</a></li>
    <li><a href="../apps/cswconfigclientcli.html" class="page">csw-config-client-cli</a></li>
  </ul></li>
  <li><a href="../services.html" class="page">Services</a>
  <ul>
    <li><a href="../services/location.html" class="page">Location service</a></li>
    <li><a href="../services/config.html" class="page">Configuration service</a></li>
    <li><a href="../services/logging.html" class="active page">Logging service</a></li>
  </ul></li>
</ul>
</div>

</nav>
</div>

<div class="small-12 medium-9 large-10 column">
<section class="site-content">

<div class="page-header row">
<div class="medium-12 show-for-medium column">
<div class="nav-breadcrumbs">
<ul>
  <li><a href="../index.html">TMT Common Software (CSW)</a></li>
  <li><a href="../services.html">Services</a></li>
  <li>Logging service</li>
</ul>
</div>
</div>
</div>

<div class="page-content row">
<div class="small-12 large-9 column" id="docs">
<h1><a href="#logging-service" name="logging-service" class="anchor"><span class="anchor-link"></span></a>Logging service</h1>
<p>Logging Service library provides an advanced logging facility for csw components and services. </p>
<h2><a href="#artifacts" name="artifacts" class="anchor"><span class="anchor-link"></span></a>Artifacts</h2>
<dl>
  <dt>sbt</dt>
  <dd>
  <pre class="prettyprint"><code class="language-scala">libraryDependencies += &quot;org.tmt&quot; %% &quot;csw-logging_2.12&quot; % &quot;0.1-SNAPSHOT&quot;
</code></pre></dd>
  <dt>maven</dt>
  <dd>
  <pre class="prettyprint"><code class="language-xml">&lt;dependency&gt;
 &lt;groupId&gt;org.tmt&lt;/groupId&gt;
 &lt;artifactId&gt;csw-logging_2.12&lt;/artifactId&gt;
 &lt;version&gt;0.1-SNAPSHOT&lt;/version&gt;
 &lt;type&gt;pom&lt;/type&gt;
&lt;/dependency&gt;
</code></pre></dd>
  <dt>gradle</dt>
  <dd>
  <pre class="prettyprint"><code class="language-gradle">dependencies {
  compile group: &quot;org.tmt&quot;, name: &quot;csw-logging_2.12&quot;, version: &quot;0.1-SNAPSHOT&quot;
}
</code></pre></dd>
</dl>
<h2><a href="#configuration" name="configuration" class="anchor"><span class="anchor-link"></span></a>Configuration</h2>
<p>These are the relevant default configuration values for logging</p>
<dl>
  <dt>logging.conf
  </dt>
  <dd>
  <pre class="prettyprint"><code class="language-conf">csw-logging {

    // Default appender and is recommended only for dev setup.
    // To use multiple appenders give comma seperated list of appenders.
    appenders = [&quot;csw.services.logging.appenders.StdOutAppender$&quot;]

    // Recommended for production setup - Uncomment below line and comment above to enable FileAppender
    //appenders = [&quot;csw.services.logging.appenders.FileAppender$&quot;]

    component-log-levels {
      // By default each compoent will use log level specified by `csw-logging.logLevel`. If required, this block allows
      // overriding log level configuration for one/more components.
      // -- Example --
      // TromboneHcd = debug
      // TromboneAssembly = error
    }

    appender-config {
      file {
        // Include standard headers
        fullHeaders = true
        // Sort the fields in Json objects
        sorted = true
        // Directory to hold log files.
        logPath = &quot;/tmp/&quot;
        // Common log messages below this level are removed, none removed when set to trace
        logLevelLimit = trace
        // Flag to turn file rotation ON or OFF. Currently log file is rotated daily at 12:00 pm UTC time. By turning this flag off
        // file rotation will not happen.
        rotate = true
      }
      stdout {
        // Include standard headers
        fullHeaders = false
        // Use colors for log levels
        color = true
        // The maximum number of character that should be on a line
        // This is only a goal; in practice some may contain more characters.
        width = 80
        // Print summary counts when logger is closed
        summary = true
        // pretty output - multiple line json
        pretty = false
        // Messages below this level are removed, none removed when set to trace
        logLevelLimit = trace
        // false Json output; true simple one line text output
        oneLine = false
      }
    }
    // If component does not specify their log level in component-log-levels block,
    // Then this will be considered as default log level for that component.
    logLevel = info
    // Log level for slf4j messages
    slf4jLogLevel = info
    // Log level for Akka messages
    akkaLogLevel = warn
    // Enable timing logging
    time = false
    //Enable garbage collection logging
    gc = false
}
</code></pre></dd>
</dl>
<p>These values can be overridden directly in the <code>reference.conf</code> or <code>application.conf</code>. Also <code>logLevel</code> for each component can be set in reference.conf/application.conf as follows:</p>
<pre><code>component-log-levels {
    tromboneHcd = debug
    tromboneAssembly = error
  }
  
</code></pre><div class="callout note "><div class="callout-title">Note</div>
<p>Here <code>tromboneHcd</code> and <code>tromboneAssembly</code> is the name of component that will be registered with <code>LocationService</code>. By default all components will log at level specified by <code>csw-logging.logLevel</code>. </p></div>
<p>Library provides <code>StdOutAppender</code> as default logging appender. To use <code>FileAppender</code> or some custom appender along-with <code>StdOutAppender</code>, override <code>appenders</code> property to include multiple appender in csv format as follows:</p>
<pre><code><br/>appenders = [&quot;csw.services.logging.appenders.FileAppender$&quot;, &quot;csw.services.logging.appenders.StdOutAppender$&quot;]

</code></pre><div class="callout note "><div class="callout-title">Note</div>
<p>Make sure to provide full path of the appender since it will be spawned using java reflection. In csw code base, a working example of custom appender can be found at: <a href="https://github.com/tmtsoftware/csw-prod/tree/master/csw-logging/src/test/scala/csw/services/logging/appenders/CustomAppenderTest.scala">Custom Appender</a></p></div>
<p>For <code>StdOutAppender</code> specify the format of log statements in <code>csw-logging.stdout</code> via <code>csw-logging.stdout.pretty</code> and <code>csw-logging.stdout.oneLine</code>.<br/>Turning <code>pretty</code> <strong>on</strong> or <strong>off</strong> will produce log statements in following format:</p>
<dl>
  <dt>pretty=true</dt>
  <dd>
  <pre><code>{&quot;@componentName&quot;:&quot;my-component-name&quot;,
 &quot;@severity&quot;:&quot;INFO&quot;,
 &quot;actor&quot;:
   &quot;akka.tcp://csw-examples-locationServiceClient@10.131.124.238:51256/user/$a&quot;,
 &quot;class&quot;:&quot;csw.services.location.LocationServiceExampleClient&quot;,
 &quot;exampleConnection&quot;:&quot;LocationServiceExampleComponent-assembly-akka&quot;,
 &quot;file&quot;:&quot;LocationServiceExampleClientApp.scala&quot;,
 &quot;line&quot;:131,
 &quot;message&quot;:&quot;Attempting to find connection&quot;,
 &quot;obsId&quot;:&quot;foo_obs_id&quot;,
 &quot;timestamp&quot;:&quot;2017-07-20T08:15:01.657Z&quot;
}
</code></pre></dd>
  <dt>pretty=false</dt>
  <dd>
  <pre><code>{&quot;@componentName&quot;:&quot;my-component-name&quot;,&quot;@severity&quot;:&quot;INFO&quot;,&quot;actor&quot;:&quot;akka.tcp://csw-examples-locationServiceClient@10.131.124.238:51172/user/$a&quot;,&quot;class&quot;:&quot;csw.services.location.LocationServiceExampleClient&quot;,&quot;exampleConnection&quot;:&quot;LocationServiceExampleComponent-assembly-akka&quot;,&quot;file&quot;:&quot;LocationServiceExampleClientApp.scala&quot;,&quot;line&quot;:131,&quot;message&quot;:&quot;Attempting to find connection&quot;,&quot;obsId&quot;:&quot;foo_obs_id&quot;,&quot;timestamp&quot;:&quot;2017-07-20T08:03:08.065Z&quot;}
</code></pre></dd>
</dl>
<p>Similarly, turning <code>oneLine</code> on will produce log statements in following format:</p>
<dl>
  <dt>oneLine=true</dt>
  <dd>
  <pre><code>[INFO] Attempting to find connection (LocationServiceExampleClientApp.scala 131)
</code></pre></dd>
</dl><div class="callout note "><div class="callout-title">Note</div>
<ul>
  <li>If <code>oneLine</code> is set to <code>true</code> then value of <code>pretty</code> will be ignored</li>
</ul></div>
<h2><a href="#log-levels" name="log-levels" class="anchor"><span class="anchor-link"></span></a>Log Levels</h2>
<p>Following Log levels are supported by csw-logging library</p>
<ul>
  <li>FATAL</li>
  <li>ERROR</li>
  <li>WARN</li>
  <li>INFO</li>
  <li>DEBUG</li>
  <li>TRACE</li>
</ul>
<p>Library allows separate log levels for the logging API(logLevel), Akka logging(akkaLogLevel), and Slf4J(slf4jLogLevel). The initial values of these are set in the configuration file as seen above. These can be overriden in the application.conf file.</p>
<p>These values can also be changed dynamically by calling methods on <code>LoggingSystem</code> class.</p>
<h2><a href="#log-structure" name="log-structure" class="anchor"><span class="anchor-link"></span></a>Log Structure</h2>
<p>All messages are logged by default as Json. Logs can contain following fields:</p>
<ul>
  <li><code>@componentName</code>: The name of the component if present</li>
  <li><code>@host</code>: The local host name</li>
  <li><code>@name</code>: The name of the application being run</li>
  <li><code>@version</code>: The version of the application being run</li>
  <li><code>@severity</code>: The message level: trace, debug, info, warn, error or fatal</li>
  <li><code>actor</code>: The path for an actor when using ActorLogging</li>
  <li><code>class</code>: The class for ClassLogging or ActorLogging</li>
  <li><code>file</code>: The file containing the log call</li>
  <li><code>kind</code>: Either slf4j or akka. Not present for logger API</li>
  <li><code>line</code>: The line where the message was logged</li>
  <li><code>message</code>: The log message</li>
  <li><code>timestamp</code>: The UTC time when the message was logged</li>
  <li><code>trace</code>: Information for any exception specified in the logging call</li>
</ul><div class="callout note "><div class="callout-title">Note</div>
<ul>
  <li><code>@host</code>, <code>@name</code> and <code>@version</code> will appear in log statements only if <em>fullHeaders</em> is set as true in the configuration</li>
  <li><code>file</code> and <code>line</code> will appear only if log statements are being logged from scala classes/actors</li>
</ul></div>
<h2><a href="#create-loggingsystem" name="create-loggingsystem" class="anchor"><span class="anchor-link"></span></a>Create LoggingSystem</h2>
<p>For logging statements to appear in the program, start <code>LoggingSystem</code> at an earliest location in an application. <strong>Also note, <code>LoggingSystem</code> should be started only once in an application.</strong> The name used while creating <code>LoggingSystem</code> will be used to create the folder and dump all logging files.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><code class="language-scala">private val host = InetAddress.getLocalHost.getHostName
// Only call this once per application
val loggingSystem: LoggingSystem = LoggingSystemFactory.start(&quot;LocationServiceExampleClient&quot;, &quot;0.1&quot;, host, system)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><code class="language-java">String host = InetAddress.getLocalHost().getHostName();
loggingSystem = JLoggingSystemFactory.start(&quot;JLocationServiceExampleClient&quot;, &quot;0.1&quot;, host, actorSystem);</code></pre></dd>
</dl><div class="callout note "><div class="callout-title">Note</div>
<ul>
  <li>The <code>hostname</code> that is provided while creating <code>LoggingSystem</code> will appear in log statements against <code>@host</code> tag</li>
</ul></div>
<h2><a href="#stop-loggingsystem" name="stop-loggingsystem" class="anchor"><span class="anchor-link"></span></a>Stop LoggingSystem</h2>
<p>Please ensure to stop <code>LoggingSystem</code> before application exits.</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><code class="language-scala">// Only call this once per application
Await.result(loggingSystem.stop, 30.seconds)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><code class="language-java">// Only call this once per application
loggingSystem.javaStop().get();</code></pre></dd>
</dl>
<h2><a href="#enable-logging" name="enable-logging" class="anchor"><span class="anchor-link"></span></a>Enable logging</h2>
<h3><a href="#enable-generic-logging" name="enable-generic-logging" class="anchor"><span class="anchor-link"></span></a>Enable generic logging</h3>
<p>To enable logging for some utility code that does not require <code>@componentName</code> in log statements, inherit from following traits:</p>
<dl>
  <dt>Scala</dt>
  <dd>
    <ul>
      <li>For actor class extend <code>GenericLogger.Actor</code></li>
    </ul>
    <ul>
      <li>For non-actor class extend <code>GenericLogger.Simple</code></li>
    </ul>
  </dd>
  <dt>Java</dt>
  <dd>
    <ul>
      <li>For actor class inherit <code>JGenericLoggerActor</code></li>
    </ul>
    <ul>
      <li>For non-actor class inherit <code>JGenericLogger</code></li>
    </ul>
  </dd>
</dl>
<h3><a href="#enable-component-level-logging" name="enable-component-level-logging" class="anchor"><span class="anchor-link"></span></a>Enable component level logging</h3>
<p>To include <code>@componentName</code> in your log statements, create an object/abstract class/interface as follows:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><code class="language-scala">object ExampleLogger extends ComponentLogger(&quot;my-component-name&quot;)</code></pre></dd>
  <dt>Actor Java Class</dt>
  <dd>
  <pre class="prettyprint"><code class="language-java">//JExampleLoggerActor is used for actor java class only
public abstract class JExampleLoggerActor extends JComponentLoggerActor {
    @Override
    public String componentName() {
        return &quot;my-component-name&quot;;
    }
}</code></pre></dd>
  <dt>Non-Actor Java class
  </dt>
  <dd>
  <pre class="prettyprint"><code class="language-java">//JExampleLogger is used for non-actor java class only
public interface JExampleLogger extends JComponentLogger {
    @Override
    default String componentName() {
        return &quot;examples&quot;;
    }
}</code></pre></dd>
</dl>
<p>Then, inherit following object/interface:</p>
<dl>
  <dt>Scala</dt>
  <dd>
    <ul>
      <li>For actor class extend <code>ExampleLogger.Actor</code></li>
    </ul>
    <ul>
      <li>For non-actor class extend <code>ExampleLogger.Simple</code></li>
    </ul>
  </dd>
  <dt>Java</dt>
  <dd>
    <ul>
      <li>For actor class inherit <code>JExampleLoggerActor</code></li>
    </ul>
    <ul>
      <li>For non-actor class inherit <code>JExampleLogger</code></li>
    </ul>
  </dd>
</dl><div class="callout note "><div class="callout-title">Example to mixin above loggers in actors </div>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><code class="language-scala">class LocationServiceExampleClient(locationService: LocationService,
                                   loggingSystem: LoggingSystem)(implicit mat: Materializer)
    extends ExampleLogger.Actor</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><code class="language-java">public class JLocationServiceExampleClient extends JExampleLoggerActor {

    private ILogger log = getLogger();</code></pre></dd>
</dl>
<p>Loggers for classes can be mixed in a similar way </p></div>
<h2><a href="#log-statements" name="log-statements" class="anchor"><span class="anchor-link"></span></a>Log statements</h2>
<p>A basic info statement can be written as follows:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><code class="language-scala">log.info(s&quot;Result of the find call: $findResult&quot;)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><code class="language-java">log.info(() -&gt; &quot;Result of the find call : None&quot;);</code></pre></dd>
</dl>
<p>The output of log statement will be:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre><code>{&quot;@componentName&quot;:&quot;my-component-name&quot;,
 &quot;@severity&quot;:&quot;INFO&quot;,
 &quot;actor&quot;:
   &quot;akka.tcp://csw-examples-locationServiceClient@10.131.124.238:50721/user/$a&quot;,
 &quot;class&quot;:&quot;csw.services.location.LocationServiceExampleClient&quot;,
 &quot;file&quot;:&quot;LocationServiceExampleClientApp.scala&quot;,
 &quot;line&quot;:141,
 &quot;message&quot;:&quot;Result of the find call: None&quot;,
 &quot;timestamp&quot;:&quot;2017-07-20T06:47:46.468Z&quot;
}
</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre><code>{&quot;@componentName&quot;:&quot;my-component-name&quot;,
 &quot;@severity&quot;:&quot;INFO&quot;,
 &quot;actor&quot;:
   &quot;akka.tcp://csw-examples-locationServiceClient@10.131.124.238:50737/user/LocationServiceExampleClient&quot;,
 &quot;class&quot;:&quot;csw.services.location.JLocationServiceExampleClient&quot;,
 &quot;message&quot;:&quot;Result of the find call : None&quot;,
 &quot;timestamp&quot;:&quot;2017-07-20T06:49:13.059Z&quot;
}
</code></pre></dd>
</dl>
<p>Library allows usage of <code>Map</code> in message as follows:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><code class="language-scala">log.info(&quot;Attempting to find connection&quot;,
         Map(Keys.OBS_ID → &quot;foo_obs_id&quot;, &quot;exampleConnection&quot; → exampleConnection.name))</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><code class="language-java">log.info(() -&gt; &quot;Attempting to find connection&quot;, () -&gt; {
    Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();
    map.put(JKeys.OBS_ID, &quot;foo_obs_id&quot;);
    map.put(&quot;exampleConnection&quot;, exampleConnection.name());
    return map;
});</code></pre></dd>
</dl>
<p>The output of log statement will be: </p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre><code>{&quot;@componentName&quot;:&quot;my-component-name&quot;,
 &quot;@severity&quot;:&quot;INFO&quot;,
 &quot;actor&quot;:
   &quot;akka.tcp://csw-examples-locationServiceClient@10.131.124.238:50721/user/$a&quot;,
 &quot;class&quot;:&quot;csw.services.location.LocationServiceExampleClient&quot;,
 &quot;exampleConnection&quot;:&quot;LocationServiceExampleComponent-assembly-akka&quot;,
 &quot;file&quot;:&quot;LocationServiceExampleClientApp.scala&quot;,
 &quot;line&quot;:131,
 &quot;message&quot;:&quot;Attempting to find connection&quot;,
 &quot;obsId&quot;:&quot;foo_obs_id&quot;,
 &quot;timestamp&quot;:&quot;2017-07-20T06:47:46.464Z&quot;
}
</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre><code>{&quot;@componentName&quot;:&quot;my-component-name&quot;,
 &quot;@severity&quot;:&quot;INFO&quot;,
 &quot;actor&quot;:
   &quot;akka.tcp://csw-examples-locationServiceClient@10.131.124.238:50737/user/LocationServiceExampleClient&quot;,
 &quot;class&quot;:&quot;csw.services.location.JLocationServiceExampleClient&quot;,
 &quot;exampleConnection&quot;:&quot;LocationServiceExampleComponent-assembly-akka&quot;,
 &quot;message&quot;:&quot;Attempting to find connection&quot;,
 &quot;obsId&quot;:&quot;foo_obs_id&quot;,
 &quot;timestamp&quot;:&quot;2017-07-20T06:49:13.054Z&quot;
}
</code></pre></dd>
</dl>
<p>Library allows to log an error with it&rsquo;s full stacktrace as follows:</p>
<dl>
  <dt>Scala</dt>
  <dd>
  <pre class="prettyprint"><code class="language-scala">log.error(runtimeException.getMessage, ex = runtimeException)</code></pre></dd>
  <dt>Java</dt>
  <dd>
  <pre class="prettyprint"><code class="language-java">log.info(() -&gt; runtimeException.getMessage(), runtimeException);</code></pre></dd>
</dl><div class="callout note "><div class="callout-title">Note</div>
<ul>
  <li>It is recommended in java to use api that has <code>Supplier</code> for <code>msg</code> and <code>map</code> since it is more efficient compared to non-supplier version of it</li>
</ul></div>
<h2><a href="#source-code-for-examples" name="source-code-for-examples" class="anchor"><span class="anchor-link"></span></a>Source code for examples</h2>
<ul>
  <li><a href="https://github.com/tmtsoftware/csw-prod/tree/master/examples/src/main/scala/csw/services/location/LocationServiceExampleClientApp.scala">Scala Example</a></li>
  <li><a href="https://github.com/tmtsoftware/csw-prod/tree/master/examples/src/main/java/csw/services/location/JLocationServiceExampleClient.java">Java Example</a></li>
</ul>
<h2><a href="#performance" name="performance" class="anchor"><span class="anchor-link"></span></a>Performance</h2>
<p>Performance results documented on this page is measured in terms of Throughput and obtained with the JMH Java benchmark harness. Sourcecode for all the JMH benchmarks can be found here at <a href="https://github.com/tmtsoftware/csw-prod/tree/master/csw-benchmark/src/main">CSW Benchmarks</a> </p>
<p><a href="https://en.wikipedia.org/wiki/Throughput">Wikipedia</a> definition of Throughput is the maximum rate of production or the maximum rate at which something can be processed. In our case, throughput is defined as how many messages can be logged in a certain period of time.</p>
<h3><a href="#test-machine-configuration-" name="test-machine-configuration-" class="anchor"><span class="anchor-link"></span></a>Test Machine Configuration :</h3>
<ul>
  <li>MacBook Pro (Retina, 15-inch, Mid 2015)</li>
  <li>Processor Name: Intel Core i7</li>
  <li>Processor Speed: 2.8 GHz</li>
  <li>No. of Processors: 1</li>
  <li>No. of Cores: 4</li>
  <li>L2 Cache (per Core): 256 KB</li>
  <li>L3 Cache: 6 MB</li>
  <li>Memory: 16 GB 1600 MHz DDR3</li>
  <li>JDK: 1.8.0_121</li>
</ul>
<h3><a href="#scala-logging-appenders-throughput" name="scala-logging-appenders-throughput" class="anchor"><span class="anchor-link"></span></a>Scala Logging : Appender&rsquo;s Throughput</h3>
<p><img src="./logging-appenders-perf-results.png" alt="Logging Appenders Throughput" /></p>
<p>Above graph includes the throughput results for File and StdOut appender&rsquo;s using scala&rsquo;s logging API. Java&rsquo;s logging API throughput results are included further down this page.<br/>As shown in the above graph, experiment was carried out for 1, 2, 4, 8 and 16 threads. That means, multiple threads are logging messages concurrently. </p><div class="callout note "><div class="callout-title">Note</div>
<ul>
  <li>Numbers indicated in the graph does not mean that those number of messages are actually written to file or console. These are the number of logging messages sent to LogActor asynchronously for the period of one second.</li>
  <li>It is the responsibility of LogActor to write these messages to file or console.</li>
  <li>LogActor uses BoundedMailbox with a mailbox-capacity = 262144, messages are dropped if mailbox gets full.</li>
</ul></div>
<h3><a href="#scala-logging-throughput-comparision-log-level-enabled-vs-disabled-" name="scala-logging-throughput-comparision-log-level-enabled-vs-disabled-" class="anchor"><span class="anchor-link"></span></a>Scala Logging : Throughput Comparision (Log Level Enabled vs Disabled)</h3>
<p>Below graph depicts the throughput of scala&rsquo;s logging API when log level was enabled and disabled. As we are using by name parameter in the Scala&rsquo;s logging API, numbers are very high in case of log level is disabled. String parameter which is passed in the logger API does not get evaluated if log level is disabled. </p>
<p><img src="./scala-by-name-log-api-throughput.png" alt="Scala Throughput Comparision" /></p>
<h3><a href="#java-logging-string-vs-supplier-api-performance" name="java-logging-string-vs-supplier-api-performance" class="anchor"><span class="anchor-link"></span></a>Java Logging - String Vs Supplier API Performance</h3>
<p>Below graph shows the throughput of Java&rsquo;s string and supplier API. Numbers shown in graph are total number of messages logged per second using String and Supplier version of API provided by CSW Logging. This graph is produced based on the result generated by <a href="https://github.com/tmtsoftware/csw-prod/blob/master/csw-benchmark/src/main/java/csw/services/logging/perf/jmh/JE2ELoggingBenchmark.java">JE2ELoggingBenchmark</a></p>
<p><img src="./java-logging-StringVsSupplier-comparision.png" alt="String Vs Supplier Throughput" /></p><div class="callout note "><div class="callout-title">Note</div>
<ul>
  <li>As you can see in the above graph, Supplier version of log API is very efficient and throughput is much higher than String version. It is recommended to use Supplier API.</li>
</ul></div>
<h2><a href="#acknowledgement" name="acknowledgement" class="anchor"><span class="anchor-link"></span></a>Acknowledgement</h2>
<p>The codebase in <strong>csw-logging</strong> module is based on <a href="https://github.com/nestorpersist/logging">persist-logging</a> library. We appreciate efforts put in by authors of the persist-logging library which made our development fast and easy.</p>
<div class="source-github">
The source code for this page can be found <a href="https://github.com/tmtsoftware/csw-prod/tree/master/docs/src/main/services/logging.md">here</a>.
</div>

</div>
<div class="large-3 show-for-large column" data-sticky-container>
<nav class="sidebar sticky" data-sticky data-anchor="docs" data-sticky-on="large">
<div class="page-nav">
<div class="nav-title">On this page:</div>
<div class="nav-toc">
<ul>
  <li><a href="../services/logging.html#logging-service" class="header">Logging service</a>
  <ul>
    <li><a href="../services/logging.html#artifacts" class="header">Artifacts</a></li>
    <li><a href="../services/logging.html#configuration" class="header">Configuration</a></li>
    <li><a href="../services/logging.html#log-levels" class="header">Log Levels</a></li>
    <li><a href="../services/logging.html#log-structure" class="header">Log Structure</a></li>
    <li><a href="../services/logging.html#create-loggingsystem" class="header">Create LoggingSystem</a></li>
    <li><a href="../services/logging.html#stop-loggingsystem" class="header">Stop LoggingSystem</a></li>
    <li><a href="../services/logging.html#enable-logging" class="header">Enable logging</a></li>
    <li><a href="../services/logging.html#log-statements" class="header">Log statements</a></li>
    <li><a href="../services/logging.html#source-code-for-examples" class="header">Source code for examples</a></li>
    <li><a href="../services/logging.html#performance" class="header">Performance</a></li>
    <li><a href="../services/logging.html#acknowledgement" class="header">Acknowledgement</a></li>
  </ul></li>
</ul>
</div>
</div>
</nav>
</div>
</div>

</section>
</div>

</div>

<footer class="site-footer">

<section class="site-footer-nav">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 medium-4 large-3 text-center column">
<div class="nav-links">
<ul>
<!-- <li><a href="https://www.example.com/products/">Products</a> -->
</ul>
</div>
</div>

</div>
</div>
</div>
</section>

<section class="site-footer-base">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 text-center large-9 column">

<!--
<div class="copyright">
<span class="text">&copy; 2017</span>
<a href="https://www.example.com" class="logo">logo</a>
</div>
-->
</div>

</div>
</div>
</div>
</section>
</footer>

</div>
</div>
</div>
</body>

<script type="text/javascript" src="../lib/foundation/dist/foundation.min.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="../js/magellan.js"></script>

<style type="text/css">@import "../lib/prettify/prettify.css";</style>
<script type="text/javascript" src="../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">jQuery(function(){window.prettyPrint && prettyPrint()});</script>

</html>
