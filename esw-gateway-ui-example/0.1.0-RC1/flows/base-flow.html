<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="description" content="docs">
<meta name="generator" content="Paradox, paradox-material-theme=0.7.0, mkdocs-material=3.0.3">

<meta name="lang:clipboard.copy" content="Copy to clipboard">
<meta name="lang:clipboard.copied" content="Copied to clipboard">
<meta name="lang:search.language" content="">
<meta name="lang:search.pipeline.stopwords" content="true">
<meta name="lang:search.pipeline.trimmer" content="true">
<meta name="lang:search.result.none" content="No matching documents">
<meta name="lang:search.result.one" content="1 matching document">
<meta name="lang:search.result.other" content="# matching documents">
<meta name="lang:search.tokenizer" content="[\s\-]+">


<meta name="description" content="docs">
<link rel="shortcut icon" href="../assets/images/favicon.png">
<title>Creating Gateway UI Application Â· Gateway UI Application Tutorial</title>
<link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
<link rel="stylesheet" href="../lib/material__tabs/dist/mdc.tabs.min.css">
<link rel="stylesheet" href="../lib/prettify/prettify.css">
<script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
<style>
body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}
code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}
</style>
<link rel="stylesheet" href="../assets/fonts/font-awesome.css">
<link rel="stylesheet" href="../assets/fonts/material-icons.css">
<link rel="stylesheet" href="../assets/stylesheets/paradox-material-theme.css">
</head>
<body
>
<input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
<input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a href="../index.html" title="Gateway UI Application Tutorial" class="md-header-nav__button md-logo">
<i class="md-icon">local_library</i>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
Gateway UI Application Tutorial
</span>
<span class="md-header-nav__topic">
Creating Gateway UI Application
</span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
<label class="md-icon md-search__icon" for="__search"></label>
<button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix>
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
Type to start searching
</div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>

</div>
</div>
</nav>
</header>

<div class="md-container">
<main class="md-main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0" style="visibility: hidden">
<label class="md-nav__title md-nav__title--site" for="drawer">
<a href="../index.html" title="Gateway UI Application Tutorial" class="md-nav__button md-logo">
<span class="md-nav__button md-logo">
<i class="md-icon">local_library</i>
</a>
<a href="../index.html" title="Gateway UI Application Tutorial">
Gateway UI Application Tutorial
</a>
</label>
<ul>
  <li><a href="../flows/base-flow.html" class="active page">Creating Gateway UI Application</a></li>
  <li><a href="../flows/submit-commands.html" class="page">Adding a Submit Command</a></li>
  <li><a href="../flows/subscribe-event.html" class="page">Adding Event Subscription</a></li>
  <li><a href="../flows/docs-flow.html" class="page">Adding Paradox Documentation</a></li>
</ul>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="../flows/base-flow.html#creating-gateway-ui-application" class="header">Creating Gateway UI Application</a>
  <ul>
    <li><a href="../flows/base-flow.html#generate-application" class="header">Generate Application</a></li>
    <li><a href="../flows/base-flow.html#open-in-development-environment" class="header">Open in Development Environment</a></li>
    <li><a href="../flows/base-flow.html#create-the-ui" class="header">Create the UI</a></li>
    <li><a href="../flows/base-flow.html#starting-backend-services" class="header">Starting backend services</a></li>
  </ul></li>
</ul>
</nav>

</nav>
<ul style="display: none">
<li class="md-nav__item md-version" id="project.version">
<label class="md-nav__link" for="__version">
<i class="md-icon" title="Version">label_outline</i> 0.1.0-RC1
</label>
</li>
</ul>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul>
  <li><a href="../flows/base-flow.html#creating-gateway-ui-application" class="header">Creating Gateway UI Application</a>
  <ul>
    <li><a href="../flows/base-flow.html#generate-application" class="header">Generate Application</a></li>
    <li><a href="../flows/base-flow.html#open-in-development-environment" class="header">Open in Development Environment</a></li>
    <li><a href="../flows/base-flow.html#create-the-ui" class="header">Create the UI</a></li>
    <li><a href="../flows/base-flow.html#starting-backend-services" class="header">Starting backend services</a></li>
  </ul></li>
</ul>
</nav>

</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<div class="md-content__searchable">
<h1><a href="#creating-gateway-ui-application" name="creating-gateway-ui-application" class="anchor"><span class="anchor-link"></span></a>Creating Gateway UI Application</h1>
<p>This flow demonstrates how to use the template to create our project, how to add UI components for adding particular features, and how to build and test it.</p>
<h2><a href="#generate-application" name="generate-application" class="anchor"><span class="anchor-link"></span></a>Generate Application</h2>
<p>First we need to generate a scaffolding application using our giter8 template:</p>
<pre class="prettyprint"><code class="language-bash">g8 tmtsoftware/esw-gateway-ui-template.g8 --project_name=sample
</code></pre>
<p>This will generate a sample folder with <code>docs</code> and <code>src</code> folders. For a sanity check, let&rsquo;s go ahead and build the frontend created by the template. This will also help ensure you have the necessary tools installed.</p>
<h3><a href="#compile-the-frontend" name="compile-the-frontend" class="anchor"><span class="anchor-link"></span></a>Compile the Frontend</h3>
<p>The <code>sample/src</code> sub-folder is where your frontend application is located. It uses Typescript, React and node. Make sure node version <code>v16.0.0</code> or higher is installed in your machine. Let&rsquo;s compile our generated application.</p>
<pre class="prettyprint"><code class="language-bash">cd sample
npm install
npm start
</code></pre>
<p>You will be greeted with the following screen.</p>
<p><img src="../images/hello-world.png" alt="hello-world" /></p><div class="callout note "><div class="callout-title">Note</div>
<p>This tutorial uses the current ESW.UISTD selections for user interface languages, libraries, and tools. These selections will be reviewed and updated once again as part of ESW Phase 2.</p></div>
<h2><a href="#open-in-development-environment" name="open-in-development-environment" class="anchor"><span class="anchor-link"></span></a>Open in Development Environment</h2>
<p>At this point, you may want to open the project in an Integrated Development Environment (IDE), such as Intellij, if you are using one. The template creates a Typescript/npm-based frontend. We recommend VS Code or Intellij.</p>
<p>To open the UI project in VS Code, click on <code>File-&gt;Open</code>. To open the UI project in Intellij, click on <code>File-&gt;New Project from Existing Sources</code></p>
<p>Then browse to the UI directory, open the <code>sample</code> project. It should have a package.json file in it.</p>
<h2><a href="#create-the-ui" name="create-the-ui" class="anchor"><span class="anchor-link"></span></a>Create the UI</h2>
<p>In this section, we will begin constructing our browser-based UI using React components in Typescript. We will start by adding a login component.</p><div class="callout note "><div class="callout-title">Note</div>
<p>The frontend tutorial uses functionality from the ESW-TS library. The documentation for ESW-TS can be useful when building your UI. ESW-TS documentation can be found <a href="http://tmtsoftware.github.io/esw-ts">here</a>.</p></div>
<h3><a href="#create-login-component" name="create-login-component" class="anchor"><span class="anchor-link"></span></a>Create login component</h3>
<p>Use of the TMT Command Service via the UI Gateway requires authentication. The user must login via the TMT AAS login page, so we will add a login component from the ESW-TS library. Create a <code>Login.tsx</code> file in the <code>src/components</code> folder which will redirect the user to the TMT login page. Later we will use this <code>Login</code> Component in <code>Main.tsx</code>.</p>
<p>Copy the full snippet shown below &amp; paste it in Login.tsx</p>
<dl>
  <dt>Typescript</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/tmtsoftware/esw-gateway-ui-example/tree/master/src/components/Login.tsx#L2-L11" target="_blank" title="Go to snippet source">source</a><code class="language-tsx">import React, { useEffect } from &#39;react&#39;
import { useAuth } from &#39;../hooks/useAuth&#39;

export const Login = (): JSX.Element =&gt; {
  const { login } = useAuth()

  useEffect(login, [login])

  return &lt;div&gt;Loading...&lt;/div&gt;
}</code></pre></dd>
</dl>
<h3><a href="#update-main-app-component-with-authentication" name="update-main-app-component-with-authentication" class="anchor"><span class="anchor-link"></span></a>Update Main &amp; App component with authentication</h3>
<p>First, add the component to our UI by updating the <code>Main.tsx</code> component in <code>/src/components</code>.</p>
<p>Copy the full snippet shown below and replace the contents in <code>Main.tsx</code>.</p>
<dl>
  <dt>Typescript</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/tmtsoftware/esw-gateway-ui-example/tree/master/src/components/Main.tsx#L2-L55" target="_blank" title="Go to snippet source">source</a><code class="language-tsx">import * as React from &#39;react&#39;
import { useAuth } from &#39;../hooks/useAuth&#39;
import { Login } from &#39;./Login&#39;
export const Main = (): JSX.Element =&gt; {
  const { auth } = useAuth()
  if (!auth) return &lt;div&gt;Loading&lt;/div&gt;
  const isAuthenticated = auth?.isAuthenticated() ?? false

  return isAuthenticated ? (
    &lt;div
      style={{
        display: &#39;flex&#39;,
        placeContent: &#39;space-around&#39;,
        paddingTop: &#39;2rem&#39;
      }}&gt;
      Hello world
    &lt;/div&gt;
  ) : (
    &lt;Login /&gt;
  )
}</code></pre></dd>
</dl>
<p>Here, you will see that there is a check to see if the user is authenticated, and if not, the login component will be shown. If the user is authenticated, the normal functionality of the app is presented, which right now, is just the Hello World page.</p>
<p>In order for our main component to have access to authentication logic from ESW-TS, we need to add a <a href="https://reactjs.org/docs/context.html">context provider</a> to the component. We do this when the component is constructed at the top level. We will wrap our Main application with <code>AuthContextProvider</code> from <code>esw-ts</code> in <code>App.tsx</code> as shown below</p>
<p>Copy the snippet within the <code>return</code> statement from the following &amp; update <code>App.tsx</code>.</p>
<dl>
  <dt>Typescript</dt>
  <dd>
  <pre class="prettyprint"><button class="snippet-button copy-snippet" title="Copy snippet to clipboard">copy</button><a class="snippet-button go-to-source" href="https://github.com/tmtsoftware/esw-gateway-ui-example/tree/master/src/App.tsx#L2-L42" target="_blank" title="Go to snippet source">source</a><code class="language-tsx">import {
  AuthContextProvider,
  LocationService,
  loadGlobalConfig
} from &#39;@tmtsoftware/esw-ts&#39;
const App = (): JSX.Element =&gt; {
  // ..
  // ..
  const { error, data: initialised } = useQuery(() =&gt;
    loadGlobalConfig().then(() =&gt; true)
  )
  return initialised ? (
    &lt;div&gt;
      &lt;LocationServiceProvider locationService={locationService}&gt;
        &lt;Router basename={basename}&gt;
          &lt;AuthContextProvider&gt;
            &lt;Main /&gt;
          &lt;/AuthContextProvider&gt;
        &lt;/Router&gt;
      &lt;/LocationServiceProvider&gt;
    &lt;/div&gt;
  ) : (
    &lt;div&gt;Loading...&lt;/div&gt;
  )
}</code></pre></dd>
</dl>
<p>After adding this section, run the following command to see the progress that we made till now.</p>
<pre class="prettyprint"><code class="language-bash">npm start
</code></pre>
<p>You should now see <code>Loading...</code> on the browser screen. </p>
<p><img src="../images/login.png" alt="login" /></p>
<p>This is because the UI is now trying to find the AAS authorization server, but we have not yet started CSW services. We will start them now, as well as the UI Gateway which will be needed for our subsequent flows.</p>
<h2><a href="#starting-backend-services" name="starting-backend-services" class="anchor"><span class="anchor-link"></span></a>Starting backend services</h2>
<p>Start the Location Service with the Authorization and Authentication Service, Config Service &amp; the Event Service.</p>
<pre class="prettyprint"><code class="language-bash">cs install csw-services
csw-services start -k -c -e
</code></pre>
<p>Start the UI Gateway Service using esw-services.</p>
<pre class="prettyprint"><code class="language-bash">cs install esw-services
esw-services start -g

</code></pre>
<p>Now try reloading the front end in browser. If the page is still up, refresh the page. If you closed it, restart the server using:</p>
<pre class="prettyprint"><code class="language-bash">npm start
</code></pre>
<p>You should be getting redirected to keycloak login page.</p>
<p><img src="../images/user-login.png" alt="user-login" /></p>
<p>Try logging in with one of predefined users in csw-services.</p>
<p>Visit <a href="https://tmtsoftware.github.io/csw/4.0.0-RC2/apps/cswservices.html#predefined-users-">here</a> to find the predefined users.</p>
<p>Visit <a href="https://tmtsoftware.github.io/esw/0.3.0-RC2/uisupport/gateway.html">here</a> to know more about users &amp; the roles.</p>
<p>Once you are logged in, you would be greeted again with <code>Hello world</code>.</p>
<p>Now, we can make use of authorization data to send a request to a protected route of the Gateway server.</p>
<h3><a href="#cleanup" name="cleanup" class="anchor"><span class="anchor-link"></span></a>Cleanup</h3>
<p>We can get rid of the unwanted css generated from the template:</p>
<ul>
  <li>Go to the <code>components</code> folder in <code>src</code> and delete <code>Main.module.css</code> file in this directory</li>
</ul>
<h3><a href="#next-steps" name="next-steps" class="anchor"><span class="anchor-link"></span></a>Next Steps</h3>
<ul>
  <li>Follow the tutorial <a href="submit-commands.html">here</a> to add the Submit Command functionality.</li>
  <li>Follow the tutorial <a href="subscribe-event.html">here</a> to add the Subscribe Event functionality.</li>
</ul>
</div>
<div>
<a href="https://github.com/tmtsoftware/esw-gateway-ui-example/tree/master/docs/src/main/flows/base-flow.md" title="Edit this page" class="md-source-file md-edit">
Edit this page
</a>
</div>
<div class="print-only">
<span class="md-source-file md-version">
0.1.0-RC1
</span>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a href="../index.html" title="Gateway UI Application Tutorial" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Previous
</span>
Gateway UI Application Tutorial
</span>
</div>
</a>
<a href="../flows/submit-commands.html" title="Adding a Submit Command" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
Next
</span>
Adding a Submit Command
</span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
Powered by
<a href="https://github.com/lightbend/paradox">Paradox</a>
and
<a href="https://jonas.github.io/paradox-material-theme/">Paradox Material Theme</a>

</div>
</div>
</div>
</footer>

</div>
<script src="../assets/javascripts/application.583bbe55.js"></script>
<script src="../assets/javascripts/paradox-material-theme.js"></script>
<script>app.initialize({version:"0.17",url:{base:"../."}})</script>
<script type="text/javascript" src="../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
window.prettyPrint && prettyPrint();
});
</script>
</body>
</html>
